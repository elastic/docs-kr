<!DOCTYPE html><html lang="en"><head><meta name="eui-styles"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-24"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'UA-12395217-24', {
                page_path: window.location.pathname,
              });
          </script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try{var d=document.documentElement;var e=localStorage.getItem("elastic-docs-theme");if(e){d.setAttribute('data-theme', e)}else{d.setAttribute('data-theme', 'light');}}catch(t){}}();</script><title>Gobld Configuration | Elastic Documentation</title><meta property="og:title" content="Gobld Configuration | Elastic Documentation"/><meta class="elastic" name="title" content="Gobld Configuration"/><meta class="elastic" name="date" content="2022-03-28T00:00:00.000Z"/><meta name="description" content="Need help? Here you&#x27;ll find complete coverage of Elasticsearch, Kibana and more."/><meta property="og:description" content="Need help? Here you&#x27;ll find complete coverage of Elasticsearch, Kibana and more."/><meta name="twitter:site" content="@elastic"/><meta property="og:url" content="http://localhost:3000/ci/gobld/configuration"/><link rel="stylesheet" type="text/css" href="/themes/eui_theme_undefined.min.css"/><link rel="stylesheet" type="text/css" href="/themes/theme_undefined.css"/><link rel="shortcut icon" href="/assets/images/favicon.ico"/><meta name="next-head-count" content="14"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-5b19eee634f155d9037d.js" defer=""></script><script src="/_next/static/chunks/framework-bf9b12c23e794b196495.js" defer=""></script><script src="/_next/static/chunks/main-710a14204f294c81ed08.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d9a28ac2b5165b299106.js" defer=""></script><script src="/_next/static/chunks/c78d26b1-ff6470003369f2a26fc7.js" defer=""></script><script src="/_next/static/chunks/103-fd3e1552f32e8c4a6b92.js" defer=""></script><script src="/_next/static/chunks/3674-41861bc71d856d154d9e.js" defer=""></script><script src="/_next/static/chunks/7815-952dc762df3d4a43befe.js" defer=""></script><script src="/_next/static/chunks/9237-e960f47bcd4625ef5949.js" defer=""></script><script src="/_next/static/chunks/4620-e195c3f5ae7ecefc57c7.js" defer=""></script><script src="/_next/static/chunks/8482-a7f4dd7850e2aa9b7794.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...slug%5D-ac753ff46f79468d535c.js" defer=""></script><script src="/_next/static/AzE3g5BBfFWf9aUdpqGZ7/_buildManifest.js" defer=""></script><script src="/_next/static/AzE3g5BBfFWf9aUdpqGZ7/_ssgManifest.js" defer=""></script></head><body class="guideBody"><div id="__next"><div class="docWrapper"><header data-elastic-exclude="true"><div class="euiHeader euiHeader--dark euiHeader--fixed"><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><a rel="noreferrer" class="euiHeaderLogo"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--large euiIcon-isLoading euiHeaderLogo__icon" focusable="false" role="img" aria-label="Elastic" aria-hidden="true"></svg><span class="euiHeaderLogo__text"><svg class="elasticMark" width="64" height="19" fill="white" xmlns="http://www.w3.org/2000/svg" aria-labelledby="elasticMark"><title id="elasticMark">Elastic</title><path d="M9.74 16.882l.711-.076.046 1.455c-1.879.257-3.485.393-4.818.393-1.773 0-3.03-.515-3.773-1.545C1.164 16.08.8 14.473.8 12.306c0-4.333 1.727-6.5 5.167-6.5 1.666 0 2.909.47 3.727 1.394.818.924 1.227 2.394 1.227 4.379l-.106 1.409H2.664c0 1.364.242 2.379.742 3.03.5.652 1.349.985 2.576.985 1.242.03 2.485-.015 3.757-.121zm-.667-5.349c0-1.515-.243-2.59-.728-3.212-.484-.621-1.272-.94-2.363-.94s-1.924.334-2.47.986c-.545.651-.833 1.712-.848 3.166h6.409zM13.497 18.427V.7h1.848v17.727h-1.848zM27.027 9.806v6.076c0 .621 1.53.742 1.53.742l-.09 1.637c-1.303 0-2.38.106-3.03-.515a10.861 10.861 0 01-4.44.924c-1.136 0-2-.319-2.59-.97-.592-.636-.895-1.56-.895-2.773 0-1.197.303-2.09.91-2.651.605-.56 1.56-.925 2.863-1.046l3.879-.363v-1.06c0-.834-.182-1.44-.546-1.804-.363-.364-.863-.545-1.485-.545H18.27V5.82h4.742c1.394 0 2.41.318 3.046.97.651.636.97 1.651.97 3.015zm-7.606 5.03c0 1.516.621 2.273 1.879 2.273a9.89 9.89 0 003.303-.56l.56-.197v-4.076l-3.65.348c-.743.06-1.274.273-1.607.637-.333.363-.485.894-.485 1.575zM34.255 7.473c-1.788 0-2.697.62-2.697 1.879 0 .575.212.984.62 1.227.41.242 1.35.485 2.819.742 1.47.258 2.5.606 3.106 1.076.606.454.91 1.318.91 2.59 0 1.274-.41 2.198-1.228 2.789-.818.59-2 .894-3.576.894-1.015 0-4.424-.38-4.424-.38l.106-1.605c1.954.182 3.379.333 4.333.333.955 0 1.682-.151 2.182-.454.5-.303.758-.819.758-1.53 0-.713-.212-1.198-.637-1.455-.424-.258-1.363-.5-2.818-.728-1.455-.227-2.485-.56-3.09-1.015-.607-.439-.91-1.272-.91-2.47 0-1.196.424-2.09 1.273-2.666.848-.576 1.909-.864 3.166-.864 1 0 4.485.258 4.485.258v1.621c-1.833-.106-3.333-.242-4.379-.242zM47.952 7.685h-3.925v5.909c0 1.409.106 2.348.303 2.788.212.44.697.666 1.47.666l2.197-.151.121 1.53c-1.106.182-1.94.273-2.515.273-1.288 0-2.167-.318-2.667-.94-.5-.62-.742-1.818-.742-3.575v-6.5h-1.758V6.079h1.758V2.29h1.833v3.773h3.925v1.62zM50.527 3.276V1.139h1.849v2.152l-1.849-.015zm0 15.151V6.08h1.849v12.348h-1.849zM60.406 5.821c.546 0 1.47.106 2.773.303l.59.076-.075 1.5c-1.318-.152-2.288-.227-2.91-.227-1.393 0-2.348.333-2.848 1-.5.666-.757 1.909-.757 3.712 0 1.803.227 3.06.697 3.773.47.712 1.44 1.06 2.924 1.06l2.91-.227.075 1.53c-1.53.227-2.682.349-3.44.349-1.924 0-3.257-.5-3.984-1.485-.728-.985-1.106-2.652-1.106-5 0-2.349.393-4 1.181-4.94.803-.939 2.122-1.424 3.97-1.424z"></path></svg></span></a></div></div><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><nav class="euiHeaderLinks" aria-label="App menu"><div class="euiHeaderLinks__list euiHeaderLinks__list--gutterS"><a class="euiButton euiButton--primary euiButton--small euiButton--fill" href="https://cloud.elastic.co/registration?source=docsHeader" rel=""><span class="euiButtonContent euiButton__content"><span class="euiButton__text">Try Free</span></span></a></div></nav></div></div></div></header><div class="euiPage euiPage--grow docArticle__template"><div class="euiPageSideBar euiPageSideBar--paddingLarge euiPageSideBar--sticky docChrome__sidebar"><div class="euiFlexItem" data-elastic-exclude="true"><div class="euiContextMenu docChrome__contextMenu"><div class="euiContextMenuPanel euiContextMenu__panel" tabindex="-1"><button class="euiContextMenuPanelTitle" type="button" data-test-subj="contextMenuPanelTitleButton"><span class="euiContextMenu__itemLayout"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading euiContextMenu__icon" focusable="false" role="img" aria-hidden="true"></svg><span class="euiContextMenu__text">Elastic 영상 모음</span></span></button><div><style data-emotion="css i2qclb-euiSpacer-s">.css-i2qclb-euiSpacer-s{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:8px;}</style><div class="euiSpacer euiSpacer--s css-i2qclb-euiSpacer-s"></div><nav class="euiSideNav" aria-label="Elastic 영상 모음"><div id="euiSideNav_b9541cc0-eaaa-11ec-944f-2bd1d637092c_content" class="euiSideNav__content euiSideNav__contentMobile-xs euiSideNav__contentMobile-s"><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">Elastic 영상 모음</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">페이지 소개</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">데이터 수집 및 시각화 데모</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-seoulMetro2019" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">(2019) 서울시 지하철 대시보드 만들기</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">(2021) 처음부터 시작하는 Elastic</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-0" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">0. 과정 소개 및 시스템 준비</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-1" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1. Stack 설치 및 환경 설정</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-2" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2. 데이터 활용 및 QueryDSL</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-3" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3. 데이터 파이프라인 구성</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-4" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4. Kibana 대시보드 만들기</span></span></a></div></div></div></div></nav></div></div></div></div></div><div class="euiPanel euiPanel--paddingLarge euiPanel--borderRadiusNone euiPanel--plain euiPanel--hasShadow euiPageBody euiPageBody--borderRadiusNone euiPageBody--paddingLarge"><div class="euiFlexGroup euiFlexGroup--gutterExtraLarge euiFlexGroup--directionRow euiFlexGroup--responsive docArticle__wrap"><div class="euiFlexItem docArticle__article"><header class="euiPageHeader euiPageHeader--bottomBorder euiPageHeader--responsive euiPageHeader--center"><div class="euiPageHeaderContent"><div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--alignItemsFlexStart euiFlexGroup--directionRow euiFlexGroup--responsive euiPageHeaderContent__top"><div class="euiFlexItem"><h1 class="euiTitle euiTitle--large">Gobld Configuration</h1><style data-emotion="css jz428s-euiSpacer-l">.css-jz428s-euiSpacer-l{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:24px;}</style><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div class="euiText euiText--medium euiText--constrainedWidth"><p><span class="euiTextColor euiTextColor--subdued"></span></p></div></div></div></div></header><style data-emotion="css kiiy9t-euiSpacer-xl">.css-kiiy9t-euiSpacer-xl{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:32px;}</style><div class="euiSpacer euiSpacer--xl css-kiiy9t-euiSpacer-xl"></div><div class="euiPanel euiPanel--borderRadiusMedium euiPanel--plain euiPanel--noShadow euiPageContent" role="main"><div class="euiPageContentBody"><div class="euiText euiText--medium"><h2 id="global-configuration" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#global-configuration" rel="noreferrer" aria-label="Global configuration permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Global configuration</h2>
<p><code class="euiCode" data-code-language="text">Gobld</code> has a number of &#x27;global&#x27; configuration items that apply either to the Gobld process itself, or every worker instance launched by <code class="euiCode" data-code-language="text">Gobld</code>.</p>
<p>They are:</p>
<div><div class="language-yaml euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="yaml"><span class="euiCodeBlock__line"><span class="token key atrule">gobld</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">  <span class="token key atrule">config</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">agentLimit</span><span class="token punctuation">:</span> <span class="token number">100</span>                         <span class="token comment"># The max amount of agents Gobld is allowed to have running at any given time</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">baseName</span><span class="token punctuation">:</span> <span class="token string">&#x27;devops-ci-worker-immutable&#x27;</span>  <span class="token comment"># This is the prefix for all Gobld managed instances</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">creatorLoopTimer</span><span class="token punctuation">:</span> <span class="token number">10</span>                    <span class="token comment"># How often the Gobld creator loop runs (seconds)</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">destroyerLoopTimer</span><span class="token punctuation">:</span> <span class="token number">10</span>                  <span class="token comment"># How often the Gobld destroyer loop runs (seconds)</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">getJobsLoopTimer</span><span class="token punctuation">:</span> <span class="token number">10</span>                    <span class="token comment"># How often the Gobld get jobs loop runs (seconds)</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">instanceConnectTimeout</span><span class="token punctuation">:</span> <span class="token number">10</span>              <span class="token comment"># Amount of minutes to wait for an instance to join Jenkins</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">instanceMaxAge</span><span class="token punctuation">:</span> <span class="token number">360</span>                     <span class="token comment"># Maximum age of an instance in minutes</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">rateLimitCreate</span><span class="token punctuation">:</span> <span class="token number">60</span>                     <span class="token comment"># Amount of new worker instances per minute that can be created</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<h2 id="agent-defaults-configuration" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#agent-defaults-configuration" rel="noreferrer" aria-label="Agent defaults configuration permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Agent defaults configuration</h2>
<p>Each provider defines a default agent configuration that Gobld merges with the Buildkite agent configuration before launching an agent.</p>
<div><div class="language-yaml euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="yaml"><span class="euiCodeBlock__line"><span class="token key atrule">providers</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">  <span class="token key atrule">gcp</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">config</span><span class="token punctuation">:</span>                       <span class="token comment"># Provider specific configuration for configuring this worker. See the providers documentation for more info</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">instanceConnectTimeout</span><span class="token punctuation">:</span> <span class="token number">10</span>  <span class="token comment"># Amount of minutes to wait for an instance to join Jenkins before being retried</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">instanceMaxAge</span><span class="token punctuation">:</span> <span class="token number">360</span>         <span class="token comment"># Maximum age of an instance in minutes</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">retryAttempts</span><span class="token punctuation">:</span> <span class="token number">3</span>            <span class="token comment"># Amount of retry attempts before giving up when trying to launch a worker.</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">retryTimeout</span><span class="token punctuation">:</span> <span class="token number">30</span>            <span class="token comment"># How many minutes to wait before retrying to launch workers for a build</span>
</span><span class="euiCodeBlock__line">    <span class="token key atrule">defaults</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">assignExternalIP</span><span class="token punctuation">:</span> <span class="token boolean important">true</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">diskSizeGb</span><span class="token punctuation">:</span> <span class="token number">100</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">diskType</span><span class="token punctuation">:</span> <span class="token string">&#x27;pd-ssd&#x27;</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">image</span><span class="token punctuation">:</span> <span class="token string">&#x27;family/elastic-buildkite-agent-ubuntu-2004-lts&#x27;</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">imageProject</span><span class="token punctuation">:</span> <span class="token string">&#x27;elastic-images-qa&#x27;</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">machineType</span><span class="token punctuation">:</span> <span class="token string">&#x27;n1-standard-4&#x27;</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">minCpuPlatform</span><span class="token punctuation">:</span> <span class="token string">&#x27;Intel Skylake&#x27;</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">networkTags</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">-</span> <span class="token string">&#x27;buildkite-agent&#x27;</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">preemptible</span><span class="token punctuation">:</span> <span class="token boolean important">false</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">serviceAccount</span><span class="token punctuation">:</span> <span class="token string">&quot;gcp-default-sa@elastic-ci-dev.iam.gserviceaccount.com&quot;</span>
</span><span class="euiCodeBlock__line">      <span class="token key atrule">zones</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">-</span> <span class="token string">&#x27;us-central1-a&#x27;</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">-</span> <span class="token string">&#x27;us-central1-b&#x27;</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">-</span> <span class="token string">&#x27;us-central1-c&#x27;</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">-</span> <span class="token string">&#x27;us-central1-f&#x27;</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>For provider specific configuration options please refer to the <a class="euiLink euiLink--primary" href="./providers/" rel="noreferrer">provider documentation</a></p>
<h2 id="choosing-the-cloud-provider-for-an-agent" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#choosing-the-cloud-provider-for-an-agent" rel="noreferrer" aria-label="Choosing the Cloud Provider for an Agent permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Choosing the Cloud Provider for an Agent</h2>
<p>Gobld supports launching agents in multiple different cloud providers, such as AWS, GCP or Kubernetes.<br/>
<!-- -->The required cloud provider can be picked by specifying the <code class="euiCode" data-code-language="text">provider</code> agent tag. If no tag is specified, <code class="euiCode" data-code-language="text">gobld</code> defaults to launching a Kubernetes (<code class="euiCode" data-code-language="text">k8s</code>) agent.</p>
<h2 id="dynamic-configuration-via-agent-tags" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#dynamic-configuration-via-agent-tags" rel="noreferrer" aria-label="Dynamic Configuration via Agent tags permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Dynamic Configuration via Agent tags</h2>
<p>Configuration for an agent can be modified dynamically using tag values specified within the Buildkite Pipeline <code class="euiCode" data-code-language="text">agents</code> config block.
The supported tag values differ per provider, so consult the relevant <a class="euiLink euiLink--primary" href="./providers/" rel="noreferrer">provider documentation</a> for an accurate list.</p>
<p>A good example use of agent tags is to specify the required CPU or Memory for a Kubernetes pod, or the instance size for a GCP or AWS based agent.</p>
<p>More details on specifying agent tags can be found <a class="euiLink euiLink--primary" href="https://buildkite.com/docs/pipelines/defining-steps#targeting-specific-agents" rel="noreferrer">here<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--small euiIcon-isLoading euiLink__externalIcon" focusable="false" role="img" aria-label="External link" aria-hidden="true"></svg></a>.</p>
<h3 id="examples" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#examples" rel="noreferrer" aria-label="Examples permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Examples</h3>
<p>In order to launch a Kubernetes based Agent that has 4 CPUs and 12GB memory with 250GB of ephemeral storage, the following <code class="euiCode" data-code-language="text">agent</code> block could be used:</p>
<div><div class="language-yaml euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="yaml"><span class="euiCodeBlock__line"><span class="token key atrule">agents</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">  <span class="token key atrule">provider</span><span class="token punctuation">:</span> <span class="token string">&quot;k8s&quot;</span> <span class="token comment"># This is optional, as `k8s` is the default proider.</span>
</span><span class="euiCodeBlock__line">  <span class="token key atrule">cpu</span><span class="token punctuation">:</span> <span class="token string">&quot;4&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token key atrule">ephemeralStorage</span><span class="token punctuation">:</span> <span class="token string">&quot;250G&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token key atrule">memory</span><span class="token punctuation">:</span> <span class="token string">&quot;12G&quot;</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>To launch a GCP based Agent that uses the <code class="euiCode" data-code-language="text">c2-standard-16</code> machine type, the following <code class="euiCode" data-code-language="text">agents</code> block could be used:</p>
<div><div class="language-yaml euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="yaml"><span class="euiCodeBlock__line"><span class="token key atrule">agents</span><span class="token punctuation">:</span>
</span><span class="euiCodeBlock__line">  <span class="token key atrule">provider</span><span class="token punctuation">:</span> <span class="token string">&quot;gcp&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token key atrule">machineType</span><span class="token punctuation">:</span> <span class="token string">&quot;c2-standard-16&quot;</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--subdued">Last updated: Mar 28th, 2022</div></div></div></div></div></div></div></div><footer class="docChromeFooter" data-elastic-exclude="true"><div class="euiFlexGroup euiFlexGroup--justifyContentSpaceAround euiFlexGroup--directionRow euiFlexGroup--responsive"><div class="euiFlexItem euiFlexItem--flexGrowZero docChromeFooter__container"><div class="euiFlexGroup euiFlexGroup--gutterExtraLarge euiFlexGroup--justifyContentSpaceBetween euiFlexGroup--directionRow euiFlexGroup--responsive"><div class="euiFlexItem"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--ghost"><p>Elasticsearch is a trademark of Elasticsearch B.V., registered in the U.S. and in other countries.</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the Apache Software Foundation in the United States and/or other countries.</p><p> <a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/trademarks" rel="">Trademarks</a><span class="docChromeFooter__divide">|</span><a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/terms-of-use" rel="">Terms of Use</a><span class="docChromeFooter__divide">|</span><a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/privacy-statement" rel="">Privacy</a><span class="docChromeFooter__divide">|</span>© <!-- -->2022<!-- --> Elasticsearch B.V. All Rights Reserved</p></div></div></div><div class="euiFlexItem euiFlexItem--flexGrowZero"></div><div class="euiFlexItem euiFlexItem--flexGrowZero"><figure class="euiImage docChromeFooter__logo"><img style="max-width:xs;max-height:xs;width:auto" src="/assets/images/logo-elastic-vertical-reverse.svg" class="euiImage__img" alt="Elastic logo"/></figure></div></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"bundle":"!function(e,n){\"object\"==typeof exports\u0026\u0026\"object\"==typeof module?module.exports=n(require(\"mdxJsReact\"),require(\"React\")):\"function\"==typeof define\u0026\u0026define.amd?define([\"mdxJsReact\",\"React\"],n):\"object\"==typeof exports?exports.MDXContent=n(require(\"mdxJsReact\"),require(\"React\")):e.MDXContent=n(e.mdxJsReact,e.React)}(this,((e,n)=\u003e(()=\u003e{\"use strict\";var t={24:e=\u003e{e.exports=n},825:n=\u003e{n.exports=e}},a={};function o(e){var n=a[e];if(void 0!==n)return n.exports;var r=a[e]={exports:{}};return t[e](r,r.exports,o),r.exports}o.n=e=\u003e{var n=e\u0026\u0026e.__esModule?()=\u003ee.default:()=\u003ee;return o.d(n,{a:n}),n},o.d=(e,n)=\u003e{for(var t in n)o.o(n,t)\u0026\u0026!o.o(e,t)\u0026\u0026Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},o.o=(e,n)=\u003eObject.prototype.hasOwnProperty.call(e,n),o.r=e=\u003e{\"undefined\"!=typeof Symbol\u0026\u0026Symbol.toStringTag\u0026\u0026Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var r={};return(()=\u003e{o.r(r),o.d(r,{default:()=\u003ea});var e=o(825),n=o(24),t=o.n(n);const a=function(){var n=arguments.length\u003e0\u0026\u0026void 0!==arguments[0]?arguments[0]:{},a=Object.assign({},(0,e.useMDXComponents)(),n.components),o=a.wrapper;return o?t().createElement(o,n,t().createElement(r)):r();function r(){var a=Object.assign({h2:\"h2\",p:\"p\",code:\"code\",pre:\"pre\",a:\"a\",br:\"br\",h3:\"h3\"},(0,e.useMDXComponents)(),n.components);return t().createElement(t().Fragment,null,t().createElement(a.h2,{id:\"global-configuration\"},\"Global configuration\"),\"\\n\",t().createElement(a.p,null,t().createElement(a.code,{display:\"inline\"},\"Gobld\"),\" has a number of 'global' configuration items that apply either to the Gobld process itself, or every worker instance launched by \",t().createElement(a.code,{display:\"inline\"},\"Gobld\"),\".\"),\"\\n\",t().createElement(a.p,null,\"They are:\"),\"\\n\",t().createElement(a.pre,null,t().createElement(a.code,{className:\"language-yaml\",display:\"block\"},\"gobld:\\n  config:\\n    agentLimit: 100                         # The max amount of agents Gobld is allowed to have running at any given time\\n    baseName: 'devops-ci-worker-immutable'  # This is the prefix for all Gobld managed instances\\n    creatorLoopTimer: 10                    # How often the Gobld creator loop runs (seconds)\\n    destroyerLoopTimer: 10                  # How often the Gobld destroyer loop runs (seconds)\\n    getJobsLoopTimer: 10                    # How often the Gobld get jobs loop runs (seconds)\\n    instanceConnectTimeout: 10              # Amount of minutes to wait for an instance to join Jenkins\\n    instanceMaxAge: 360                     # Maximum age of an instance in minutes\\n    rateLimitCreate: 60                     # Amount of new worker instances per minute that can be created\\n\")),\"\\n\",t().createElement(a.h2,{id:\"agent-defaults-configuration\"},\"Agent defaults configuration\"),\"\\n\",t().createElement(a.p,null,\"Each provider defines a default agent configuration that Gobld merges with the Buildkite agent configuration before launching an agent.\"),\"\\n\",t().createElement(a.pre,null,t().createElement(a.code,{className:\"language-yaml\",display:\"block\"},\"providers:\\n  gcp:\\n    config:                       # Provider specific configuration for configuring this worker. See the providers documentation for more info\\n      instanceConnectTimeout: 10  # Amount of minutes to wait for an instance to join Jenkins before being retried\\n      instanceMaxAge: 360         # Maximum age of an instance in minutes\\n      retryAttempts: 3            # Amount of retry attempts before giving up when trying to launch a worker.\\n      retryTimeout: 30            # How many minutes to wait before retrying to launch workers for a build\\n    defaults:\\n      assignExternalIP: true\\n      diskSizeGb: 100\\n      diskType: 'pd-ssd'\\n      image: 'family/elastic-buildkite-agent-ubuntu-2004-lts'\\n      imageProject: 'elastic-images-qa'\\n      machineType: 'n1-standard-4'\\n      minCpuPlatform: 'Intel Skylake'\\n      networkTags:\\n        - 'buildkite-agent'\\n      preemptible: false\\n      serviceAccount: \\\"gcp-default-sa@elastic-ci-dev.iam.gserviceaccount.com\\\"\\n      zones:\\n        - 'us-central1-a'\\n        - 'us-central1-b'\\n        - 'us-central1-c'\\n        - 'us-central1-f'\\n\")),\"\\n\",t().createElement(a.p,null,\"For provider specific configuration options please refer to the \",t().createElement(a.a,{href:\"./providers/\"},\"provider documentation\")),\"\\n\",t().createElement(a.h2,{id:\"choosing-the-cloud-provider-for-an-agent\"},\"Choosing the Cloud Provider for an Agent\"),\"\\n\",t().createElement(a.p,null,\"Gobld supports launching agents in multiple different cloud providers, such as AWS, GCP or Kubernetes.\",t().createElement(a.br),\"\\n\",\"The required cloud provider can be picked by specifying the \",t().createElement(a.code,{display:\"inline\"},\"provider\"),\" agent tag. If no tag is specified, \",t().createElement(a.code,{display:\"inline\"},\"gobld\"),\" defaults to launching a Kubernetes (\",t().createElement(a.code,{display:\"inline\"},\"k8s\"),\") agent.\"),\"\\n\",t().createElement(a.h2,{id:\"dynamic-configuration-via-agent-tags\"},\"Dynamic Configuration via Agent tags\"),\"\\n\",t().createElement(a.p,null,\"Configuration for an agent can be modified dynamically using tag values specified within the Buildkite Pipeline \",t().createElement(a.code,{display:\"inline\"},\"agents\"),\" config block.\\nThe supported tag values differ per provider, so consult the relevant \",t().createElement(a.a,{href:\"./providers/\"},\"provider documentation\"),\" for an accurate list.\"),\"\\n\",t().createElement(a.p,null,\"A good example use of agent tags is to specify the required CPU or Memory for a Kubernetes pod, or the instance size for a GCP or AWS based agent.\"),\"\\n\",t().createElement(a.p,null,\"More details on specifying agent tags can be found \",t().createElement(a.a,{href:\"https://buildkite.com/docs/pipelines/defining-steps#targeting-specific-agents\"},\"here\"),\".\"),\"\\n\",t().createElement(a.h3,{id:\"examples\"},\"Examples\"),\"\\n\",t().createElement(a.p,null,\"In order to launch a Kubernetes based Agent that has 4 CPUs and 12GB memory with 250GB of ephemeral storage, the following \",t().createElement(a.code,{display:\"inline\"},\"agent\"),\" block could be used:\"),\"\\n\",t().createElement(a.pre,null,t().createElement(a.code,{className:\"language-yaml\",display:\"block\"},'agents:\\n  provider: \"k8s\" # This is optional, as `k8s` is the default proider.\\n  cpu: \"4\"\\n  ephemeralStorage: \"250G\"\\n  memory: \"12G\"\\n')),\"\\n\",t().createElement(a.p,null,\"To launch a GCP based Agent that uses the \",t().createElement(a.code,{display:\"inline\"},\"c2-standard-16\"),\" machine type, the following \",t().createElement(a.code,{display:\"inline\"},\"agents\"),\" block could be used:\"),\"\\n\",t().createElement(a.pre,null,t().createElement(a.code,{className:\"language-yaml\",display:\"block\"},'agents:\\n  provider: \"gcp\"\\n  machineType: \"c2-standard-16\"\\n')))}}})(),r})()));","frontmatter":{"id":"ciGobldConfiguation","slug":"/ci/gobld/configuration","title":"Gobld Configuration","summary":"Gobld Configuration","date":"2022-03-28T00:00:00.000Z","tags":["ci","ci/cd","developer tools","buildkite","gobld","engineering","platform"],"link":"https://github.com/elastic/ci/blob/main","linkPath":"docs/gobld/configuration.mdx"},"missionId":"krVideos"},"__N_SSG":true},"page":"/[...slug]","query":{"slug":["ci","gobld","configuration"]},"buildId":"AzE3g5BBfFWf9aUdpqGZ7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>