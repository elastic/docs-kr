<!DOCTYPE html><html lang="en"><head><meta name="eui-styles"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-24"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'UA-12395217-24', {
                page_path: window.location.pathname,
              });
          </script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try{var d=document.documentElement;var e=localStorage.getItem("elastic-docs-theme");if(e){d.setAttribute('data-theme', e)}else{d.setAttribute('data-theme', 'light');}}catch(t){}}();</script><title>Troubleshooting | Elastic Documentation</title><meta property="og:title" content="Troubleshooting | Elastic Documentation"/><meta class="elastic" name="title" content="Troubleshooting"/><meta class="elastic" name="date" content="2022-03-28T00:00:00.000Z"/><meta name="description" content="Need help? Here you&#x27;ll find complete coverage of Elasticsearch, Kibana and more."/><meta property="og:description" content="Need help? Here you&#x27;ll find complete coverage of Elasticsearch, Kibana and more."/><meta name="twitter:site" content="@elastic"/><meta property="og:url" content="http://localhost:3000/ci/gobld/troubleshooting"/><link rel="stylesheet" type="text/css" href="/themes/eui_theme_undefined.min.css"/><link rel="stylesheet" type="text/css" href="/themes/theme_undefined.css"/><link rel="shortcut icon" href="/assets/images/favicon.ico"/><meta name="next-head-count" content="14"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-5b19eee634f155d9037d.js" defer=""></script><script src="/_next/static/chunks/framework-bf9b12c23e794b196495.js" defer=""></script><script src="/_next/static/chunks/main-710a14204f294c81ed08.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d9a28ac2b5165b299106.js" defer=""></script><script src="/_next/static/chunks/c78d26b1-ff6470003369f2a26fc7.js" defer=""></script><script src="/_next/static/chunks/103-fd3e1552f32e8c4a6b92.js" defer=""></script><script src="/_next/static/chunks/3674-41861bc71d856d154d9e.js" defer=""></script><script src="/_next/static/chunks/7815-952dc762df3d4a43befe.js" defer=""></script><script src="/_next/static/chunks/9237-e960f47bcd4625ef5949.js" defer=""></script><script src="/_next/static/chunks/4620-e195c3f5ae7ecefc57c7.js" defer=""></script><script src="/_next/static/chunks/8482-a7f4dd7850e2aa9b7794.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...slug%5D-ac753ff46f79468d535c.js" defer=""></script><script src="/_next/static/AzE3g5BBfFWf9aUdpqGZ7/_buildManifest.js" defer=""></script><script src="/_next/static/AzE3g5BBfFWf9aUdpqGZ7/_ssgManifest.js" defer=""></script></head><body class="guideBody"><div id="__next"><div class="docWrapper"><header data-elastic-exclude="true"><div class="euiHeader euiHeader--dark euiHeader--fixed"><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><a rel="noreferrer" class="euiHeaderLogo"><svg data-type="logoElastic" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32" class="euiIcon euiIcon--large euiHeaderLogo__icon" focusable="false" role="img" aria-label="Elastic"><path class="outline" fill-rule="evenodd" clip-rule="evenodd" d="M30.86 13.129A6.333 6.333 0 0132 16.77a6.419 6.419 0 01-1.162 3.652 6.382 6.382 0 01-3.032 2.331 4.833 4.833 0 01-1.672 5.542 4.789 4.789 0 01-5.77-.074 9.016 9.016 0 01-4.5 3.322 8.982 8.982 0 01-5.587.023 9.014 9.014 0 01-4.526-3.287 9.067 9.067 0 01-1.727-5.333c0-.579.053-1.156.16-1.725A6.305 6.305 0 011.145 18.9 6.341 6.341 0 010 15.242a6.42 6.42 0 011.163-3.652 6.384 6.384 0 013.035-2.33 4.833 4.833 0 011.658-5.557 4.789 4.789 0 015.78.07 9.037 9.037 0 014.93-3.446 9.007 9.007 0 015.994.419 9.05 9.05 0 014.407 4.098 9.097 9.097 0 01.873 5.965 6.298 6.298 0 013.02 2.32zm-18.28.658l7.002 3.211 7.066-6.213a7.85 7.85 0 00.152-1.557c0-1.692-.539-3.34-1.54-4.704a7.897 7.897 0 00-4.02-2.869 7.87 7.87 0 00-4.932.086 7.9 7.9 0 00-3.92 3.007l-1.174 6.118 1.367 2.92-.001.001zm-7.247 7.441A7.964 7.964 0 006.72 27.53a7.918 7.918 0 004.04 2.874 7.89 7.89 0 004.95-.097 7.92 7.92 0 003.926-3.03l1.166-6.102-1.555-2.985-7.03-3.211-6.885 6.248.001.001zm4.755-11.024l-4.8-1.137.002-.002a3.82 3.82 0 011.312-4.358 3.785 3.785 0 014.538.023l-1.052 5.474zm-5.216.01a5.294 5.294 0 00-2.595 1.882 5.324 5.324 0 00-.142 6.124 5.287 5.287 0 002.505 2l6.733-6.101-1.235-2.65-5.266-1.255zm18.286 17.848a3.737 3.737 0 01-2.285-.785l1.037-5.454 4.8 1.125a3.812 3.812 0 01-1.801 4.68c-.54.283-1.14.432-1.751.434zm-1.31-7.499l5.28 1.238a5.34 5.34 0 002.622-1.938 5.37 5.37 0 001.013-3.106 5.311 5.311 0 00-.936-3.01 5.282 5.282 0 00-2.475-1.944l-6.904 6.07 1.4 2.69z" fill="#fff"></path><path d="M12.58 13.787l7.002 3.211 7.066-6.213a7.849 7.849 0 00.152-1.557c0-1.692-.539-3.34-1.54-4.704a7.897 7.897 0 00-4.02-2.869 7.87 7.87 0 00-4.932.086 7.9 7.9 0 00-3.92 3.007l-1.174 6.118 1.367 2.92-.001.001z" fill="#FEC514"></path><path d="M5.333 21.228A7.964 7.964 0 006.72 27.53a7.918 7.918 0 004.04 2.874 7.89 7.89 0 004.95-.097 7.92 7.92 0 003.926-3.03l1.166-6.102-1.555-2.985-7.03-3.211-6.885 6.248.001.001z" fill="#00BFB3"></path><path d="M5.288 9.067l4.8 1.137L11.14 4.73a3.785 3.785 0 00-5.914 1.94 3.82 3.82 0 00.064 2.395" fill="#F04E98"></path><path d="M4.872 10.214a5.294 5.294 0 00-2.595 1.882 5.324 5.324 0 00-.142 6.124 5.287 5.287 0 002.505 2l6.733-6.101-1.235-2.65-5.266-1.255z" fill="#1BA9F5"></path><path d="M20.873 27.277a3.736 3.736 0 002.285.785 3.783 3.783 0 003.101-1.63 3.812 3.812 0 00.451-3.484l-4.8-1.125-1.037 5.454z" fill="#93C90E"></path><path d="M21.848 20.563l5.28 1.238a5.34 5.34 0 002.622-1.938 5.37 5.37 0 001.013-3.106 5.312 5.312 0 00-.936-3.01 5.283 5.283 0 00-2.475-1.944l-6.904 6.07 1.4 2.69z" fill="#07C"></path></svg><span class="euiHeaderLogo__text"><svg class="elasticMark" width="64" height="19" fill="white" xmlns="http://www.w3.org/2000/svg" aria-labelledby="elasticMark"><title id="elasticMark">Elastic</title><path d="M9.74 16.882l.711-.076.046 1.455c-1.879.257-3.485.393-4.818.393-1.773 0-3.03-.515-3.773-1.545C1.164 16.08.8 14.473.8 12.306c0-4.333 1.727-6.5 5.167-6.5 1.666 0 2.909.47 3.727 1.394.818.924 1.227 2.394 1.227 4.379l-.106 1.409H2.664c0 1.364.242 2.379.742 3.03.5.652 1.349.985 2.576.985 1.242.03 2.485-.015 3.757-.121zm-.667-5.349c0-1.515-.243-2.59-.728-3.212-.484-.621-1.272-.94-2.363-.94s-1.924.334-2.47.986c-.545.651-.833 1.712-.848 3.166h6.409zM13.497 18.427V.7h1.848v17.727h-1.848zM27.027 9.806v6.076c0 .621 1.53.742 1.53.742l-.09 1.637c-1.303 0-2.38.106-3.03-.515a10.861 10.861 0 01-4.44.924c-1.136 0-2-.319-2.59-.97-.592-.636-.895-1.56-.895-2.773 0-1.197.303-2.09.91-2.651.605-.56 1.56-.925 2.863-1.046l3.879-.363v-1.06c0-.834-.182-1.44-.546-1.804-.363-.364-.863-.545-1.485-.545H18.27V5.82h4.742c1.394 0 2.41.318 3.046.97.651.636.97 1.651.97 3.015zm-7.606 5.03c0 1.516.621 2.273 1.879 2.273a9.89 9.89 0 003.303-.56l.56-.197v-4.076l-3.65.348c-.743.06-1.274.273-1.607.637-.333.363-.485.894-.485 1.575zM34.255 7.473c-1.788 0-2.697.62-2.697 1.879 0 .575.212.984.62 1.227.41.242 1.35.485 2.819.742 1.47.258 2.5.606 3.106 1.076.606.454.91 1.318.91 2.59 0 1.274-.41 2.198-1.228 2.789-.818.59-2 .894-3.576.894-1.015 0-4.424-.38-4.424-.38l.106-1.605c1.954.182 3.379.333 4.333.333.955 0 1.682-.151 2.182-.454.5-.303.758-.819.758-1.53 0-.713-.212-1.198-.637-1.455-.424-.258-1.363-.5-2.818-.728-1.455-.227-2.485-.56-3.09-1.015-.607-.439-.91-1.272-.91-2.47 0-1.196.424-2.09 1.273-2.666.848-.576 1.909-.864 3.166-.864 1 0 4.485.258 4.485.258v1.621c-1.833-.106-3.333-.242-4.379-.242zM47.952 7.685h-3.925v5.909c0 1.409.106 2.348.303 2.788.212.44.697.666 1.47.666l2.197-.151.121 1.53c-1.106.182-1.94.273-2.515.273-1.288 0-2.167-.318-2.667-.94-.5-.62-.742-1.818-.742-3.575v-6.5h-1.758V6.079h1.758V2.29h1.833v3.773h3.925v1.62zM50.527 3.276V1.139h1.849v2.152l-1.849-.015zm0 15.151V6.08h1.849v12.348h-1.849zM60.406 5.821c.546 0 1.47.106 2.773.303l.59.076-.075 1.5c-1.318-.152-2.288-.227-2.91-.227-1.393 0-2.348.333-2.848 1-.5.666-.757 1.909-.757 3.712 0 1.803.227 3.06.697 3.773.47.712 1.44 1.06 2.924 1.06l2.91-.227.075 1.53c-1.53.227-2.682.349-3.44.349-1.924 0-3.257-.5-3.984-1.485-.728-.985-1.106-2.652-1.106-5 0-2.349.393-4 1.181-4.94.803-.939 2.122-1.424 3.97-1.424z"></path></svg></span></a></div></div><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><nav class="euiHeaderLinks" aria-label="App menu"><div class="euiHeaderLinks__list euiHeaderLinks__list--gutterS"><a class="euiButton euiButton--primary euiButton--small euiButton--fill" href="https://cloud.elastic.co/registration?source=docsHeader" rel=""><span class="euiButtonContent euiButton__content"><span class="euiButton__text">Try Free</span></span></a></div></nav></div></div></div></header><div class="euiPage euiPage--grow docArticle__template"><div class="euiPageSideBar euiPageSideBar--paddingLarge euiPageSideBar--sticky docChrome__sidebar"><div class="euiFlexItem" data-elastic-exclude="true"><div class="euiContextMenu docChrome__contextMenu"><div class="euiContextMenuPanel euiContextMenu__panel" tabindex="-1"><button class="euiContextMenuPanelTitle" type="button" data-test-subj="contextMenuPanelTitleButton"><span class="euiContextMenu__itemLayout"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading euiContextMenu__icon" focusable="false" role="img" aria-hidden="true"></svg><span class="euiContextMenu__text">Elastic 영상 모음</span></span></button><div><style data-emotion="css i2qclb-euiSpacer-s">.css-i2qclb-euiSpacer-s{-webkit-flex-shrink:0;-ms-flex-negative:0;flex-shrink:0;height:8px;}</style><div class="euiSpacer euiSpacer--s css-i2qclb-euiSpacer-s"></div><nav class="euiSideNav" aria-label="Elastic 영상 모음"><div id="euiSideNav_b95d6b90-eaaa-11ec-8fcd-598975943f6e_content" class="euiSideNav__content euiSideNav__contentMobile-xs euiSideNav__contentMobile-s"><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">Elastic 영상 모음</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">페이지 소개</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">데이터 수집 및 시각화 데모</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-seoulMetro2019" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">(2019) 서울시 지하철 대시보드 만들기</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">(2021) 처음부터 시작하는 Elastic</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-0" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">0. 과정 소개 및 시스템 준비</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-1" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1. Stack 설치 및 환경 설정</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-2" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2. 데이터 활용 및 QueryDSL</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-3" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3. 데이터 파이프라인 구성</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krVideos/vid-esScratch2021-4" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4. Kibana 대시보드 만들기</span></span></a></div></div></div></div></nav></div></div></div></div></div><div class="euiPanel euiPanel--paddingLarge euiPanel--borderRadiusNone euiPanel--plain euiPanel--hasShadow euiPageBody euiPageBody--borderRadiusNone euiPageBody--paddingLarge"><div class="euiFlexGroup euiFlexGroup--gutterExtraLarge euiFlexGroup--directionRow euiFlexGroup--responsive docArticle__wrap"><div class="euiFlexItem docArticle__article"><header class="euiPageHeader euiPageHeader--bottomBorder euiPageHeader--responsive euiPageHeader--center"><div class="euiPageHeaderContent"><div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--alignItemsFlexStart euiFlexGroup--directionRow euiFlexGroup--responsive euiPageHeaderContent__top"><div class="euiFlexItem"><h1 class="euiTitle euiTitle--large">Troubleshooting</h1><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div class="euiText euiText--medium euiText--constrainedWidth"><p><span class="euiTextColor euiTextColor--subdued"></span></p></div></div></div></div></header><div class="euiSpacer euiSpacer--xl css-kiiy9t-euiSpacer-xl"></div><div class="euiPanel euiPanel--borderRadiusMedium euiPanel--plain euiPanel--noShadow euiPageContent" role="main"><div class="euiPageContentBody"><div class="euiText euiText--medium"><h2 id="useful-information" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#useful-information" rel="noreferrer" aria-label="Useful information permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Useful information</h2>
<ul>
<li>Take a look at the <a class="euiLink euiLink--primary" href="https://ci-stats.elastic.co/s/jenkins/app/dashboards#/view/edb93e20-001b-11ec-9ff8-057e2acfff2f?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-4h%2Cto%3Anow))" rel="noreferrer">Gobld Service Dashboard<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--small euiIcon-isLoading euiLink__externalIcon" focusable="false" role="img" aria-label="External link" aria-hidden="true"></svg></a></li>
<li>Gobld runs in our <a class="euiLink euiLink--primary" href="../kubernetes.md" rel="noreferrer">ci-systems-prod</a> platform.<br/>
<!-- -->Configure your <code class="euiCode" data-code-language="text">kubectl</code> by running<!-- -->
<div><div class="euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="text"><span class="euiCodeBlock__line">cd terraform/providers/gcp/env/ci-systems-prod
</span><span class="euiCodeBlock__line">make kube-config
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
</li>
<li>Gobld logs are sent to <a class="euiLink euiLink--primary" href="https://ci-stats.elastic.co/goto/3254eeabab40a1c3ae17cb977b419ea0" rel="">ci-stats.elastic.co<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--small euiIcon-isLoading euiLink__externalIcon" focusable="false" role="img" aria-label="External link" aria-hidden="true"></svg></a></li>
<li>You can also view the logs in realtime by running:<!-- -->
<div><div class="euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="text"><span class="euiCodeBlock__line">kubectl logs --namespace=gobld -f deployments/gobld-buildkite-elastic -c gobld
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
</li>
<li>Gobld is stateless and can be safely restarted. In Kubernetes land you do this by deleting the pod.<!-- -->
<div><div class="euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="text"><span class="euiCodeBlock__line">kubectl delete pod -l app=gobld-buildkite-elastic
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
</li>
<li>Agents are launched in the <a class="euiLink euiLink--primary" href="https://console.cloud.google.com/compute/instances?folder=&amp;organizationId=992493199029&amp;project=elastic-ci-prod&amp;filter=%255B%257B_22k_22_3A_22_22_2C_22t_22_3A10_2C_22v_22_3A_22_5C_22immutable_5C_22_22%257D%255D" rel="noreferrer">elastic-ci-prod<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--small euiIcon-isLoading euiLink__externalIcon" focusable="false" role="img" aria-label="External link" aria-hidden="true"></svg></a> project.</li>
</ul>
<h2 id="potential-problems-preventing-gobld-from-launching-instances" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#potential-problems-preventing-gobld-from-launching-instances" rel="noreferrer" aria-label="Potential problems preventing Gobld from launching instances permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Potential problems preventing Gobld from launching instances</h2>
<p>An important thing to find out is whether or not all instances are failing to launch, or only a specific agent configuration.<br/>
<!-- -->If only CentOS 7 workers are failing to launch then this is most likely an issue with the built images rather than with Buildkite or the cloud provider.<br/>
<!-- -->There&#x27;s a heatmap on the <a class="euiLink euiLink--primary" href="https://ci-stats.elastic.co/s/jenkins/app/dashboards#/view/edb93e20-001b-11ec-9ff8-057e2acfff2f?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-4h%2Cto%3Anow))" rel="noreferrer">service dashboard<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--small euiIcon-isLoading euiLink__externalIcon" focusable="false" role="img" aria-label="External link" aria-hidden="true"></svg></a> that can reveal this quickly.</p>
<h3 id="gcp-having-problems-with-creating-new-instances" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#gcp-having-problems-with-creating-new-instances" rel="noreferrer" aria-label="GCP having problems with creating new instances permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>GCP having problems with creating new instances</h3>
<p>If all instances are failing to be created and are stuck in the queue then the first thing to do is test if you can manually launch an instance.</p>
<div><div class="euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="text"><span class="euiCodeBlock__line">gcloud compute --project=elastic-ci-prod instances create gobld-test --machine-type=custom-16-32768 --subnet=jenkins --image=family/elastic-devops-ci-ubuntu-1604-lts --image-project=elastic-images-prod --boot-disk-size=512GB --boot-disk-type=pd-ssd  --zone=us-central1-a
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>If Gobld is only having problems launching a single instance type, you can try changing the <code class="euiCode" data-code-language="text">--image</code> to the one being used in the <a class="euiLink euiLink--primary" href="/terraform/providers/gcp/env/elastic-apps-ci-prod/helm/values/gobld" rel="noreferrer">worker configuration</a>. If it turns out that the latest image is causing problems you can roll it back by running the <code class="euiCode" data-code-language="text">deprecate</code> command from the <a class="euiLink euiLink--primary" href="/packer2.0/scripts/README.md#packer-image-managerpy" rel="noreferrer">packer-image-manager.py</a> script.</p>
<h3 id="gcp-resource-quotas" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#gcp-resource-quotas" rel="noreferrer" aria-label="GCP resource quotas permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>GCP resource quotas</h3>
<p>Check whether or not we have run out of any particular resources in the <a class="euiLink euiLink--primary" href="https://console.cloud.google.com/iam-admin/quotas?project=elastic-ci-prod" rel="noreferrer">elastic-ci-prod<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--small euiIcon-isLoading euiLink__externalIcon" focusable="false" role="img" aria-label="External link" aria-hidden="true"></svg></a> project. You can click on &quot;Current Usage&quot; to sort by what percent each resource is being used.</p>
<h2 id="zonal-outages" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#zonal-outages" rel="noreferrer" aria-label="Zonal outages permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Zonal outages</h2>
<p>When launching a worker Gobld will choose a starting zone at random based on the build ID. After each failed launch attempt it will cycle to the next zone. So for short zonal outages, or quota shortages there should be no need to remove a zone from the configuration. If there are known long running issues with a zone it is also possible to remove it from the <code class="euiCode" data-code-language="text">zones</code> configuration to prevent Gobld from attempting to launch workers there.</p>
<h2 id="llama-riemann-expiry-alerts" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#llama-riemann-expiry-alerts" rel="noreferrer" aria-label="Llama Riemann Expiry alerts permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon-isLoading" focusable="false" role="img" aria-hidden="true"></svg></a>Llama Riemann Expiry alerts</h2>
<p>Llama will send an alert with the message &quot;No Gobld data has flowed into
Llama Riemann for 15 minutes&quot; if any Gobld process stops logging for any reason.
This was added due to issues where Filebeat would be correctly logging for only
some containers on a Kubernetes node. However it could also potentially be a
sign of a Gobld issue.</p>
<ul>
<li>
<p>Look at the logs for the Filebeat container that this pod is using:</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line">kubectl --namespace<span class="token operator">=</span>core-services logs -f <span class="token variable"><span class="token variable">$(</span>kubectl --namespace<span class="token operator">=</span>core-services get pod -l <span class="token assign-left variable">app</span><span class="token operator">=</span>filebeat-filebeat --field-selector spec.nodeName<span class="token operator">=</span><span class="token punctuation">$(</span>kubectl --namespace<span class="token operator">=</span>gobld get pod -l <span class="token assign-left variable">app</span><span class="token operator">=</span>gobld-buildkite-elastic -o <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">&#x27;{.items[].spec.nodeName}&#x27;</span><span class="token punctuation">)</span> -o name<span class="token variable">)</span></span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
</li>
<li>
<p>Attempt to restart the pod for the missing controller by deleting it:</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line">kubectl --namespace<span class="token operator">=</span>gobld delete pod -l <span class="token assign-left variable">app</span><span class="token operator">=</span>devops-ci
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
</li>
<li>
<p>Try restarting the Filebeat container that this pod is using:</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line">kubectl --namespace<span class="token operator">=</span>jenkins-support delete pod -l <span class="token assign-left variable">app</span><span class="token operator">=</span>filebeat-filebeat --field-selector spec.nodeName<span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>kubectl --namespace<span class="token operator">=</span>gobld get pod -l <span class="token assign-left variable">app</span><span class="token operator">=</span>devops-ci -o <span class="token assign-left variable">jsonpath</span><span class="token operator">=</span><span class="token string">&#x27;{.items[].spec.nodeName}&#x27;</span><span class="token variable">)</span></span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
</li>
</ul></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--subdued">Last updated: Mar 28th, 2022</div></div></div></div></div></div></div></div><footer class="docChromeFooter" data-elastic-exclude="true"><div class="euiFlexGroup euiFlexGroup--justifyContentSpaceAround euiFlexGroup--directionRow euiFlexGroup--responsive"><div class="euiFlexItem euiFlexItem--flexGrowZero docChromeFooter__container"><div class="euiFlexGroup euiFlexGroup--gutterExtraLarge euiFlexGroup--justifyContentSpaceBetween euiFlexGroup--directionRow euiFlexGroup--responsive"><div class="euiFlexItem"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--ghost"><p>Elasticsearch is a trademark of Elasticsearch B.V., registered in the U.S. and in other countries.</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the Apache Software Foundation in the United States and/or other countries.</p><p> <a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/trademarks" rel="">Trademarks</a><span class="docChromeFooter__divide">|</span><a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/terms-of-use" rel="">Terms of Use</a><span class="docChromeFooter__divide">|</span><a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/privacy-statement" rel="">Privacy</a><span class="docChromeFooter__divide">|</span>© <!-- -->2022<!-- --> Elasticsearch B.V. All Rights Reserved</p></div></div></div><div class="euiFlexItem euiFlexItem--flexGrowZero"></div><div class="euiFlexItem euiFlexItem--flexGrowZero"><figure class="euiImage docChromeFooter__logo"><img style="max-width:xs;max-height:xs;width:auto" src="/assets/images/logo-elastic-vertical-reverse.svg" class="euiImage__img" alt="Elastic logo"/></figure></div></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"bundle":"!function(e,t){\"object\"==typeof exports\u0026\u0026\"object\"==typeof module?module.exports=t(require(\"mdxJsReact\"),require(\"React\")):\"function\"==typeof define\u0026\u0026define.amd?define([\"mdxJsReact\",\"React\"],t):\"object\"==typeof exports?exports.MDXContent=t(require(\"mdxJsReact\"),require(\"React\")):e.MDXContent=t(e.mdxJsReact,e.React)}(this,((e,t)=\u003e(()=\u003e{\"use strict\";var n={24:e=\u003e{e.exports=t},825:t=\u003e{t.exports=e}},a={};function l(e){var t=a[e];if(void 0!==t)return t.exports;var o=a[e]={exports:{}};return n[e](o,o.exports,l),o.exports}l.n=e=\u003e{var t=e\u0026\u0026e.__esModule?()=\u003ee.default:()=\u003ee;return l.d(t,{a:t}),t},l.d=(e,t)=\u003e{for(var n in t)l.o(t,n)\u0026\u0026!l.o(e,n)\u0026\u0026Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},l.o=(e,t)=\u003eObject.prototype.hasOwnProperty.call(e,t),l.r=e=\u003e{\"undefined\"!=typeof Symbol\u0026\u0026Symbol.toStringTag\u0026\u0026Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var o={};return(()=\u003e{l.r(o),l.d(o,{default:()=\u003ea});var e=l(825),t=l(24),n=l.n(t);const a=function(){var t=arguments.length\u003e0\u0026\u0026void 0!==arguments[0]?arguments[0]:{},a=Object.assign({},(0,e.useMDXComponents)(),t.components),l=a.wrapper;return l?n().createElement(l,t,n().createElement(o)):o();function o(){var a=Object.assign({h2:\"h2\",ul:\"ul\",li:\"li\",a:\"a\",br:\"br\",code:\"code\",pre:\"pre\",p:\"p\",h3:\"h3\"},(0,e.useMDXComponents)(),t.components);return n().createElement(n().Fragment,null,n().createElement(a.h2,{id:\"useful-information\"},\"Useful information\"),\"\\n\",n().createElement(a.ul,null,\"\\n\",n().createElement(a.li,null,\"Take a look at the \",n().createElement(a.a,{href:\"https://ci-stats.elastic.co/s/jenkins/app/dashboards#/view/edb93e20-001b-11ec-9ff8-057e2acfff2f?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-4h%2Cto%3Anow))\"},\"Gobld Service Dashboard\")),\"\\n\",n().createElement(a.li,null,\"Gobld runs in our \",n().createElement(a.a,{href:\"../kubernetes.md\"},\"ci-systems-prod\"),\" platform.\",n().createElement(a.br),\"\\n\",\"Configure your \",n().createElement(a.code,{display:\"inline\"},\"kubectl\"),\" by running\",\"\\n\",n().createElement(a.pre,null,n().createElement(a.code,{display:\"block\"},\"cd terraform/providers/gcp/env/ci-systems-prod\\nmake kube-config\\n\")),\"\\n\"),\"\\n\",n().createElement(a.li,null,\"Gobld logs are sent to \",n().createElement(a.a,{href:\"https://ci-stats.elastic.co/goto/3254eeabab40a1c3ae17cb977b419ea0\"},\"ci-stats.elastic.co\")),\"\\n\",n().createElement(a.li,null,\"You can also view the logs in realtime by running:\",\"\\n\",n().createElement(a.pre,null,n().createElement(a.code,{display:\"block\"},\"kubectl logs --namespace=gobld -f deployments/gobld-buildkite-elastic -c gobld\\n\")),\"\\n\"),\"\\n\",n().createElement(a.li,null,\"Gobld is stateless and can be safely restarted. In Kubernetes land you do this by deleting the pod.\",\"\\n\",n().createElement(a.pre,null,n().createElement(a.code,{display:\"block\"},\"kubectl delete pod -l app=gobld-buildkite-elastic\\n\")),\"\\n\"),\"\\n\",n().createElement(a.li,null,\"Agents are launched in the \",n().createElement(a.a,{href:\"https://console.cloud.google.com/compute/instances?folder=\u0026organizationId=992493199029\u0026project=elastic-ci-prod\u0026filter=%255B%257B_22k_22_3A_22_22_2C_22t_22_3A10_2C_22v_22_3A_22_5C_22immutable_5C_22_22%257D%255D\"},\"elastic-ci-prod\"),\" project.\"),\"\\n\"),\"\\n\",n().createElement(a.h2,{id:\"potential-problems-preventing-gobld-from-launching-instances\"},\"Potential problems preventing Gobld from launching instances\"),\"\\n\",n().createElement(a.p,null,\"An important thing to find out is whether or not all instances are failing to launch, or only a specific agent configuration.\",n().createElement(a.br),\"\\n\",\"If only CentOS 7 workers are failing to launch then this is most likely an issue with the built images rather than with Buildkite or the cloud provider.\",n().createElement(a.br),\"\\n\",\"There's a heatmap on the \",n().createElement(a.a,{href:\"https://ci-stats.elastic.co/s/jenkins/app/dashboards#/view/edb93e20-001b-11ec-9ff8-057e2acfff2f?_g=(filters%3A!()%2CrefreshInterval%3A(pause%3A!t%2Cvalue%3A0)%2Ctime%3A(from%3Anow-4h%2Cto%3Anow))\"},\"service dashboard\"),\" that can reveal this quickly.\"),\"\\n\",n().createElement(a.h3,{id:\"gcp-having-problems-with-creating-new-instances\"},\"GCP having problems with creating new instances\"),\"\\n\",n().createElement(a.p,null,\"If all instances are failing to be created and are stuck in the queue then the first thing to do is test if you can manually launch an instance.\"),\"\\n\",n().createElement(a.pre,null,n().createElement(a.code,{display:\"block\"},\"gcloud compute --project=elastic-ci-prod instances create gobld-test --machine-type=custom-16-32768 --subnet=jenkins --image=family/elastic-devops-ci-ubuntu-1604-lts --image-project=elastic-images-prod --boot-disk-size=512GB --boot-disk-type=pd-ssd  --zone=us-central1-a\\n\")),\"\\n\",n().createElement(a.p,null,\"If Gobld is only having problems launching a single instance type, you can try changing the \",n().createElement(a.code,{display:\"inline\"},\"--image\"),\" to the one being used in the \",n().createElement(a.a,{href:\"/terraform/providers/gcp/env/elastic-apps-ci-prod/helm/values/gobld\"},\"worker configuration\"),\". If it turns out that the latest image is causing problems you can roll it back by running the \",n().createElement(a.code,{display:\"inline\"},\"deprecate\"),\" command from the \",n().createElement(a.a,{href:\"/packer2.0/scripts/README.md#packer-image-managerpy\"},\"packer-image-manager.py\"),\" script.\"),\"\\n\",n().createElement(a.h3,{id:\"gcp-resource-quotas\"},\"GCP resource quotas\"),\"\\n\",n().createElement(a.p,null,\"Check whether or not we have run out of any particular resources in the \",n().createElement(a.a,{href:\"https://console.cloud.google.com/iam-admin/quotas?project=elastic-ci-prod\"},\"elastic-ci-prod\"),' project. You can click on \"Current Usage\" to sort by what percent each resource is being used.'),\"\\n\",n().createElement(a.h2,{id:\"zonal-outages\"},\"Zonal outages\"),\"\\n\",n().createElement(a.p,null,\"When launching a worker Gobld will choose a starting zone at random based on the build ID. After each failed launch attempt it will cycle to the next zone. So for short zonal outages, or quota shortages there should be no need to remove a zone from the configuration. If there are known long running issues with a zone it is also possible to remove it from the \",n().createElement(a.code,{display:\"inline\"},\"zones\"),\" configuration to prevent Gobld from attempting to launch workers there.\"),\"\\n\",n().createElement(a.h2,{id:\"llama-riemann-expiry-alerts\"},\"Llama Riemann Expiry alerts\"),\"\\n\",n().createElement(a.p,null,'Llama will send an alert with the message \"No Gobld data has flowed into\\nLlama Riemann for 15 minutes\" if any Gobld process stops logging for any reason.\\nThis was added due to issues where Filebeat would be correctly logging for only\\nsome containers on a Kubernetes node. However it could also potentially be a\\nsign of a Gobld issue.'),\"\\n\",n().createElement(a.ul,null,\"\\n\",n().createElement(a.li,null,\"\\n\",n().createElement(a.p,null,\"Look at the logs for the Filebeat container that this pod is using:\"),\"\\n\",n().createElement(a.pre,null,n().createElement(a.code,{className:\"language-bash\",display:\"block\"},\"kubectl --namespace=core-services logs -f $(kubectl --namespace=core-services get pod -l app=filebeat-filebeat --field-selector spec.nodeName=$(kubectl --namespace=gobld get pod -l app=gobld-buildkite-elastic -o jsonpath='{.items[].spec.nodeName}') -o name)\\n\")),\"\\n\"),\"\\n\",n().createElement(a.li,null,\"\\n\",n().createElement(a.p,null,\"Attempt to restart the pod for the missing controller by deleting it:\"),\"\\n\",n().createElement(a.pre,null,n().createElement(a.code,{className:\"language-bash\",display:\"block\"},\"kubectl --namespace=gobld delete pod -l app=devops-ci\\n\")),\"\\n\"),\"\\n\",n().createElement(a.li,null,\"\\n\",n().createElement(a.p,null,\"Try restarting the Filebeat container that this pod is using:\"),\"\\n\",n().createElement(a.pre,null,n().createElement(a.code,{className:\"language-bash\",display:\"block\"},\"kubectl --namespace=jenkins-support delete pod -l app=filebeat-filebeat --field-selector spec.nodeName=$(kubectl --namespace=gobld get pod -l app=devops-ci -o jsonpath='{.items[].spec.nodeName}')\\n\")),\"\\n\"),\"\\n\"))}}})(),o})()));","frontmatter":{"id":"ciGobldTroubleshooting","slug":"/ci/gobld/troubleshooting","title":"Troubleshooting","summary":"Gobld Troubleshooting guide plus some tips and tricks","date":"2022-03-28T00:00:00.000Z","tags":["ci","ci/cd","developer tools","buildkite","gobld","engineering","platform"],"link":"https://github.com/elastic/ci/blob/main","linkPath":"docs/gobld/troubleshooting.mdx"},"missionId":"krVideos"},"__N_SSG":true},"page":"/[...slug]","query":{"slug":["ci","gobld","troubleshooting"]},"buildId":"AzE3g5BBfFWf9aUdpqGZ7","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>