{"pageProps":{"bundle":"!function(e,n){\"object\"==typeof exports&&\"object\"==typeof module?module.exports=n(require(\"mdxJsReact\"),require(\"React\")):\"function\"==typeof define&&define.amd?define([\"mdxJsReact\",\"React\"],n):\"object\"==typeof exports?exports.MDXContent=n(require(\"mdxJsReact\"),require(\"React\")):e.MDXContent=n(e.mdxJsReact,e.React)}(this,((e,n)=>(()=>{\"use strict\";var t={24:e=>{e.exports=n},825:n=>{n.exports=e}},l={};function i(e){var n=l[e];if(void 0!==n)return n.exports;var a=l[e]={exports:{}};return t[e](a,a.exports,i),a.exports}i.n=e=>{var n=e&&e.__esModule?()=>e.default:()=>e;return i.d(n,{a:n}),n},i.d=(e,n)=>{for(var t in n)i.o(n,t)&&!i.o(e,t)&&Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},i.o=(e,n)=>Object.prototype.hasOwnProperty.call(e,n),i.r=e=>{\"undefined\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var a={};return(()=>{i.r(a),i.d(a,{default:()=>l});var e=i(825),n=i(24),t=i.n(n);const l=function(){var n=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},l=Object.assign({},(0,e.useMDXComponents)(),n.components),i=l.wrapper;return i?t().createElement(i,n,t().createElement(a)):a();function a(){var l=Object.assign({p:\"p\",h2:\"h2\",h3:\"h3\",ol:\"ol\",li:\"li\",code:\"code\",h4:\"h4\",pre:\"pre\",a:\"a\"},(0,e.useMDXComponents)(),n.components);return t().createElement(t().Fragment,null,t().createElement(l.p,null,\"Sometimes Orka doesn't work as we expect it to.\"),\"\\n\",t().createElement(l.h2,{id:\"initial-tips\"},\"Initial tips\"),\"\\n\",t().createElement(l.h3,{id:\"increase-the-log-level\"},\"Increase the log level\"),\"\\n\",t().createElement(l.ol,null,\"\\n\",t().createElement(l.li,null,\"Go to \",t().createElement(l.code,{display:\"inline\"},\"Manage Jenkins\"),\" -> \",t().createElement(l.code,{display:\"inline\"},\"System Log\")),\"\\n\",t().createElement(l.li,null,\"Click \",t().createElement(l.code,{display:\"inline\"},\"Add\"),\" new log recorder and give it a name\"),\"\\n\",t().createElement(l.li,null,\"Click \",t().createElement(l.code,{display:\"inline\"},\"Add\"),\" under the \",t().createElement(l.code,{display:\"inline\"},\"Loggers\"),\" section\"),\"\\n\",t().createElement(l.li,null,\"Type \",t().createElement(l.code,{display:\"inline\"},\"io.jenkins.plugins.orka\"),\" for Logger and set \",t().createElement(l.code,{display:\"inline\"},\"Log Level\"),\" to \",t().createElement(l.code,{display:\"inline\"},\"All\")),\"\\n\",t().createElement(l.li,null,\"Click \",t().createElement(l.code,{display:\"inline\"},\"Save\")),\"\\n\"),\"\\n\",t().createElement(l.p,null,\"This will create a new log output in the Jenkins UI where you can see\\na bit more detail about what Orka is doing.  Recreate the issue, if\\npossible, and check the log output to see if there is any useful\\ninformation.\"),\"\\n\",t().createElement(l.h3,{id:\"orka-isnt-spinning-up-any-nodes\"},\"Orka isn't spinning up any nodes\"),\"\\n\",t().createElement(l.h4,{id:\"check-for-zombie-nodes\"},\"Check for zombie nodes\"),\"\\n\",t().createElement(l.p,null,\"If there are messages in the Jenkins log about there not being any\\nOrka nodes with enough capacity but there aren't any running nodes\\nregistered in Jenkins, it can happen where the plugin gets out of sync\\nwith reality and also fails to shut down nodes.\"),\"\\n\",t().createElement(l.p,null,\"Some example logs:\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{display:\"block\"},\"Feb 24, 2022 11:27:03 AM FINE io.jenkins.plugins.orka.AgentTemplate\\nDeploymentResponse [errors=[Requested CPU is not available in the cluster\\nNo available nodes with sufficient Memory], host=null, id=null, message=, sshPort=0]\\nFeb 24, 2022 11:27:03 AM WARNING io.jenkins.plugins.orka.AgentTemplate\\nDeploying VM failed with: HTTP Code: 500, Error: [Requested CPU is not available in the cluster\\nNo available nodes with sufficient Memory]\\n\")),\"\\n\",t().createElement(l.p,null,\"or even\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{display:\"block\"},\"Feb 24, 2022 8:15:41 PM FINE io.jenkins.plugins.orka.OrkaCloud\\n[provisionId=e38761cd-c09c-429d-9156-6ef7fa494911] . Asked for 1 VMs and got 0\\n\")),\"\\n\",t().createElement(l.ol,null,\"\\n\",t().createElement(l.li,null,\"Connect to the Orka VPN\"),\"\\n\",t().createElement(l.li,null,\"Run \",t().createElement(l.code,{display:\"inline\"},\"orka vm list -f all\"),\" to get a full listing of running VMs\"),\"\\n\",t().createElement(l.li,null,\"Use \",t().createElement(l.code,{display:\"inline\"},\"orka vm delete -v <VM ID>\"),\" to remove zombie nodes\"),\"\\n\"),\"\\n\",t().createElement(l.p,null,\"What is a zombie node?  It is a node that is still running in Orka but\\nis not connected to any Jenkins server.  If the name of the node isn't\\nclear enough, you might need to check a few Jenkins controllers to\\ncorrectly identify if a node is a zombie.\"),\"\\n\",t().createElement(l.h4,{id:\"check-the-orka-plugins-configured-capacity\"},\"Check the Orka plugin's configured capacity\"),\"\\n\",t().createElement(l.p,null,\"The easiest way to do this is to:\"),\"\\n\",t().createElement(l.ol,null,\"\\n\",t().createElement(l.li,null,\"go to the Jenkins controller\"),\"\\n\",t().createElement(l.li,null,\"click on \",t().createElement(l.code,{display:\"inline\"},\"Manage Jenkins\"),\" followed by \",t().createElement(l.code,{display:\"inline\"},\"Script Console\")),\"\\n\",t().createElement(l.li,null,\"put \",t().createElement(l.code,{display:\"inline\"},'Jenkins.instance.clouds.getByName(\"MacStadium Orka\").capacityHandler.instanceCap'),\" into the box and press \",t().createElement(l.code,{display:\"inline\"},\"Run\")),\"\\n\"),\"\\n\",t().createElement(l.p,null,\"If the number is not \",t().createElement(l.code,{display:\"inline\"},\"2147483647\"),\" then the instance cap is set\\nincorrectly.\"),\"\\n\",t().createElement(l.ol,null,\"\\n\",t().createElement(l.li,null,\"browse back to \",t().createElement(l.code,{display:\"inline\"},\"Manage Jenkins\"),\" > \",t().createElement(l.code,{display:\"inline\"},\"Manage nodes and clouds\"),\" >\\n\",t().createElement(l.code,{display:\"inline\"},\"Configure Clouds\")),\"\\n\",t().createElement(l.li,null,\"Under the section for Orka (search for \",t().createElement(l.code,{display:\"inline\"},\"ORKA Config\"),\"), click on\\n\",t().createElement(l.code,{display:\"inline\"},\"Advanced\")),\"\\n\",t().createElement(l.li,null,\"Delete any value in the box labeled \",t().createElement(l.code,{display:\"inline\"},\"Max Jenkins Agents Limit\")),\"\\n\",t().createElement(l.li,null,\"Click \",t().createElement(l.code,{display:\"inline\"},\"Save\")),\"\\n\"),\"\\n\",t().createElement(l.h2,{id:\"open-a-support-ticket\"},\"Open a Support Ticket\"),\"\\n\",t().createElement(l.p,null,\"Assuming we have failed to identify/resolve the issue and we're out of\\nideas, we can open an support ticket with MacStadium.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.a,{href:\"https://docs.macstadium.com/docs/create-tickets-in-slack\"},\"https://docs.macstadium.com/docs/create-tickets-in-slack\")),\"\\n\",t().createElement(l.ol,null,\"\\n\",t().createElement(l.li,null,\"\\n\",t().createElement(l.p,null,\"Join the \",t().createElement(l.code,{display:\"inline\"},\"#elastic-macstadium\"),\" channel in Slack\"),\"\\n\"),\"\\n\",t().createElement(l.li,null,\"\\n\",t().createElement(l.p,null,\"Describe the issue and then add the ðŸ›Ž (\",t().createElement(l.code,{display:\"inline\"},\":bellhop_bell:\"),\") emoji\\nreaction to the message.  Respond to the Halp prompts.  This will\\ncreate a support ticket in their system.\"),\"\\n\"),\"\\n\",t().createElement(l.li,null,\"\\n\",t().createElement(l.p,null,\"Respond to the message in a thread with further details or\\nexamples.  Each threaded message will be converted into a comment\\non the support ticket.  Any responses to the ticket outside of\\nSlack will be relayed back to the Slack thread.\"),\"\\n\"),\"\\n\"))}}})(),a})()));","frontmatter":{"id":"macstadiumOrkaTroubleshooting","slug":"/ci/macstadium/troubleshooting","title":"Orka Troubleshooting","summary":"Common issues and how to resolve them","date":"2022-05-31T00:00:00.000Z","tags":["ci","ci/cd","macos","orka","developer tools","engineering","platform","troubleshooting"],"link":"https://github.com/elastic/ci/blob/main","linkPath":"docs/macstadium/troubleshooting.mdx"},"missionId":"krVideos"},"__N_SSG":true}