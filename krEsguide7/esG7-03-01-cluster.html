<!DOCTYPE html><html lang="en"><head><meta name="eui-styles"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-24"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'UA-12395217-24', {
                page_path: window.location.pathname,
              });
          </script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try{var d=document.documentElement;var e=localStorage.getItem("elastic-docs-theme");if(e){d.setAttribute('data-theme', e)}else{d.setAttribute('data-theme', 'light');}}catch(t){}}();</script><title>3.1 클러스터 구성 | Elastic Documentation</title><meta property="og:title" content="3.1 클러스터 구성 | Elastic Documentation"/><meta class="elastic" name="title" content="3.1 클러스터 구성"/><meta class="elastic" name="date"/><meta name="description" content="모든 문서에 대한 저작권은 Elastic 과 김종민(kimjmin@gmail.com) 에게 있으며 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 포함된 자료를 인용하고자 하는 경우 출처를 명시하고 게재된 주소를 김종민(kimjmin@gmail.com)에게 알려주시기 바랍니다. date: 2022-01-25"/><meta property="og:description" content="모든 문서에 대한 저작권은 Elastic 과 김종민(kimjmin@gmail.com) 에게 있으며 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 포함된 자료를 인용하고자 하는 경우 출처를 명시하고 게재된 주소를 김종민(kimjmin@gmail.com)에게 알려주시기 바랍니다. date: 2022-01-25"/><meta name="twitter:site" content="@elastic"/><meta property="og:url" content="http://localhost:3000/krEsguide7/esG7-03-01-cluster"/><link rel="stylesheet" type="text/css" href="/themes/eui_theme_undefined.min.css"/><link rel="stylesheet" type="text/css" href="/themes/theme_undefined.css"/><link rel="shortcut icon" href="/assets/images/favicon.ico"/><meta name="next-head-count" content="14"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/_next/static/chunks/webpack-5b19eee634f155d9037d.js" defer=""></script><script src="/_next/static/chunks/framework-bf9b12c23e794b196495.js" defer=""></script><script src="/_next/static/chunks/main-710a14204f294c81ed08.js" defer=""></script><script src="/_next/static/chunks/pages/_app-d9a28ac2b5165b299106.js" defer=""></script><script src="/_next/static/chunks/c78d26b1-ff6470003369f2a26fc7.js" defer=""></script><script src="/_next/static/chunks/103-fd3e1552f32e8c4a6b92.js" defer=""></script><script src="/_next/static/chunks/3674-41861bc71d856d154d9e.js" defer=""></script><script src="/_next/static/chunks/7815-952dc762df3d4a43befe.js" defer=""></script><script src="/_next/static/chunks/9237-e960f47bcd4625ef5949.js" defer=""></script><script src="/_next/static/chunks/4620-e195c3f5ae7ecefc57c7.js" defer=""></script><script src="/_next/static/chunks/8482-d6a48a2948368737094e.js" defer=""></script><script src="/_next/static/chunks/pages/%5B...slug%5D-ac753ff46f79468d535c.js" defer=""></script><script src="/_next/static/K8YMqTQBQVe0pMujUHgY0/_buildManifest.js" defer=""></script><script src="/_next/static/K8YMqTQBQVe0pMujUHgY0/_ssgManifest.js" defer=""></script></head><body class="guideBody"><div id="__next"><div class="docWrapper"><header data-elastic-exclude="true"><div class="euiHeader euiHeader--dark euiHeader--fixed"><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><a rel="noreferrer" class="euiHeaderLogo"><svg data-type="logoElastic" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32" class="euiIcon euiIcon--large euiHeaderLogo__icon" focusable="false" role="img" aria-label="Elastic"><path class="outline" fill-rule="evenodd" clip-rule="evenodd" d="M30.86 13.129A6.333 6.333 0 0132 16.77a6.419 6.419 0 01-1.162 3.652 6.382 6.382 0 01-3.032 2.331 4.833 4.833 0 01-1.672 5.542 4.789 4.789 0 01-5.77-.074 9.016 9.016 0 01-4.5 3.322 8.982 8.982 0 01-5.587.023 9.014 9.014 0 01-4.526-3.287 9.067 9.067 0 01-1.727-5.333c0-.579.053-1.156.16-1.725A6.305 6.305 0 011.145 18.9 6.341 6.341 0 010 15.242a6.42 6.42 0 011.163-3.652 6.384 6.384 0 013.035-2.33 4.833 4.833 0 011.658-5.557 4.789 4.789 0 015.78.07 9.037 9.037 0 014.93-3.446 9.007 9.007 0 015.994.419 9.05 9.05 0 014.407 4.098 9.097 9.097 0 01.873 5.965 6.298 6.298 0 013.02 2.32zm-18.28.658l7.002 3.211 7.066-6.213a7.85 7.85 0 00.152-1.557c0-1.692-.539-3.34-1.54-4.704a7.897 7.897 0 00-4.02-2.869 7.87 7.87 0 00-4.932.086 7.9 7.9 0 00-3.92 3.007l-1.174 6.118 1.367 2.92-.001.001zm-7.247 7.441A7.964 7.964 0 006.72 27.53a7.918 7.918 0 004.04 2.874 7.89 7.89 0 004.95-.097 7.92 7.92 0 003.926-3.03l1.166-6.102-1.555-2.985-7.03-3.211-6.885 6.248.001.001zm4.755-11.024l-4.8-1.137.002-.002a3.82 3.82 0 011.312-4.358 3.785 3.785 0 014.538.023l-1.052 5.474zm-5.216.01a5.294 5.294 0 00-2.595 1.882 5.324 5.324 0 00-.142 6.124 5.287 5.287 0 002.505 2l6.733-6.101-1.235-2.65-5.266-1.255zm18.286 17.848a3.737 3.737 0 01-2.285-.785l1.037-5.454 4.8 1.125a3.812 3.812 0 01-1.801 4.68c-.54.283-1.14.432-1.751.434zm-1.31-7.499l5.28 1.238a5.34 5.34 0 002.622-1.938 5.37 5.37 0 001.013-3.106 5.311 5.311 0 00-.936-3.01 5.282 5.282 0 00-2.475-1.944l-6.904 6.07 1.4 2.69z" fill="#fff"></path><path d="M12.58 13.787l7.002 3.211 7.066-6.213a7.849 7.849 0 00.152-1.557c0-1.692-.539-3.34-1.54-4.704a7.897 7.897 0 00-4.02-2.869 7.87 7.87 0 00-4.932.086 7.9 7.9 0 00-3.92 3.007l-1.174 6.118 1.367 2.92-.001.001z" fill="#FEC514"></path><path d="M5.333 21.228A7.964 7.964 0 006.72 27.53a7.918 7.918 0 004.04 2.874 7.89 7.89 0 004.95-.097 7.92 7.92 0 003.926-3.03l1.166-6.102-1.555-2.985-7.03-3.211-6.885 6.248.001.001z" fill="#00BFB3"></path><path d="M5.288 9.067l4.8 1.137L11.14 4.73a3.785 3.785 0 00-5.914 1.94 3.82 3.82 0 00.064 2.395" fill="#F04E98"></path><path d="M4.872 10.214a5.294 5.294 0 00-2.595 1.882 5.324 5.324 0 00-.142 6.124 5.287 5.287 0 002.505 2l6.733-6.101-1.235-2.65-5.266-1.255z" fill="#1BA9F5"></path><path d="M20.873 27.277a3.736 3.736 0 002.285.785 3.783 3.783 0 003.101-1.63 3.812 3.812 0 00.451-3.484l-4.8-1.125-1.037 5.454z" fill="#93C90E"></path><path d="M21.848 20.563l5.28 1.238a5.34 5.34 0 002.622-1.938 5.37 5.37 0 001.013-3.106 5.312 5.312 0 00-.936-3.01 5.283 5.283 0 00-2.475-1.944l-6.904 6.07 1.4 2.69z" fill="#07C"></path></svg><span class="euiHeaderLogo__text"><svg class="elasticMark" width="64" height="19" fill="white" xmlns="http://www.w3.org/2000/svg" aria-labelledby="elasticMark"><title id="elasticMark">Elastic</title><path d="M9.74 16.882l.711-.076.046 1.455c-1.879.257-3.485.393-4.818.393-1.773 0-3.03-.515-3.773-1.545C1.164 16.08.8 14.473.8 12.306c0-4.333 1.727-6.5 5.167-6.5 1.666 0 2.909.47 3.727 1.394.818.924 1.227 2.394 1.227 4.379l-.106 1.409H2.664c0 1.364.242 2.379.742 3.03.5.652 1.349.985 2.576.985 1.242.03 2.485-.015 3.757-.121zm-.667-5.349c0-1.515-.243-2.59-.728-3.212-.484-.621-1.272-.94-2.363-.94s-1.924.334-2.47.986c-.545.651-.833 1.712-.848 3.166h6.409zM13.497 18.427V.7h1.848v17.727h-1.848zM27.027 9.806v6.076c0 .621 1.53.742 1.53.742l-.09 1.637c-1.303 0-2.38.106-3.03-.515a10.861 10.861 0 01-4.44.924c-1.136 0-2-.319-2.59-.97-.592-.636-.895-1.56-.895-2.773 0-1.197.303-2.09.91-2.651.605-.56 1.56-.925 2.863-1.046l3.879-.363v-1.06c0-.834-.182-1.44-.546-1.804-.363-.364-.863-.545-1.485-.545H18.27V5.82h4.742c1.394 0 2.41.318 3.046.97.651.636.97 1.651.97 3.015zm-7.606 5.03c0 1.516.621 2.273 1.879 2.273a9.89 9.89 0 003.303-.56l.56-.197v-4.076l-3.65.348c-.743.06-1.274.273-1.607.637-.333.363-.485.894-.485 1.575zM34.255 7.473c-1.788 0-2.697.62-2.697 1.879 0 .575.212.984.62 1.227.41.242 1.35.485 2.819.742 1.47.258 2.5.606 3.106 1.076.606.454.91 1.318.91 2.59 0 1.274-.41 2.198-1.228 2.789-.818.59-2 .894-3.576.894-1.015 0-4.424-.38-4.424-.38l.106-1.605c1.954.182 3.379.333 4.333.333.955 0 1.682-.151 2.182-.454.5-.303.758-.819.758-1.53 0-.713-.212-1.198-.637-1.455-.424-.258-1.363-.5-2.818-.728-1.455-.227-2.485-.56-3.09-1.015-.607-.439-.91-1.272-.91-2.47 0-1.196.424-2.09 1.273-2.666.848-.576 1.909-.864 3.166-.864 1 0 4.485.258 4.485.258v1.621c-1.833-.106-3.333-.242-4.379-.242zM47.952 7.685h-3.925v5.909c0 1.409.106 2.348.303 2.788.212.44.697.666 1.47.666l2.197-.151.121 1.53c-1.106.182-1.94.273-2.515.273-1.288 0-2.167-.318-2.667-.94-.5-.62-.742-1.818-.742-3.575v-6.5h-1.758V6.079h1.758V2.29h1.833v3.773h3.925v1.62zM50.527 3.276V1.139h1.849v2.152l-1.849-.015zm0 15.151V6.08h1.849v12.348h-1.849zM60.406 5.821c.546 0 1.47.106 2.773.303l.59.076-.075 1.5c-1.318-.152-2.288-.227-2.91-.227-1.393 0-2.348.333-2.848 1-.5.666-.757 1.909-.757 3.712 0 1.803.227 3.06.697 3.773.47.712 1.44 1.06 2.924 1.06l2.91-.227.075 1.53c-1.53.227-2.682.349-3.44.349-1.924 0-3.257-.5-3.984-1.485-.728-.985-1.106-2.652-1.106-5 0-2.349.393-4 1.181-4.94.803-.939 2.122-1.424 3.97-1.424z"></path></svg></span></a></div></div><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><nav class="euiHeaderLinks" aria-label="App menu"><div class="euiHeaderLinks__list euiHeaderLinks__list--gutterS"><a class="euiButton euiButton--primary euiButton--small euiButton--fill" href="https://cloud.elastic.co/registration?source=docsHeader" rel=""><span class="euiButtonContent euiButton__content"><span class="euiButton__text">Try Free</span></span></a></div></nav></div></div></div></header><div class="euiPage euiPage--grow docArticle__template"><div class="euiPageSideBar euiPageSideBar--paddingLarge euiPageSideBar--sticky docChrome__sidebar"><div class="euiFlexItem" data-elastic-exclude="true"><div class="euiContextMenu docChrome__contextMenu"><div class="euiContextMenuPanel euiContextMenu__panel" tabindex="-1"><button class="euiContextMenuPanelTitle" type="button" data-test-subj="contextMenuPanelTitleButton"><span class="euiContextMenu__itemLayout"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="euiIcon euiIcon--medium euiContextMenu__icon" focusable="false" role="img" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.018 14.043a.75.75 0 00.024-1.06l-4.59-4.81a.25.25 0 010-.346l4.59-4.81a.75.75 0 10-1.085-1.035l-4.59 4.81a1.75 1.75 0 000 2.416l4.59 4.81c.286.3.761.31 1.06.024z"></path></svg><span class="euiContextMenu__text">Elastic 가이드북 (7.x)</span></span></button><div><div class="euiSpacer euiSpacer--s css-i2qclb-euiSpacer-s"></div><nav class="euiSideNav" aria-label="Elastic 가이드북 (7.x)"><div id="euiSideNav_36aee170-e932-11ec-a4d3-518f76c81a36_content" class="euiSideNav__content euiSideNav__contentMobile-xs euiSideNav__contentMobile-s"><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1. 서문</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1. 서문</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-elastic-stack" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1 Elastic Stack 소개</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-01-elasticsearch" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1.1 Elasticsearch</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-02-logstash" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1.2 Logstash</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-03-kibana" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1.3 Kibana</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-04-beats" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1.4 Beats</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2. Elasticsearch 시작하기</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2. Elasticsearch 시작하기</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-01-data-indexing" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.1 데이터 색인</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-02-install-run" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.2 설치 및 실행</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-02-01-download" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.2.1 다운로드 설치 및 실행</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-02-02-unix-rpm" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.2.2 Unix RPM 설치 및 실행</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-es-config" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3 Elasticsearch 환경 설정</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-01-jvm" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3.1 jvm.options</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-02-es-yml" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3.2 elasticsearch.yml</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-03-node-config" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3.3 노드의 역할 : master, data, insgest</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-04-cmd" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3.4 커맨드 라인 설정</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3. Elasticsearch 시스템 구조</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-03-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3. Elasticsearch 시스템 구조</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable euiSideNavItemButton-isSelected" href="/krEsguide7/esG7-03-01-cluster" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3.1 클러스터 구성</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-03-02-index-shard" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3.2 인덱스와 샤드 - Index &amp; Shards</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-03-03-master-data-nodes" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3.3 마스터 노드와 데이터 노드 - Master &amp; Data Nodes</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4. Elasticsearch 데이터 처리</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4. Elasticsearch 데이터 처리</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-01-rest-api" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4.1 REST API</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-02-crud" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4.2 CRUD - 입력,조회,수정,삭제</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-03-bulk-api" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4.3 벌크 - _bulk API</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-04-search-api" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4.4 검색 - _search API</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5. 검색과 쿼리 - Query DSL</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5. 검색과 쿼리 - Query DSL</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-01-fulltext" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.1 풀텍스트 쿼리 - Full Text Query</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-02-bool" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.2 복합 쿼리 - Bool Query</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-03-relevancy" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.3 정확도 - Relevancy</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-04-bool-should" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.4 bool : sould</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-05-exact-value" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.5 정확값 쿼리 - Exact Value Query</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-06-range" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.6 범위 쿼리 - Range Query</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6. 데이터 색인과 텍스트 분석</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6. 데이터 색인과 텍스트 분석</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-01-inverted-index" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.1 역 인덱스 - Inverted Index</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-02-text-analysis" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.2 텍스트 분석 - Text Analysis</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-03-analyzer" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.3 애널라이저 - Analyzer</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-04-char-filter" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.4 캐릭터 필터 - Character Filter</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-05-tokenizer" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.5 토크나이저 - Tokenizer</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-06-token-filter" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.6 토큰 필터 - Token Filter</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-07-stemming" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.7 형태소 분석 - Stemming</span></span></a></div></div></div></div></nav></div></div></div></div></div><div class="euiPanel euiPanel--paddingLarge euiPanel--borderRadiusNone euiPanel--plain euiPanel--hasShadow euiPageBody euiPageBody--borderRadiusNone euiPageBody--paddingLarge"><div class="euiFlexGroup euiFlexGroup--gutterExtraLarge euiFlexGroup--directionRow euiFlexGroup--responsive docArticle__wrap"><div class="euiFlexItem docArticle__article"><header class="euiPageHeader euiPageHeader--bottomBorder euiPageHeader--responsive euiPageHeader--center"><div class="euiPageHeaderContent"><div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--alignItemsFlexStart euiFlexGroup--directionRow euiFlexGroup--responsive euiPageHeaderContent__top"><div class="euiFlexItem"><h1 class="euiTitle euiTitle--large">3.1 클러스터 구성</h1><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div class="euiText euiText--medium euiText--constrainedWidth"><p><span class="euiTextColor euiTextColor--subdued">모든 문서에 대한 저작권은 Elastic 과 김종민(kimjmin@gmail.com) 에게 있으며 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 포함된 자료를 인용하고자 하는 경우 출처를 명시하고 게재된 주소를 김종민(kimjmin@gmail.com)에게 알려주시기 바랍니다. date: 2022-01-25</span></p></div></div></div></div></header><div class="euiSpacer euiSpacer--xl css-kiiy9t-euiSpacer-xl"></div><div class="euiPanel euiPanel--borderRadiusMedium euiPanel--plain euiPanel--noShadow euiPageContent" role="main"><div class="euiPageContentBody"><div class="euiText euiText--medium"><h2 id="여러-서버에-하나의-클러스터로-실행" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#여러-서버에-하나의-클러스터로-실행" rel="noreferrer" aria-label="여러 서버에 하나의 클러스터로 실행 permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>여러 서버에 하나의 클러스터로 실행</h2>
<p>Elasticsearch의 노드들은 클라이언트와의 통신을 위한 http 포트(9200~9299), 노드 간의 데이터 교환을 위한 tcp 포트 (9300~9399) 총 2개의 네트워크 통신을 열어두고 있습니다. 일반적으로 1개의 물리 서버마다 하나의 노드를 실행하는 것을 권장하고 있습니다. 3개의 다른 물리 서버에서 각각 1개 씩의 노드를 실행하면 각 클러스터는 다음과 같이 구성됩니다.</p>
<p><figure class="euiImage euiImage--hasShadow euiImage--allowFullScreen euiImage--original"><button type="button" aria-label="Open fullscreen 각 서버에서 노드 실행 image" class="euiImage__button" data-test-subj="activateFullScreenButton"><img src="/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/03-01_cluster_1.png" alt="각 서버에서 노드 실행" class="euiImage__img" title="각 서버에서 노드 실행"/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon--ghost euiImage__icon" focusable="false" role="img" aria-hidden="true"><path d="M13 3v4h-1V4H9V3h4zM3 3h4v1H4v3H3V3zm10 10H9v-1h3V9h1v4zM3 13V9h1v3h3v1H3zM0 1.994C0 .893.895 0 1.994 0h12.012C15.107 0 16 .895 16 1.994v12.012A1.995 1.995 0 0114.006 16H1.994A1.995 1.995 0 010 14.006V1.994zm1 0v12.012c0 .548.446.994.994.994h12.012a.995.995 0 00.994-.994V1.994A.995.995 0 0014.006 1H1.994A.995.995 0 001 1.994z" fill-rule="evenodd"></path></svg></button></figure></p>
<p>하나의 물리적인 서버 안에서 여러 개의 노드를 실행하는 것도 가능합니다. 이 경우에는 각 노드들은 차례대로 9200, 9201… 순으로 포트를 사용하게 됩니다. 클라이언트는 9200, 9201 등의 포트를 통해 원하는 노드와 통신을 할 수 있습니다. 만약에 서버1 에서 두개의 노드를 실행하고, 또 다른 서버에서 한개의 노드를 실행시키면 클러스터는 다음과 같이 구성됩니다.</p>
<p><figure class="euiImage euiImage--hasShadow euiImage--allowFullScreen euiImage--original"><button type="button" aria-label="Open fullscreen 한 서버에서 여러 노드 실행 image" class="euiImage__button" data-test-subj="activateFullScreenButton"><img src="/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/03-01_cluster_2.png" alt="한 서버에서 여러 노드 실행" class="euiImage__img" title="한 서버에서 여러 노드 실행"/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon--ghost euiImage__icon" focusable="false" role="img" aria-hidden="true"><path d="M13 3v4h-1V4H9V3h4zM3 3h4v1H4v3H3V3zm10 10H9v-1h3V9h1v4zM3 13V9h1v3h3v1H3zM0 1.994C0 .893.895 0 1.994 0h12.012C15.107 0 16 .895 16 1.994v12.012A1.995 1.995 0 0114.006 16H1.994A1.995 1.995 0 010 14.006V1.994zm1 0v12.012c0 .548.446.994.994.994h12.012a.995.995 0 00.994-.994V1.994A.995.995 0 0014.006 1H1.994A.995.995 0 001 1.994z" fill-rule="evenodd"></path></svg></button></figure></p>
<p>서버1에는 두개의 노드가 있기 때문에 서버 1의 두번째 노드는 실행되는 http, tcp 포트가 각각 9201, 9301 로 실행이 됩니다.</p>
<p>물리적인 구성과 상관 없이 여러 노드가 하나의 클러스터로 묶이기 위해서는 클러스터명 <code class="euiCode" data-code-language="text">cluster.name</code> 설정이 묶여질 노드들 모두 동일해야 합니다. 같은 서버나 네트워크망 내부에 있다 하더라도 <code class="euiCode" data-code-language="text">cluster.name</code>이 동일하지 않으면 논리적으로 서로 다른 클러스터로 실행이 되고, 각각 별개의 시스템으로 인식이 됩니다.</p>
<h2 id="하나의-서버에서-여러-클러스터-실행" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#하나의-서버에서-여러-클러스터-실행" rel="noreferrer" aria-label="하나의 서버에서 여러 클러스터 실행 permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>하나의 서버에서 여러 클러스터 실행</h2>
<p>하나의 물리 서버에 3개의 노드를 실행시킨다고 가정 해 보겠습니다. 노드들의 이름은 각각 <strong>node-1</strong>, <strong>node-2</strong>, <strong>node-3</strong> 이고 node-1과 node-2의 클러스터명은 <strong>es-cluster-1</strong>, node-3의 클러스터명은 <strong>es-cluster-2</strong>로 실행을 합니다. 설정은 config/elasticsearch.yml 파일에서 아래와 같이 입력합니다. 각 탭에서 노드의 설정을 확인합니다.</p>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="node-1"><span class="euiTab__content">node-1</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="node-2"><span class="euiTab__content">node-2</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="node-3"><span class="euiTab__content">node-3</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-yaml euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="yaml"><span class="euiCodeBlock__line"><span class="token key atrule">cluster.name</span><span class="token punctuation">:</span> es<span class="token punctuation">-</span>cluster<span class="token punctuation">-</span><span class="token number">1</span>
</span><span class="euiCodeBlock__line"><span class="token key atrule">node.name</span><span class="token punctuation">:</span> <span class="token string">&quot;node-1&quot;</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>또는 다음과 같이 실행 커맨드를 이용해서도 설정이 가능합니다.</p>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="node-1"><span class="euiTab__content">node-1</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="node-2"><span class="euiTab__content">node-2</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="node-3"><span class="euiTab__content">node-3</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line">$ bin/elasticsearch -Ecluster.name<span class="token operator">=</span>es-cluster-1 -Enode.name<span class="token operator">=</span>node-1
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>node-1과 node-2는 하나의 클러스터로 묶여있기 때문에 데이터 교환이 일어납니다. node-1로 입력된 데이터는 node-2 에서도 읽을 수 있으며 그 반대도 가능합니다. 하지만 node-3 은 클러스터가 다르기 때문에 node-1, node-2에 입력된 데이터를 node-3 에서 읽을 수는 없습니다.</p>
<p>가장 먼저 node-1을 실행시켰을 때 나타나는 화면입니다.</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line">$ bin/elasticsearch -Ecluster.name<span class="token operator">=</span>es-cluster-1 -Enode.name<span class="token operator">=</span>node-1
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T05:22:07,254<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.e.NodeEnvironment    <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span> using <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> data paths, mounts <span class="token punctuation">[</span><span class="token punctuation">[</span>/ <span class="token punctuation">(</span>/dev/disk1s1<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">]</span>, net usable_space <span class="token punctuation">[</span><span class="token number">88</span>.2gb<span class="token punctuation">]</span>, net total_space <span class="token punctuation">[</span><span class="token number">465</span>.6gb<span class="token punctuation">]</span>, types <span class="token punctuation">[</span>apfs<span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T05:22:07,256<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.e.NodeEnvironment    <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span> heap size <span class="token punctuation">[</span><span class="token number">989</span>.8mb<span class="token punctuation">]</span>, compressed ordinary object pointers <span class="token punctuation">[</span>true<span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T05:22:07,261<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.n.Node               <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span> node name <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span>, node ID <span class="token punctuation">[</span>RYhEbLLjQKaoHzGNkSNo-g<span class="token punctuation">]</span>, cluster name <span class="token punctuation">[</span>es-cluster-1<span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>위 실행 화면에서 먼저 노드명이 <code class="euiCode" data-code-language="text">[node-1]</code>인 것을 확인할 수 있습니다. 실행 메시지를 계속 확인 하다 보면 다음과 같은 부분이 있습니다.</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T05:22:14,030<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.t.TransportService   <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span> publish_address <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9300<span class="token punctuation">}</span>, bound_addresses <span class="token punctuation">{</span><span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:9300<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9300<span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T05:22:17,307<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.h.AbstractHttpServerTransport<span class="token punctuation">]</span> <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span> publish_address <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9200<span class="token punctuation">}</span>, bound_addresses <span class="token punctuation">{</span><span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:9200<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9200<span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p><code class="euiCode" data-code-language="text">[o.e.t.TransportService]</code> 에서 tcp 포트 <strong>9300</strong>, 그리고 <code class="euiCode" data-code-language="text">[o.e.h.AbstractHttpServerTransport]</code> 에서 http 포트 <strong>9200</strong>을 각각 확인할 수 있습니다.</p>
<p>모든 클러스터에는 반드시 하나의 마스터 노드가 존재합니다. 실행 메시지의 다음 부분을 살펴보겠습니다.</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T05:22:17,230<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.c.s.MasterService    <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span> elected-as-master <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> nodes joined<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">{</span>node-1<span class="token punctuation">}</span><span class="token punctuation">{</span>RYhEbLLjQKaoHzGNkSNo-g<span class="token punctuation">}</span><span class="token punctuation">{</span>KZxmWwFVTPKU5QHDbmULfg<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9300<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, xpack.installed<span class="token operator">=</span>true, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">}</span> elect leader, _BECOME_MASTER_TASK_, _FINISH_ELECTION_<span class="token punctuation">]</span>, term: <span class="token number">1</span>, version: <span class="token number">1</span>, reason: master node changed <span class="token punctuation">{</span>previous <span class="token punctuation">[</span><span class="token punctuation">]</span>, current <span class="token punctuation">[</span><span class="token punctuation">{</span>node-1<span class="token punctuation">}</span><span class="token punctuation">{</span>RYhEbLLjQKaoHzGNkSNo-g<span class="token punctuation">}</span><span class="token punctuation">{</span>KZxmWwFVTPKU5QHDbmULfg<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9300<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, xpack.installed<span class="token operator">=</span>true, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p><code class="euiCode" data-code-language="text">[o.e.c.s.MasterService] [node-1] elected-as-master</code>부분에서 현재 node-1 이 마스터 노드로 선출 것을 확인할 수 있습니다. 마스터 노드에 대한 자세한 설명은 뒤에서 계속 다루도록 하겠습니다.</p>
<p>이제 node-1이 실행중인 상태에서 두번째 노드인 node-2를 실행시키면 다음과 같은 실행 메시지들을 확인할 수 있습니다.</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line">$ bin/elasticsearch -Ecluster.name<span class="token operator">=</span>es-cluster-1 -Enode.name<span class="token operator">=</span>node-2
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T07:50:54,308<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.n.Node               <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-2<span class="token punctuation">]</span> starting <span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T07:50:54,479<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.t.TransportService   <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-2<span class="token punctuation">]</span> publish_address <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9301<span class="token punctuation">}</span>, bound_addresses <span class="token punctuation">{</span><span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:9301<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9301<span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T07:50:54,488<span class="token punctuation">]</span><span class="token punctuation">[</span>WARN <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.b.BootstrapChecks    <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-2<span class="token punctuation">]</span> the default discovery settings are unsuitable <span class="token keyword">for</span> production use<span class="token punctuation">;</span> at least one of <span class="token punctuation">[</span>discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes<span class="token punctuation">]</span> must be configured
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T07:50:54,503<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.c.c.ClusterBootstrapService<span class="token punctuation">]</span> <span class="token punctuation">[</span>node-2<span class="token punctuation">]</span> no discovery configuration found, will perform best-effort cluster bootstrapping after <span class="token punctuation">[</span>3s<span class="token punctuation">]</span> unless existing master is discovered
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T07:50:54,778<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.c.s.ClusterApplierService<span class="token punctuation">]</span> <span class="token punctuation">[</span>node-2<span class="token punctuation">]</span> master node changed <span class="token punctuation">{</span>previous <span class="token punctuation">[</span><span class="token punctuation">]</span>, current <span class="token punctuation">[</span><span class="token punctuation">{</span>node-1<span class="token punctuation">}</span><span class="token punctuation">{</span>RYhEbLLjQKaoHzGNkSNo-g<span class="token punctuation">}</span><span class="token punctuation">{</span>KZxmWwFVTPKU5QHDbmULfg<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9300<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span>, xpack.installed<span class="token operator">=</span>true<span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>, added <span class="token punctuation">{</span><span class="token punctuation">{</span>node-1<span class="token punctuation">}</span><span class="token punctuation">{</span>RYhEbLLjQKaoHzGNkSNo-g<span class="token punctuation">}</span><span class="token punctuation">{</span>KZxmWwFVTPKU5QHDbmULfg<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9300<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span>, xpack.installed<span class="token operator">=</span>true<span class="token punctuation">}</span>,<span class="token punctuation">}</span>, term: <span class="token number">1</span>, version: <span class="token number">16</span>, reason: ApplyCommitRequest<span class="token punctuation">{</span>term<span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token number">16</span>, <span class="token assign-left variable">sourceNode</span><span class="token operator">=</span><span class="token punctuation">{</span>node-1<span class="token punctuation">}</span><span class="token punctuation">{</span>RYhEbLLjQKaoHzGNkSNo-g<span class="token punctuation">}</span><span class="token punctuation">{</span>KZxmWwFVTPKU5QHDbmULfg<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9300<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span>, xpack.installed<span class="token operator">=</span>true<span class="token punctuation">}</span><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T07:50:55,216<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.h.AbstractHttpServerTransport<span class="token punctuation">]</span> <span class="token punctuation">[</span>node-2<span class="token punctuation">]</span> publish_address <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9201<span class="token punctuation">}</span>, bound_addresses <span class="token punctuation">{</span><span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:9201<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9201<span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>node-2의 경우 tcp 포트가 <strong>9301</strong>, http 포트가 <strong>9201</strong> 로 잡힌 것을 확인할 수 있습니다.</p>
<p><code class="euiCode" data-code-language="text">[o.e.c.s.ClusterApplierService] [node-2] master node changed {previous [], current [{node-1} ... added {{node-1} ...</code> 부분을 보면 같은 클러스터에 이미 실행중인 마스터 노드 <strong>node-1</strong>이 있기 때문에 node-2 는 node-1이 마스터로 있는 클러스터에 묶인 것이 확인됩니다.</p>
<p>node-2 를 실행하고 난 뒤 다시 <strong>node-1</strong> 의 콘솔 메시지를 확인하면 마찬가지로 node-2 가 클러스터에 추가되었다는 메시지를 확인할 수 있습니다.</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T07:50:54,736<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.c.s.MasterService    <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span> node-join<span class="token punctuation">[</span><span class="token punctuation">{</span>node-2<span class="token punctuation">}</span><span class="token punctuation">{</span>1EQ3a93iRMqppD49aQoTzg<span class="token punctuation">}</span><span class="token punctuation">{</span>4CRm0xbHT36e38r2udKx0g<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9301<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span>, xpack.installed<span class="token operator">=</span>true<span class="token punctuation">}</span> <span class="token function">join</span> existing leader<span class="token punctuation">]</span>, term: <span class="token number">1</span>, version: <span class="token number">16</span>, reason: added <span class="token punctuation">{</span><span class="token punctuation">{</span>node-2<span class="token punctuation">}</span><span class="token punctuation">{</span>1EQ3a93iRMqppD49aQoTzg<span class="token punctuation">}</span><span class="token punctuation">{</span>4CRm0xbHT36e38r2udKx0g<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9301<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span>, xpack.installed<span class="token operator">=</span>true<span class="token punctuation">}</span>,<span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T07:50:55,200<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.c.s.ClusterApplierService<span class="token punctuation">]</span> <span class="token punctuation">[</span>node-1<span class="token punctuation">]</span> added <span class="token punctuation">{</span><span class="token punctuation">{</span>node-2<span class="token punctuation">}</span><span class="token punctuation">{</span>1EQ3a93iRMqppD49aQoTzg<span class="token punctuation">}</span><span class="token punctuation">{</span>4CRm0xbHT36e38r2udKx0g<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9301<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span>, xpack.installed<span class="token operator">=</span>true<span class="token punctuation">}</span>,<span class="token punctuation">}</span>, term: <span class="token number">1</span>, version: <span class="token number">16</span>, reason: Publication<span class="token punctuation">{</span>term<span class="token operator">=</span><span class="token number">1</span>, <span class="token assign-left variable">version</span><span class="token operator">=</span><span class="token number">16</span><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>이제 node-1, node-2 가 실행 중인 상태에서 node-3 을 추가로 실행 해 보겠습니다.</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line">$ bin/elasticsearch -Ecluster.name<span class="token operator">=</span>es-cluster-2 -Enode.name<span class="token operator">=</span>node-3
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T08:01:37,474<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.t.TransportService   <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-3<span class="token punctuation">]</span> publish_address <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9302<span class="token punctuation">}</span>, bound_addresses <span class="token punctuation">{</span><span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:9302<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9302<span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T08:01:37,640<span class="token punctuation">]</span><span class="token punctuation">[</span>WARN <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.d.HandshakingTransportAddressConnector<span class="token punctuation">]</span> <span class="token punctuation">[</span>node-3<span class="token punctuation">]</span> handshake failed <span class="token keyword">for</span> <span class="token punctuation">[</span>connectToRemoteMasterNode<span class="token punctuation">[</span><span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:9300<span class="token punctuation">]</span><span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T08:01:40,671<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.c.s.MasterService    <span class="token punctuation">]</span> <span class="token punctuation">[</span>node-3<span class="token punctuation">]</span> elected-as-master <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> nodes joined<span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">{</span>node-3<span class="token punctuation">}</span><span class="token punctuation">{</span>XPFkVAjKQfaVoWkd4Hqv5A<span class="token punctuation">}</span><span class="token punctuation">{</span>8Y3wZO41R_CmlMV-JJhoPg<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9302<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, xpack.installed<span class="token operator">=</span>true, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">}</span> elect leader, _BECOME_MASTER_TASK_, _FINISH_ELECTION_<span class="token punctuation">]</span>, term: <span class="token number">1</span>, version: <span class="token number">1</span>, reason: master node changed <span class="token punctuation">{</span>previous <span class="token punctuation">[</span><span class="token punctuation">]</span>, current <span class="token punctuation">[</span><span class="token punctuation">{</span>node-3<span class="token punctuation">}</span><span class="token punctuation">{</span>XPFkVAjKQfaVoWkd4Hqv5A<span class="token punctuation">}</span><span class="token punctuation">{</span>8Y3wZO41R_CmlMV-JJhoPg<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1<span class="token punctuation">}</span><span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9302<span class="token punctuation">}</span><span class="token punctuation">{</span>dim<span class="token punctuation">}</span><span class="token punctuation">{</span>ml.machine_memory<span class="token operator">=</span><span class="token number">17179869184</span>, xpack.installed<span class="token operator">=</span>true, ml.max_open_jobs<span class="token operator">=</span><span class="token number">20</span><span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">..</span>.
</span><span class="euiCodeBlock__line"><span class="token punctuation">[</span><span class="token number">2019</span>-08-27T08:01:40,797<span class="token punctuation">]</span><span class="token punctuation">[</span>INFO <span class="token punctuation">]</span><span class="token punctuation">[</span>o.e.h.AbstractHttpServerTransport<span class="token punctuation">]</span> <span class="token punctuation">[</span>node-3<span class="token punctuation">]</span> publish_address <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9202<span class="token punctuation">}</span>, bound_addresses <span class="token punctuation">{</span><span class="token punctuation">[</span>::1<span class="token punctuation">]</span>:9202<span class="token punctuation">}</span>, <span class="token punctuation">{</span><span class="token number">127.0</span>.0.1:9202<span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>먼저 node-3 의 http, tcp 포트 설정은 <strong>9202</strong>, <strong>9302</strong> 를 사용하도록 설정되었습니다. <br/>
<code class="euiCode" data-code-language="text">[o.e.d.HandshakingTransportAddressConnector] [node-3] ... handshake failed for ...</code><br/>
<!-- -->부분을 보면 같은 서버에서 실행중인 node-1, node-2 를 찾았지만 클러스터명이 <code class="euiCode" data-code-language="text">es-cluster-2</code> 로 다르기 때문에 node-3은 node-1, node-2 와 같은 클러스터로 바인딩 되지 않았습니다. 그리고 <code class="euiCode" data-code-language="text">[o.e.c.s.MasterService ] [node-3] elected-as-master ...</code> 부분에서 <strong>node-3</strong> 스스로 <code class="euiCode" data-code-language="text">es-cluster-2</code> 클러스터의 마스터 노드로 선출 된 것을 확인할 수 있습니다.</p>
<p>지금까지 실행한 노드들의 클러스터 구조를 그림으로 나타내면 아래 그림과 같습니다.</p>
<p><figure class="euiImage euiImage--hasShadow euiImage--allowFullScreen euiImage--original"><button type="button" aria-label="Open fullscreen 하나의 물리 서버에서 서로 다른 두 개의 클러스터 실행 image" class="euiImage__button" data-test-subj="activateFullScreenButton"><img src="/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/03-01_cluster_3.png" alt="하나의 물리 서버에서 서로 다른 두 개의 클러스터 실행" class="euiImage__img" title="하나의 물리 서버에서 서로 다른 두 개의 클러스터 실행"/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon--ghost euiImage__icon" focusable="false" role="img" aria-hidden="true"><path d="M13 3v4h-1V4H9V3h4zM3 3h4v1H4v3H3V3zm10 10H9v-1h3V9h1v4zM3 13V9h1v3h3v1H3zM0 1.994C0 .893.895 0 1.994 0h12.012C15.107 0 16 .895 16 1.994v12.012A1.995 1.995 0 0114.006 16H1.994A1.995 1.995 0 010 14.006V1.994zm1 0v12.012c0 .548.446.994.994.994h12.012a.995.995 0 00.994-.994V1.994A.995.995 0 0014.006 1H1.994A.995.995 0 001 1.994z" fill-rule="evenodd"></path></svg></button></figure></p>
<h2 id="디스커버리-discovery" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#디스커버리-discovery" rel="noreferrer" aria-label="디스커버리 (Discovery) permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>디스커버리 (Discovery)</h2>
<p>노드가 처음 실행 될 때 같은 서버, 또는 <code class="euiCode" data-code-language="text">discovery.seed_hosts: [ ]</code> 에 설정된 네트워크 상의 다른 노드들을 찾아 하나의 클러스터로 바인딩 하는 과정을 <strong>디스커버리</strong> 라고 합니다. 디스커버리는 다음과 같은 순서로 이루어집니다.</p>
<ol>
<li><code class="euiCode" data-code-language="text">discovery.seed_hosts</code> 설정에 있는 주소 순서대로 노드가 있는지 여부를 확인<!-- -->
<ul>
<li>노드가 존재하는 경우 &gt; <code class="euiCode" data-code-language="text">cluster.name</code> 확인<!-- -->
<ul>
<li>일치하는 경우 &gt; 같은 클러스터로 바인딩 &gt; 종료</li>
<li>일치하지 않는 경우 &gt; 1로 돌아가서 다음 주소 확인 반복</li>
</ul>
</li>
<li>노드가 존재하지 않는 경우 &gt; 1로 돌아가서 다음 주소 확인 반복</li>
</ul>
</li>
<li>주소가 끝날 때 까지 노드를 찾지 못한 경우<!-- -->
<ul>
<li>스스로 새로운 클러스터 시작</li>
</ul>
</li>
</ol>
<p><figure class="euiImage euiImage--hasShadow euiImage--allowFullScreen euiImage--original"><button type="button" aria-label="Open fullscreen 디스커버리 과정 image" class="euiImage__button" data-test-subj="activateFullScreenButton"><img src="/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/03-01_cluster_discovery.png" alt="디스커버리 과정" class="euiImage__img" title="디스커버리 과정"/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon--ghost euiImage__icon" focusable="false" role="img" aria-hidden="true"><path d="M13 3v4h-1V4H9V3h4zM3 3h4v1H4v3H3V3zm10 10H9v-1h3V9h1v4zM3 13V9h1v3h3v1H3zM0 1.994C0 .893.895 0 1.994 0h12.012C15.107 0 16 .895 16 1.994v12.012A1.995 1.995 0 0114.006 16H1.994A1.995 1.995 0 010 14.006V1.994zm1 0v12.012c0 .548.446.994.994.994h12.012a.995.995 0 00.994-.994V1.994A.995.995 0 0014.006 1H1.994A.995.995 0 001 1.994z" fill-rule="evenodd"></path></svg></button></figure></p>
<div class="euiCallOut euiCallOut--warning docCallOut"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--default"><p>클러스터에 노드가 무수히 많아도 보통 <code class="euiCode" data-code-language="text">discovery.seed_hosts</code> 설정에는 처음에 탐색할 노드 3~5 개 정도만 설정 하면 큰 문제 없이 클러스터가 바인딩 됩니다. 보통은 마스터 후보 노드들을 지정하게 되며 처음 탐색하는 대상 노드는 반드시 먼저 가동중이어야 합니다.</p></div></div></div></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--subdued"></div></div></div></div></div></div></div></div><footer class="docChromeFooter" data-elastic-exclude="true"><div class="euiFlexGroup euiFlexGroup--justifyContentSpaceAround euiFlexGroup--directionRow euiFlexGroup--responsive"><div class="euiFlexItem euiFlexItem--flexGrowZero docChromeFooter__container"><div class="euiFlexGroup euiFlexGroup--gutterExtraLarge euiFlexGroup--justifyContentSpaceBetween euiFlexGroup--directionRow euiFlexGroup--responsive"><div class="euiFlexItem"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--ghost"><p>Elasticsearch is a trademark of Elasticsearch B.V., registered in the U.S. and in other countries.</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the Apache Software Foundation in the United States and/or other countries.</p><p> <a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/trademarks" rel="">Trademarks</a><span class="docChromeFooter__divide">|</span><a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/terms-of-use" rel="">Terms of Use</a><span class="docChromeFooter__divide">|</span><a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/privacy-statement" rel="">Privacy</a><span class="docChromeFooter__divide">|</span>© <!-- -->2022<!-- --> Elasticsearch B.V. All Rights Reserved</p></div></div></div><div class="euiFlexItem euiFlexItem--flexGrowZero"></div><div class="euiFlexItem euiFlexItem--flexGrowZero"><figure class="euiImage docChromeFooter__logo"><img style="max-width:xs;max-height:xs;width:auto" src="/assets/images/logo-elastic-vertical-reverse.svg" class="euiImage__img" alt="Elastic logo"/></figure></div></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"bundle":"!function(e,n){\"object\"==typeof exports\u0026\u0026\"object\"==typeof module?module.exports=n(require(\"mdxJsReact\"),require(\"React\")):\"function\"==typeof define\u0026\u0026define.amd?define([\"mdxJsReact\",\"React\"],n):\"object\"==typeof exports?exports.MDXContent=n(require(\"mdxJsReact\"),require(\"React\")):e.MDXContent=n(e.mdxJsReact,e.React)}(this,((e,n)=\u003e(()=\u003e{\"use strict\";var t={24:e=\u003e{e.exports=n},825:n=\u003e{n.exports=e}},l={};function a(e){var n=l[e];if(void 0!==n)return n.exports;var r=l[e]={exports:{}};return t[e](r,r.exports,a),r.exports}a.n=e=\u003e{var n=e\u0026\u0026e.__esModule?()=\u003ee.default:()=\u003ee;return a.d(n,{a:n}),n},a.d=(e,n)=\u003e{for(var t in n)a.o(n,t)\u0026\u0026!a.o(e,t)\u0026\u0026Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=\u003eObject.prototype.hasOwnProperty.call(e,n),a.r=e=\u003e{\"undefined\"!=typeof Symbol\u0026\u0026Symbol.toStringTag\u0026\u0026Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var r={};return(()=\u003e{a.r(r),a.d(r,{default:()=\u003el});var e=a(825),n=a(24),t=a.n(n);const l=function(){var n=arguments.length\u003e0\u0026\u0026void 0!==arguments[0]?arguments[0]:{},l=Object.assign({},(0,e.useMDXComponents)(),n.components),a=l.wrapper;return a?t().createElement(a,n,t().createElement(r)):r();function r(){var l=Object.assign({h2:\"h2\",p:\"p\",img:\"img\",code:\"code\",strong:\"strong\",pre:\"pre\",br:\"br\",ol:\"ol\",li:\"li\",ul:\"ul\"},(0,e.useMDXComponents)(),n.components),a=l.DocTabs,r=l.DocTab,s=l.DocCallOut;return s||o(\"DocCallOut\",!0),r||o(\"DocTab\",!0),a||o(\"DocTabs\",!0),t().createElement(t().Fragment,null,t().createElement(l.h2,{id:\"여러-서버에-하나의-클러스터로-실행\"},\"여러 서버에 하나의 클러스터로 실행\"),\"\\n\",t().createElement(l.p,null,\"Elasticsearch의 노드들은 클라이언트와의 통신을 위한 http 포트(9200~9299), 노드 간의 데이터 교환을 위한 tcp 포트 (9300~9399) 총 2개의 네트워크 통신을 열어두고 있습니다. 일반적으로 1개의 물리 서버마다 하나의 노드를 실행하는 것을 권장하고 있습니다. 3개의 다른 물리 서버에서 각각 1개 씩의 노드를 실행하면 각 클러스터는 다음과 같이 구성됩니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.img,{src:\"/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/03-01_cluster_1.png\",alt:\"각 서버에서 노드 실행\"})),\"\\n\",t().createElement(l.p,null,\"하나의 물리적인 서버 안에서 여러 개의 노드를 실행하는 것도 가능합니다. 이 경우에는 각 노드들은 차례대로 9200, 9201… 순으로 포트를 사용하게 됩니다. 클라이언트는 9200, 9201 등의 포트를 통해 원하는 노드와 통신을 할 수 있습니다. 만약에 서버1 에서 두개의 노드를 실행하고, 또 다른 서버에서 한개의 노드를 실행시키면 클러스터는 다음과 같이 구성됩니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.img,{src:\"/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/03-01_cluster_2.png\",alt:\"한 서버에서 여러 노드 실행\"})),\"\\n\",t().createElement(l.p,null,\"서버1에는 두개의 노드가 있기 때문에 서버 1의 두번째 노드는 실행되는 http, tcp 포트가 각각 9201, 9301 로 실행이 됩니다.\"),\"\\n\",t().createElement(l.p,null,\"물리적인 구성과 상관 없이 여러 노드가 하나의 클러스터로 묶이기 위해서는 클러스터명 \",t().createElement(l.code,{display:\"inline\"},\"cluster.name\"),\" 설정이 묶여질 노드들 모두 동일해야 합니다. 같은 서버나 네트워크망 내부에 있다 하더라도 \",t().createElement(l.code,{display:\"inline\"},\"cluster.name\"),\"이 동일하지 않으면 논리적으로 서로 다른 클러스터로 실행이 되고, 각각 별개의 시스템으로 인식이 됩니다.\"),\"\\n\",t().createElement(l.h2,{id:\"하나의-서버에서-여러-클러스터-실행\"},\"하나의 서버에서 여러 클러스터 실행\"),\"\\n\",t().createElement(l.p,null,\"하나의 물리 서버에 3개의 노드를 실행시킨다고 가정 해 보겠습니다. 노드들의 이름은 각각 \",t().createElement(l.strong,null,\"node-1\"),\", \",t().createElement(l.strong,null,\"node-2\"),\", \",t().createElement(l.strong,null,\"node-3\"),\" 이고 node-1과 node-2의 클러스터명은 \",t().createElement(l.strong,null,\"es-cluster-1\"),\", node-3의 클러스터명은 \",t().createElement(l.strong,null,\"es-cluster-2\"),\"로 실행을 합니다. 설정은 config/elasticsearch.yml 파일에서 아래와 같이 입력합니다. 각 탭에서 노드의 설정을 확인합니다.\"),\"\\n\",t().createElement(a,null,t().createElement(r,{name:\"node-1\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-yaml\",display:\"block\"},'cluster.name: es-cluster-1\\nnode.name: \"node-1\"\\n'))),t().createElement(r,{name:\"node-2\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-yaml\",display:\"block\"},'cluster.name: es-cluster-1\\nnode.name: \"node-2\"\\n'))),t().createElement(r,{name:\"node-3\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-yaml\",display:\"block\"},'cluster.name: es-cluster-2\\nnode.name: \"node-3\"\\n')))),\"\\n\",t().createElement(l.p,null,\"또는 다음과 같이 실행 커맨드를 이용해서도 설정이 가능합니다.\"),\"\\n\",t().createElement(a,null,t().createElement(r,{name:\"node-1\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"$ bin/elasticsearch -Ecluster.name=es-cluster-1 -Enode.name=node-1\\n\"))),t().createElement(r,{name:\"node-2\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"$ bin/elasticsearch -Ecluster.name=es-cluster-1 -Enode.name=node-2\\n\"))),t().createElement(r,{name:\"node-3\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"$ bin/elasticsearch -Ecluster.name=es-cluster-2 -Enode.name=node-3\\n\")))),\"\\n\",t().createElement(l.p,null,\"node-1과 node-2는 하나의 클러스터로 묶여있기 때문에 데이터 교환이 일어납니다. node-1로 입력된 데이터는 node-2 에서도 읽을 수 있으며 그 반대도 가능합니다. 하지만 node-3 은 클러스터가 다르기 때문에 node-1, node-2에 입력된 데이터를 node-3 에서 읽을 수는 없습니다.\"),\"\\n\",t().createElement(l.p,null,\"가장 먼저 node-1을 실행시켰을 때 나타나는 화면입니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"$ bin/elasticsearch -Ecluster.name=es-cluster-1 -Enode.name=node-1\\n[2019-08-27T05:22:07,254][INFO ][o.e.e.NodeEnvironment    ] [node-1] using [1] data paths, mounts [[/ (/dev/disk1s1)]], net usable_space [88.2gb], net total_space [465.6gb], types [apfs]\\n[2019-08-27T05:22:07,256][INFO ][o.e.e.NodeEnvironment    ] [node-1] heap size [989.8mb], compressed ordinary object pointers [true]\\n[2019-08-27T05:22:07,261][INFO ][o.e.n.Node               ] [node-1] node name [node-1], node ID [RYhEbLLjQKaoHzGNkSNo-g], cluster name [es-cluster-1]\\n...\\n\")),\"\\n\",t().createElement(l.p,null,\"위 실행 화면에서 먼저 노드명이 \",t().createElement(l.code,{display:\"inline\"},\"[node-1]\"),\"인 것을 확인할 수 있습니다. 실행 메시지를 계속 확인 하다 보면 다음과 같은 부분이 있습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"[2019-08-27T05:22:14,030][INFO ][o.e.t.TransportService   ] [node-1] publish_address {127.0.0.1:9300}, bound_addresses {[::1]:9300}, {127.0.0.1:9300}\\n...\\n[2019-08-27T05:22:17,307][INFO ][o.e.h.AbstractHttpServerTransport] [node-1] publish_address {127.0.0.1:9200}, bound_addresses {[::1]:9200}, {127.0.0.1:9200}\\n\")),\"\\n\",t().createElement(l.p,null,t().createElement(l.code,{display:\"inline\"},\"[o.e.t.TransportService]\"),\" 에서 tcp 포트 \",t().createElement(l.strong,null,\"9300\"),\", 그리고 \",t().createElement(l.code,{display:\"inline\"},\"[o.e.h.AbstractHttpServerTransport]\"),\" 에서 http 포트 \",t().createElement(l.strong,null,\"9200\"),\"을 각각 확인할 수 있습니다.\"),\"\\n\",t().createElement(l.p,null,\"모든 클러스터에는 반드시 하나의 마스터 노드가 존재합니다. 실행 메시지의 다음 부분을 살펴보겠습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"[2019-08-27T05:22:17,230][INFO ][o.e.c.s.MasterService    ] [node-1] elected-as-master ([1] nodes joined)[{node-1}{RYhEbLLjQKaoHzGNkSNo-g}{KZxmWwFVTPKU5QHDbmULfg}{127.0.0.1}{127.0.0.1:9300}{dim}{ml.machine_memory=17179869184, xpack.installed=true, ml.max_open_jobs=20} elect leader, _BECOME_MASTER_TASK_, _FINISH_ELECTION_], term: 1, version: 1, reason: master node changed {previous [], current [{node-1}{RYhEbLLjQKaoHzGNkSNo-g}{KZxmWwFVTPKU5QHDbmULfg}{127.0.0.1}{127.0.0.1:9300}{dim}{ml.machine_memory=17179869184, xpack.installed=true, ml.max_open_jobs=20}]}\\n...\\n\")),\"\\n\",t().createElement(l.p,null,t().createElement(l.code,{display:\"inline\"},\"[o.e.c.s.MasterService] [node-1] elected-as-master\"),\"부분에서 현재 node-1 이 마스터 노드로 선출 것을 확인할 수 있습니다. 마스터 노드에 대한 자세한 설명은 뒤에서 계속 다루도록 하겠습니다.\"),\"\\n\",t().createElement(l.p,null,\"이제 node-1이 실행중인 상태에서 두번째 노드인 node-2를 실행시키면 다음과 같은 실행 메시지들을 확인할 수 있습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"$ bin/elasticsearch -Ecluster.name=es-cluster-1 -Enode.name=node-2\\n...\\n[2019-08-27T07:50:54,308][INFO ][o.e.n.Node               ] [node-2] starting ...\\n[2019-08-27T07:50:54,479][INFO ][o.e.t.TransportService   ] [node-2] publish_address {127.0.0.1:9301}, bound_addresses {[::1]:9301}, {127.0.0.1:9301}\\n...\\n[2019-08-27T07:50:54,488][WARN ][o.e.b.BootstrapChecks    ] [node-2] the default discovery settings are unsuitable for production use; at least one of [discovery.seed_hosts, discovery.seed_providers, cluster.initial_master_nodes] must be configured\\n[2019-08-27T07:50:54,503][INFO ][o.e.c.c.ClusterBootstrapService] [node-2] no discovery configuration found, will perform best-effort cluster bootstrapping after [3s] unless existing master is discovered\\n[2019-08-27T07:50:54,778][INFO ][o.e.c.s.ClusterApplierService] [node-2] master node changed {previous [], current [{node-1}{RYhEbLLjQKaoHzGNkSNo-g}{KZxmWwFVTPKU5QHDbmULfg}{127.0.0.1}{127.0.0.1:9300}{dim}{ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true}]}, added {{node-1}{RYhEbLLjQKaoHzGNkSNo-g}{KZxmWwFVTPKU5QHDbmULfg}{127.0.0.1}{127.0.0.1:9300}{dim}{ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true},}, term: 1, version: 16, reason: ApplyCommitRequest{term=1, version=16, sourceNode={node-1}{RYhEbLLjQKaoHzGNkSNo-g}{KZxmWwFVTPKU5QHDbmULfg}{127.0.0.1}{127.0.0.1:9300}{dim}{ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true}}\\n...\\n[2019-08-27T07:50:55,216][INFO ][o.e.h.AbstractHttpServerTransport] [node-2] publish_address {127.0.0.1:9201}, bound_addresses {[::1]:9201}, {127.0.0.1:9201}\\n...\\n\")),\"\\n\",t().createElement(l.p,null,\"node-2의 경우 tcp 포트가 \",t().createElement(l.strong,null,\"9301\"),\", http 포트가 \",t().createElement(l.strong,null,\"9201\"),\" 로 잡힌 것을 확인할 수 있습니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.code,{display:\"inline\"},\"[o.e.c.s.ClusterApplierService] [node-2] master node changed {previous [], current [{node-1} ... added {{node-1} ...\"),\" 부분을 보면 같은 클러스터에 이미 실행중인 마스터 노드 \",t().createElement(l.strong,null,\"node-1\"),\"이 있기 때문에 node-2 는 node-1이 마스터로 있는 클러스터에 묶인 것이 확인됩니다.\"),\"\\n\",t().createElement(l.p,null,\"node-2 를 실행하고 난 뒤 다시 \",t().createElement(l.strong,null,\"node-1\"),\" 의 콘솔 메시지를 확인하면 마찬가지로 node-2 가 클러스터에 추가되었다는 메시지를 확인할 수 있습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"[2019-08-27T07:50:54,736][INFO ][o.e.c.s.MasterService    ] [node-1] node-join[{node-2}{1EQ3a93iRMqppD49aQoTzg}{4CRm0xbHT36e38r2udKx0g}{127.0.0.1}{127.0.0.1:9301}{dim}{ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true} join existing leader], term: 1, version: 16, reason: added {{node-2}{1EQ3a93iRMqppD49aQoTzg}{4CRm0xbHT36e38r2udKx0g}{127.0.0.1}{127.0.0.1:9301}{dim}{ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true},}\\n[2019-08-27T07:50:55,200][INFO ][o.e.c.s.ClusterApplierService] [node-1] added {{node-2}{1EQ3a93iRMqppD49aQoTzg}{4CRm0xbHT36e38r2udKx0g}{127.0.0.1}{127.0.0.1:9301}{dim}{ml.machine_memory=17179869184, ml.max_open_jobs=20, xpack.installed=true},}, term: 1, version: 16, reason: Publication{term=1, version=16}\\n\")),\"\\n\",t().createElement(l.p,null,\"이제 node-1, node-2 가 실행 중인 상태에서 node-3 을 추가로 실행 해 보겠습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"$ bin/elasticsearch -Ecluster.name=es-cluster-2 -Enode.name=node-3\\n...\\n[2019-08-27T08:01:37,474][INFO ][o.e.t.TransportService   ] [node-3] publish_address {127.0.0.1:9302}, bound_addresses {[::1]:9302}, {127.0.0.1:9302}\\n...\\n[2019-08-27T08:01:37,640][WARN ][o.e.d.HandshakingTransportAddressConnector] [node-3] handshake failed for [connectToRemoteMasterNode[[::1]:9300]]\\n...\\n[2019-08-27T08:01:40,671][INFO ][o.e.c.s.MasterService    ] [node-3] elected-as-master ([1] nodes joined)[{node-3}{XPFkVAjKQfaVoWkd4Hqv5A}{8Y3wZO41R_CmlMV-JJhoPg}{127.0.0.1}{127.0.0.1:9302}{dim}{ml.machine_memory=17179869184, xpack.installed=true, ml.max_open_jobs=20} elect leader, _BECOME_MASTER_TASK_, _FINISH_ELECTION_], term: 1, version: 1, reason: master node changed {previous [], current [{node-3}{XPFkVAjKQfaVoWkd4Hqv5A}{8Y3wZO41R_CmlMV-JJhoPg}{127.0.0.1}{127.0.0.1:9302}{dim}{ml.machine_memory=17179869184, xpack.installed=true, ml.max_open_jobs=20}]}\\n...\\n[2019-08-27T08:01:40,797][INFO ][o.e.h.AbstractHttpServerTransport] [node-3] publish_address {127.0.0.1:9202}, bound_addresses {[::1]:9202}, {127.0.0.1:9202}\\n\")),\"\\n\",t().createElement(l.p,null,\"먼저 node-3 의 http, tcp 포트 설정은 \",t().createElement(l.strong,null,\"9202\"),\", \",t().createElement(l.strong,null,\"9302\"),\" 를 사용하도록 설정되었습니다. \",t().createElement(l.br),\"\\n\",t().createElement(l.code,{display:\"inline\"},\"[o.e.d.HandshakingTransportAddressConnector] [node-3] ... handshake failed for ...\"),t().createElement(l.br),\"\\n\",\"부분을 보면 같은 서버에서 실행중인 node-1, node-2 를 찾았지만 클러스터명이 \",t().createElement(l.code,{display:\"inline\"},\"es-cluster-2\"),\" 로 다르기 때문에 node-3은 node-1, node-2 와 같은 클러스터로 바인딩 되지 않았습니다. 그리고 \",t().createElement(l.code,{display:\"inline\"},\"[o.e.c.s.MasterService ] [node-3] elected-as-master ...\"),\" 부분에서 \",t().createElement(l.strong,null,\"node-3\"),\" 스스로 \",t().createElement(l.code,{display:\"inline\"},\"es-cluster-2\"),\" 클러스터의 마스터 노드로 선출 된 것을 확인할 수 있습니다.\"),\"\\n\",t().createElement(l.p,null,\"지금까지 실행한 노드들의 클러스터 구조를 그림으로 나타내면 아래 그림과 같습니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.img,{src:\"/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/03-01_cluster_3.png\",alt:\"하나의 물리 서버에서 서로 다른 두 개의 클러스터 실행\"})),\"\\n\",t().createElement(l.h2,{id:\"디스커버리-discovery\"},\"디스커버리 (Discovery)\"),\"\\n\",t().createElement(l.p,null,\"노드가 처음 실행 될 때 같은 서버, 또는 \",t().createElement(l.code,{display:\"inline\"},\"discovery.seed_hosts: [ ]\"),\" 에 설정된 네트워크 상의 다른 노드들을 찾아 하나의 클러스터로 바인딩 하는 과정을 \",t().createElement(l.strong,null,\"디스커버리\"),\" 라고 합니다. 디스커버리는 다음과 같은 순서로 이루어집니다.\"),\"\\n\",t().createElement(l.ol,null,\"\\n\",t().createElement(l.li,null,t().createElement(l.code,{display:\"inline\"},\"discovery.seed_hosts\"),\" 설정에 있는 주소 순서대로 노드가 있는지 여부를 확인\",\"\\n\",t().createElement(l.ul,null,\"\\n\",t().createElement(l.li,null,\"노드가 존재하는 경우 \u003e \",t().createElement(l.code,{display:\"inline\"},\"cluster.name\"),\" 확인\",\"\\n\",t().createElement(l.ul,null,\"\\n\",t().createElement(l.li,null,\"일치하는 경우 \u003e 같은 클러스터로 바인딩 \u003e 종료\"),\"\\n\",t().createElement(l.li,null,\"일치하지 않는 경우 \u003e 1로 돌아가서 다음 주소 확인 반복\"),\"\\n\"),\"\\n\"),\"\\n\",t().createElement(l.li,null,\"노드가 존재하지 않는 경우 \u003e 1로 돌아가서 다음 주소 확인 반복\"),\"\\n\"),\"\\n\"),\"\\n\",t().createElement(l.li,null,\"주소가 끝날 때 까지 노드를 찾지 못한 경우\",\"\\n\",t().createElement(l.ul,null,\"\\n\",t().createElement(l.li,null,\"스스로 새로운 클러스터 시작\"),\"\\n\"),\"\\n\"),\"\\n\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.img,{src:\"/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/03-01_cluster_discovery.png\",alt:\"디스커버리 과정\"})),\"\\n\",t().createElement(s,{color:\"warning\"},t().createElement(l.p,null,\"클러스터에 노드가 무수히 많아도 보통 \",t().createElement(l.code,{display:\"inline\"},\"discovery.seed_hosts\"),\" 설정에는 처음에 탐색할 노드 3~5 개 정도만 설정 하면 큰 문제 없이 클러스터가 바인딩 됩니다. 보통은 마스터 후보 노드들을 지정하게 되며 처음 탐색하는 대상 노드는 반드시 먼저 가동중이어야 합니다.\")))}};function o(e,n){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+e+\"` to be defined: you likely forgot to import, pass, or provide it.\")}})(),r})()));","frontmatter":{"id":"esG7-03-01-cluster","slug":"/krEsguide7/esG7-03-01-cluster","title":"3.1 클러스터 구성","description":"모든 문서에 대한 저작권은 Elastic 과 김종민(kimjmin@gmail.com) 에게 있으며 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 포함된 자료를 인용하고자 하는 경우 출처를 명시하고 게재된 주소를 김종민(kimjmin@gmail.com)에게 알려주시기 바랍니다. date: 2022-01-25","tags":["system","architecture","cluster"],"link":"file:///Users/kimjmin/git/docs-kr/esguide7","linkPath":"03-cluster/03-01-cluster.mdx"},"missionId":"krEsguide7"},"__N_SSG":true},"page":"/[...slug]","query":{"slug":["krEsguide7","esG7-03-01-cluster"]},"buildId":"K8YMqTQBQVe0pMujUHgY0","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>