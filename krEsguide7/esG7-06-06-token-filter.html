<!DOCTYPE html><html lang="en"><head><meta name="eui-styles"/><script async="" src="https://www.googletagmanager.com/gtag/js?id=UA-12395217-24"></script><script>
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', 'UA-12395217-24', {
                page_path: window.location.pathname,
              });
          </script><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><script>!function(){try{var d=document.documentElement;var e=localStorage.getItem("elastic-docs-theme");if(e){d.setAttribute('data-theme', e)}else{d.setAttribute('data-theme', 'light');}}catch(t){}}();</script><title>6.6 토큰 필터 - Token Filter | Elastic Documentation</title><meta property="og:title" content="6.6 토큰 필터 - Token Filter | Elastic Documentation"/><meta class="elastic" name="title" content="6.6 토큰 필터 - Token Filter"/><meta class="elastic" name="date" content="2022-01-25T00:00:00.000Z"/><meta name="description" content="모든 문서에 대한 저작권은 Elastic 과 김종민(kimjmin@gmail.com) 에게 있으며 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 포함된 자료를 인용하고자 하는 경우 출처를 명시하고 게재된 주소를 김종민(kimjmin@gmail.com)에게 알려주시기 바랍니다."/><meta property="og:description" content="모든 문서에 대한 저작권은 Elastic 과 김종민(kimjmin@gmail.com) 에게 있으며 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 포함된 자료를 인용하고자 하는 경우 출처를 명시하고 게재된 주소를 김종민(kimjmin@gmail.com)에게 알려주시기 바랍니다."/><meta name="twitter:site" content="@elastic"/><meta property="og:url" content="https://elastic.github.io/krEsguide7/esG7-06-06-token-filter"/><link rel="stylesheet" type="text/css" href="/docs-kr/themes/eui_theme_undefined.min.css"/><link rel="stylesheet" type="text/css" href="/docs-kr/themes/theme_undefined.css"/><link rel="shortcut icon" href="/docs-kr/assets/images/favicon.ico"/><meta name="next-head-count" content="14"/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/docs-kr/_next/static/chunks/polyfills-a40ef1678bae11e696dba45124eadd70.js"></script><script src="/docs-kr/_next/static/chunks/webpack-cffd7af05c46bff687df.js" defer=""></script><script src="/docs-kr/_next/static/chunks/framework-bf9b12c23e794b196495.js" defer=""></script><script src="/docs-kr/_next/static/chunks/main-39366c62fdd5de5858fe.js" defer=""></script><script src="/docs-kr/_next/static/chunks/pages/_app-d9a28ac2b5165b299106.js" defer=""></script><script src="/docs-kr/_next/static/chunks/c78d26b1-ff6470003369f2a26fc7.js" defer=""></script><script src="/docs-kr/_next/static/chunks/103-fd3e1552f32e8c4a6b92.js" defer=""></script><script src="/docs-kr/_next/static/chunks/3674-41861bc71d856d154d9e.js" defer=""></script><script src="/docs-kr/_next/static/chunks/7815-952dc762df3d4a43befe.js" defer=""></script><script src="/docs-kr/_next/static/chunks/9237-e960f47bcd4625ef5949.js" defer=""></script><script src="/docs-kr/_next/static/chunks/4620-ffe6a72783393171b0cb.js" defer=""></script><script src="/docs-kr/_next/static/chunks/8482-d6a48a2948368737094e.js" defer=""></script><script src="/docs-kr/_next/static/chunks/pages/%5B...slug%5D-8f1dc78ef1e2355ed9c0.js" defer=""></script><script src="/docs-kr/_next/static/JogDT4Rcnrb0olaKm5b4J/_buildManifest.js" defer=""></script><script src="/docs-kr/_next/static/JogDT4Rcnrb0olaKm5b4J/_ssgManifest.js" defer=""></script></head><body class="guideBody"><div id="__next"><div class="docWrapper"><header data-elastic-exclude="true"><div class="euiHeader euiHeader--dark euiHeader--fixed"><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><a rel="noreferrer" class="euiHeaderLogo"><svg data-type="logoElastic" xmlns="http://www.w3.org/2000/svg" width="32" height="32" fill="none" viewBox="0 0 32 32" class="euiIcon euiIcon--large euiHeaderLogo__icon" focusable="false" role="img" aria-label="Elastic"><path class="outline" fill-rule="evenodd" clip-rule="evenodd" d="M30.86 13.129A6.333 6.333 0 0132 16.77a6.419 6.419 0 01-1.162 3.652 6.382 6.382 0 01-3.032 2.331 4.833 4.833 0 01-1.672 5.542 4.789 4.789 0 01-5.77-.074 9.016 9.016 0 01-4.5 3.322 8.982 8.982 0 01-5.587.023 9.014 9.014 0 01-4.526-3.287 9.067 9.067 0 01-1.727-5.333c0-.579.053-1.156.16-1.725A6.305 6.305 0 011.145 18.9 6.341 6.341 0 010 15.242a6.42 6.42 0 011.163-3.652 6.384 6.384 0 013.035-2.33 4.833 4.833 0 011.658-5.557 4.789 4.789 0 015.78.07 9.037 9.037 0 014.93-3.446 9.007 9.007 0 015.994.419 9.05 9.05 0 014.407 4.098 9.097 9.097 0 01.873 5.965 6.298 6.298 0 013.02 2.32zm-18.28.658l7.002 3.211 7.066-6.213a7.85 7.85 0 00.152-1.557c0-1.692-.539-3.34-1.54-4.704a7.897 7.897 0 00-4.02-2.869 7.87 7.87 0 00-4.932.086 7.9 7.9 0 00-3.92 3.007l-1.174 6.118 1.367 2.92-.001.001zm-7.247 7.441A7.964 7.964 0 006.72 27.53a7.918 7.918 0 004.04 2.874 7.89 7.89 0 004.95-.097 7.92 7.92 0 003.926-3.03l1.166-6.102-1.555-2.985-7.03-3.211-6.885 6.248.001.001zm4.755-11.024l-4.8-1.137.002-.002a3.82 3.82 0 011.312-4.358 3.785 3.785 0 014.538.023l-1.052 5.474zm-5.216.01a5.294 5.294 0 00-2.595 1.882 5.324 5.324 0 00-.142 6.124 5.287 5.287 0 002.505 2l6.733-6.101-1.235-2.65-5.266-1.255zm18.286 17.848a3.737 3.737 0 01-2.285-.785l1.037-5.454 4.8 1.125a3.812 3.812 0 01-1.801 4.68c-.54.283-1.14.432-1.751.434zm-1.31-7.499l5.28 1.238a5.34 5.34 0 002.622-1.938 5.37 5.37 0 001.013-3.106 5.311 5.311 0 00-.936-3.01 5.282 5.282 0 00-2.475-1.944l-6.904 6.07 1.4 2.69z" fill="#fff"></path><path d="M12.58 13.787l7.002 3.211 7.066-6.213a7.849 7.849 0 00.152-1.557c0-1.692-.539-3.34-1.54-4.704a7.897 7.897 0 00-4.02-2.869 7.87 7.87 0 00-4.932.086 7.9 7.9 0 00-3.92 3.007l-1.174 6.118 1.367 2.92-.001.001z" fill="#FEC514"></path><path d="M5.333 21.228A7.964 7.964 0 006.72 27.53a7.918 7.918 0 004.04 2.874 7.89 7.89 0 004.95-.097 7.92 7.92 0 003.926-3.03l1.166-6.102-1.555-2.985-7.03-3.211-6.885 6.248.001.001z" fill="#00BFB3"></path><path d="M5.288 9.067l4.8 1.137L11.14 4.73a3.785 3.785 0 00-5.914 1.94 3.82 3.82 0 00.064 2.395" fill="#F04E98"></path><path d="M4.872 10.214a5.294 5.294 0 00-2.595 1.882 5.324 5.324 0 00-.142 6.124 5.287 5.287 0 002.505 2l6.733-6.101-1.235-2.65-5.266-1.255z" fill="#1BA9F5"></path><path d="M20.873 27.277a3.736 3.736 0 002.285.785 3.783 3.783 0 003.101-1.63 3.812 3.812 0 00.451-3.484l-4.8-1.125-1.037 5.454z" fill="#93C90E"></path><path d="M21.848 20.563l5.28 1.238a5.34 5.34 0 002.622-1.938 5.37 5.37 0 001.013-3.106 5.312 5.312 0 00-.936-3.01 5.283 5.283 0 00-2.475-1.944l-6.904 6.07 1.4 2.69z" fill="#07C"></path></svg><span class="euiHeaderLogo__text"><svg class="elasticMark" width="64" height="19" fill="white" xmlns="http://www.w3.org/2000/svg" aria-labelledby="elasticMark"><title id="elasticMark">Elastic</title><path d="M9.74 16.882l.711-.076.046 1.455c-1.879.257-3.485.393-4.818.393-1.773 0-3.03-.515-3.773-1.545C1.164 16.08.8 14.473.8 12.306c0-4.333 1.727-6.5 5.167-6.5 1.666 0 2.909.47 3.727 1.394.818.924 1.227 2.394 1.227 4.379l-.106 1.409H2.664c0 1.364.242 2.379.742 3.03.5.652 1.349.985 2.576.985 1.242.03 2.485-.015 3.757-.121zm-.667-5.349c0-1.515-.243-2.59-.728-3.212-.484-.621-1.272-.94-2.363-.94s-1.924.334-2.47.986c-.545.651-.833 1.712-.848 3.166h6.409zM13.497 18.427V.7h1.848v17.727h-1.848zM27.027 9.806v6.076c0 .621 1.53.742 1.53.742l-.09 1.637c-1.303 0-2.38.106-3.03-.515a10.861 10.861 0 01-4.44.924c-1.136 0-2-.319-2.59-.97-.592-.636-.895-1.56-.895-2.773 0-1.197.303-2.09.91-2.651.605-.56 1.56-.925 2.863-1.046l3.879-.363v-1.06c0-.834-.182-1.44-.546-1.804-.363-.364-.863-.545-1.485-.545H18.27V5.82h4.742c1.394 0 2.41.318 3.046.97.651.636.97 1.651.97 3.015zm-7.606 5.03c0 1.516.621 2.273 1.879 2.273a9.89 9.89 0 003.303-.56l.56-.197v-4.076l-3.65.348c-.743.06-1.274.273-1.607.637-.333.363-.485.894-.485 1.575zM34.255 7.473c-1.788 0-2.697.62-2.697 1.879 0 .575.212.984.62 1.227.41.242 1.35.485 2.819.742 1.47.258 2.5.606 3.106 1.076.606.454.91 1.318.91 2.59 0 1.274-.41 2.198-1.228 2.789-.818.59-2 .894-3.576.894-1.015 0-4.424-.38-4.424-.38l.106-1.605c1.954.182 3.379.333 4.333.333.955 0 1.682-.151 2.182-.454.5-.303.758-.819.758-1.53 0-.713-.212-1.198-.637-1.455-.424-.258-1.363-.5-2.818-.728-1.455-.227-2.485-.56-3.09-1.015-.607-.439-.91-1.272-.91-2.47 0-1.196.424-2.09 1.273-2.666.848-.576 1.909-.864 3.166-.864 1 0 4.485.258 4.485.258v1.621c-1.833-.106-3.333-.242-4.379-.242zM47.952 7.685h-3.925v5.909c0 1.409.106 2.348.303 2.788.212.44.697.666 1.47.666l2.197-.151.121 1.53c-1.106.182-1.94.273-2.515.273-1.288 0-2.167-.318-2.667-.94-.5-.62-.742-1.818-.742-3.575v-6.5h-1.758V6.079h1.758V2.29h1.833v3.773h3.925v1.62zM50.527 3.276V1.139h1.849v2.152l-1.849-.015zm0 15.151V6.08h1.849v12.348h-1.849zM60.406 5.821c.546 0 1.47.106 2.773.303l.59.076-.075 1.5c-1.318-.152-2.288-.227-2.91-.227-1.393 0-2.348.333-2.848 1-.5.666-.757 1.909-.757 3.712 0 1.803.227 3.06.697 3.773.47.712 1.44 1.06 2.924 1.06l2.91-.227.075 1.53c-1.53.227-2.682.349-3.44.349-1.924 0-3.257-.5-3.984-1.485-.728-.985-1.106-2.652-1.106-5 0-2.349.393-4 1.181-4.94.803-.939 2.122-1.424 3.97-1.424z"></path></svg></span></a></div></div><div class="euiHeaderSection euiHeaderSection--dontGrow euiHeaderSection--left"><div class="euiHeaderSectionItem"><nav class="euiHeaderLinks" aria-label="App menu"><div class="euiHeaderLinks__list euiHeaderLinks__list--gutterS"><a class="euiButton euiButton--primary euiButton--small euiButton--fill" href="https://cloud.elastic.co/registration?source=docsHeader" rel=""><span class="euiButtonContent euiButton__content"><span class="euiButton__text">Try Free</span></span></a></div></nav></div></div></div></header><div class="euiPage euiPage--grow docArticle__template"><div class="euiPageSideBar euiPageSideBar--paddingLarge euiPageSideBar--sticky docChrome__sidebar"><div class="euiFlexItem" data-elastic-exclude="true"><div class="euiContextMenu docChrome__contextMenu"><div class="euiContextMenuPanel euiContextMenu__panel" tabindex="-1"><button class="euiContextMenuPanelTitle" type="button" data-test-subj="contextMenuPanelTitleButton"><span class="euiContextMenu__itemLayout"><svg width="16" height="16" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg" class="euiIcon euiIcon--medium euiContextMenu__icon" focusable="false" role="img" aria-hidden="true"><path fill-rule="evenodd" clip-rule="evenodd" d="M11.018 14.043a.75.75 0 00.024-1.06l-4.59-4.81a.25.25 0 010-.346l4.59-4.81a.75.75 0 10-1.085-1.035l-4.59 4.81a1.75 1.75 0 000 2.416l4.59 4.81c.286.3.761.31 1.06.024z"></path></svg><span class="euiContextMenu__text">Elastic 가이드북 (7.x)</span></span></button><div><div class="euiSpacer euiSpacer--s css-i2qclb-euiSpacer-s"></div><nav class="euiSideNav" aria-label="Elastic 가이드북 (7.x)"><div id="euiSideNav_e6d58df0-eb7c-11ec-8b0c-953a61136e63_content" class="euiSideNav__content euiSideNav__contentMobile-xs euiSideNav__contentMobile-s"><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1. 서문</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1. 서문</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-elastic-stack" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1 Elastic Stack 소개</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-01-elasticsearch" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1.1 Elasticsearch</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-02-logstash" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1.2 Logstash</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-03-kibana" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1.3 Kibana</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-01-01-04-beats" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">1.1.4 Beats</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2. Elasticsearch 시작하기</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2. Elasticsearch 시작하기</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-01-data-indexing" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.1 데이터 색인</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-02-install-run" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.2 설치 및 실행</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-02-01-download" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.2.1 다운로드 설치 및 실행</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-02-02-unix-rpm" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.2.2 Unix RPM 설치 및 실행</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-es-config" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3 Elasticsearch 환경 설정</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-01-jvm" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3.1 jvm.options</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-02-es-yml" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3.2 elasticsearch.yml</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-03-node-config" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3.3 노드의 역할 : master, data, insgest</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-02-03-04-cmd" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">2.3.4 커맨드 라인 설정</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3. Elasticsearch 시스템 구조</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-03-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3. Elasticsearch 시스템 구조</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-03-01-cluster" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3.1 클러스터 구성</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-03-02-index-shard" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3.2 인덱스와 샤드 - Index &amp; Shards</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-03-03-master-data-nodes" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">3.3 마스터 노드와 데이터 노드 - Master &amp; Data Nodes</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4. Elasticsearch 데이터 처리</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4. Elasticsearch 데이터 처리</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-01-rest-api" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4.1 REST API</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-02-crud" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4.2 CRUD - 입력,조회,수정,삭제</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-03-bulk-api" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4.3 벌크 - _bulk API</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-04-04-search-api" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">4.4 검색 - _search API</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5. 검색과 쿼리 - Query DSL</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5. 검색과 쿼리 - Query DSL</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-01-fulltext" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.1 풀텍스트 쿼리 - Full Text Query</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-02-bool" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.2 복합 쿼리 - Bool Query</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-03-relevancy" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.3 정확도 - Relevancy</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-04-bool-should" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.4 bool : sould</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-05-exact-value" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.5 정확값 쿼리 - Exact Value Query</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-05-06-range" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">5.6 범위 쿼리 - Range Query</span></span></a></div></div></div><div class="euiSideNavItem euiSideNavItem--root euiSideNavItem--hasChildItems"><div class="euiSideNavItemButton"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6. 데이터 색인과 텍스트 분석</span></span></div><div class="euiSideNavItem__items"><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-overview" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6. 데이터 색인과 텍스트 분석</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-01-inverted-index" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.1 역 인덱스 - Inverted Index</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-02-text-analysis" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.2 텍스트 분석 - Text Analysis</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-03-analyzer" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.3 애널라이저 - Analyzer</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-04-char-filter" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.4 캐릭터 필터 - Character Filter</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-05-tokenizer" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.5 토크나이저 - Tokenizer</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable euiSideNavItemButton-isSelected" href="/krEsguide7/esG7-06-06-token-filter" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.6 토큰 필터 - Token Filter</span></span></a></div><div class="euiSideNavItem euiSideNavItem--trunk"><a class="euiSideNavItemButton euiSideNavItemButton--isClickable" href="/krEsguide7/esG7-06-07-stemming" rel="noreferrer"><span class="euiSideNavItemButton__content"><span class="euiSideNavItemButton__label euiSideNavItemButton__label--truncated">6.7 형태소 분석 - Stemming</span></span></a></div></div></div></div></nav></div></div></div></div></div><div class="euiPanel euiPanel--paddingLarge euiPanel--borderRadiusNone euiPanel--plain euiPanel--hasShadow euiPageBody euiPageBody--borderRadiusNone euiPageBody--paddingLarge"><div class="euiFlexGroup euiFlexGroup--gutterExtraLarge euiFlexGroup--directionRow euiFlexGroup--responsive docArticle__wrap"><div class="euiFlexItem docArticle__article"><header class="euiPageHeader euiPageHeader--bottomBorder euiPageHeader--responsive euiPageHeader--center"><div class="euiPageHeaderContent"><div class="euiFlexGroup euiFlexGroup--gutterLarge euiFlexGroup--alignItemsFlexStart euiFlexGroup--directionRow euiFlexGroup--responsive euiPageHeaderContent__top"><div class="euiFlexItem"><h1 class="euiTitle euiTitle--large">6.6 토큰 필터 - Token Filter</h1><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div class="euiText euiText--medium euiText--constrainedWidth"><p><span class="euiTextColor euiTextColor--subdued">모든 문서에 대한 저작권은 Elastic 과 김종민(kimjmin@gmail.com) 에게 있으며 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 포함된 자료를 인용하고자 하는 경우 출처를 명시하고 게재된 주소를 김종민(kimjmin@gmail.com)에게 알려주시기 바랍니다.</span></p></div></div></div></div></header><div class="euiSpacer euiSpacer--xl css-kiiy9t-euiSpacer-xl"></div><div class="euiPanel euiPanel--borderRadiusMedium euiPanel--plain euiPanel--noShadow euiPageContent" role="main"><div class="euiPageContentBody"><div class="euiText euiText--medium"><p>토크나이저를 이용한 텀 분리 과정 이후에는 분리된 각각의 텀 들을 지정한 규칙에 따라 처리를 해 주는데 이 과정을 담당하는 것이 <strong>토큰 필터</strong>입니다. 토큰 필터는 <code class="euiCode" data-code-language="text">filter</code> <em><strong>(token_filter가 아닙니다!)</strong></em> 항목에 배열 값으로 나열해서 지정합니다. 하나만 사용하더라도 배열 값으로 입력해야 하며 나열된 순서대로 처리되기 때문에 순서를 잘 고려해서 입력해야 합니다.</p>
<p>토큰 필터 역시 종류가 상당히 많고 계속 업데이트 되기 때문에 이 책에서는 자주 사용되는 토큰 필터 위주로 살펴보겠습니다. <a class="euiLink euiLink--primary" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenfilters.html" rel="">공식 도큐먼트<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--small euiIcon-isLoading euiLink__externalIcon" focusable="false" role="img" aria-label="External link" aria-hidden="true"></svg></a>에서 내가 필요로 하는 토큰 필터가 있는지 종종 들러서 살펴보시기 바랍니다.</p>
<h2 id="661-lowercase-uppercase" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#661-lowercase-uppercase" rel="noreferrer" aria-label="6.6.1 Lowercase, Uppercase permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>6.6.1 Lowercase, Uppercase</h2>
<p>영어나 유럽어 기반의 텍스트는 대소문자가 있어 검색할 때는 대소문자에 상관 없이검색이 가능하도록 처리 해 주어야 합니다. 보통은 텀 들을 모두 소문자로 변경하여 저장하는데 이 역할을 하는 것이 <strong>Lowercase</strong> 토큰 필터입니다. <strong>Lowercase</strong> 토큰 필터는 거의 모든 텍스트 검색 사례에서 사용되는 토큰 필터입니다.</p>
<p><strong>Uppercase</strong> 토큰 필터는 모든 텀을 대문자로 변경하는 것 이며 Lowercase 와 동일하게 설정합니다. 다음은 <strong>&quot;Harry Potter and the Philosopher&#x27;s Stone&quot;</strong> 문장을 lowercase와 uppercase 로 분석한 예제입니다.</p>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># lowercase 토큰 필터로 문장 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> _analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;lowercase&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;Harry Potter and the Philosopher&#x27;s Stone&quot;</span> <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># uppercase 토큰 필터로 문장 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> _analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;uppercase&quot;</span> <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;Harry Potter and the Philosopher&#x27;s Stone&quot;</span> <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<h2 id="662-stop" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#662-stop" rel="noreferrer" aria-label="6.6.2 Stop permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>6.6.2 Stop</h2>
<p>블로그 포스트나 뉴스 기사 같은 글에는 검색에서는 큰 의미가 없는 조사나 전치사 등이 많습니다. 영문에서도 <strong>the</strong>, <strong>is</strong>, <strong>a</strong> 같은 단어들은 대부분 검색어로 쓰이지 않는데 이런 단어를 한국어로는 <strong>불용어</strong>, 영어로는 <strong>stopword</strong>라고 합니다. <strong>Stop</strong> 토큰 필터를 적용하면 불용어에 해당되는 텀 들을 제거합니다.</p>
<p><code class="euiCode" data-code-language="text">stopwords</code> 항목에 불용어로 지정할 단어들을 배열 형태로 나열하거나 <code class="euiCode" data-code-language="text">&quot;_english_&quot;</code>, <code class="euiCode" data-code-language="text">&quot;_german_&quot;</code> 같이 언어를 지정해서 해당 언어팩에 있는 불용어를 지정할 수도 있습니다. 지원되는 언어팩은 <a class="euiLink euiLink--primary" href="https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-tokenfilter.html" rel="">공식 도큐먼트<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--small euiIcon-isLoading euiLink__externalIcon" focusable="false" role="img" aria-label="External link" aria-hidden="true"></svg></a>에서 확인할 수 있으며 한, 중, 일어 등은 별도의 형태소 분석기를 사용해야 합니다. 불용어 목록을 별도의 텍스트 파일로 저장하고 저장된 파일 경로를 <code class="euiCode" data-code-language="text">stopwords_path</code> 항목의 값으로 지정하여 사용하는 것도 가능합니다.</p>
<p>다음은 <strong>my_stop</strong> 인덱스에 <strong>&quot;in&quot;</strong>, <strong>&quot;the&quot;</strong>, <strong>&quot;days&quot;</strong> 를 불용어로 처리하는 <strong>my_stop_filter</strong> 라는 이름의 <code class="euiCode" data-code-language="text">stop</code> 토큰필터를 정의하고 <code class="euiCode" data-code-language="text">lowercase</code> 필터와 함께 <strong>&quot;Around the World in Eighty Days&quot;</strong> 문장을 분석 하는 예제입니다.</p>
<div class="euiCallOut euiCallOut--warning docCallOut"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--default"><p>불용어로 처리할 단어들이 소문자이기 때문에 분석할 때는 반드시 lowercase 토큰필터를 먼저 적용해야 합니다.</p></div></div></div>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># my_stop 인덱스에 my_stop_filter 토큰필터 생성
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_stop
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_stop_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stop&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;stopwords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;in&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;the&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;days&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># my_stop_filter 토큰 필터로 문장 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_stop<span class="token operator">/</span>_analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;my_stop_filter&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;Around the World in Eighty Days&quot;</span> <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>이번에는 불용어 <strong>&quot;in&quot;</strong>, <strong>&quot;the&quot;</strong>, **&quot;eighty&quot;**를 <strong>my_stop_dic.txt</strong> 파일 안에 저장하고 이 파일을 읽어들여 동일한 문장을 분석 해 보는 예제입니다. 불용어는 모두 줄바꿈으로 입력해야 하며 사전 파일 경로는 <strong>elasticsearch</strong> 의 <strong>config</strong> 디렉토리를 기준으로 상대 경로를 지정해야 하며 텍스트 인코딩은 반드시 <strong>UTF-8</strong> 로 되어 있어야 합니다. <strong>my_stop_dic.txt</strong> 파일은 <strong>elasticsearch</strong> 홈 아래의 <strong>config/user_dic</strong> 디렉토리에 저장되었다고 가정하겠습니다.</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line"><span class="token comment"># config/user_dic 디렉토리 생성 후 my_stop_dic.txt 파일 생성</span>
</span><span class="euiCodeBlock__line">
</span><span class="euiCodeBlock__line">$ <span class="token function">mkdir</span> config/user_dic
</span><span class="euiCodeBlock__line">$ <span class="token builtin class-name">echo</span> <!-- -->&#x27;in
</span><span class="euiCodeBlock__line">the
</span><span class="euiCodeBlock__line">eighty&#x27;<!-- --> <span class="token operator">&gt;</span> config/user_dic/my_stop_dic.txt
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># stopwords_path 설정을 가진 my_stop_filter 토큰필터 생성
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_stop
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_stop_filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stop&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;stopwords_path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user_dic/my_stop_dic.txt&quot;</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># my_stop_filter 토큰 필터로 문장 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_stop<span class="token operator">/</span>_analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;my_stop_filter&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span> <span class="token string">&quot;Around the World in Eighty Days&quot;</span> <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p><strong>my_stop_dic.txt</strong> 파일 내용인 <strong>in</strong>, <strong>the</strong>, <strong>eight</strong> 가 제거된 나머지 텀 들만 결과로 나타난 것을 확인할 수 있습니다.</p>
<div class="euiCallOut euiCallOut--danger docCallOut"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--default"><p>기존의 사전 파일의 내용이 변경 된 경우 인덱스를 새로 고침을 해 주어야 토큰 필터가 새로 적용됩니다. 이것은 <strong>stop</strong> 외에도 뒤에 설명할 <strong>synonym</strong> 이나 <strong>nori 한글 형태소 분석기</strong> 사전에도 동일하게 적용됩니다. 새로 고침을 하는 방법은</p><p><strong>POST &lt;인덱스명&gt;/_close</strong>
<strong>POST &lt;인덱스명&gt;/_open</strong></p><p>을 차례대로 실행 해 주면 됩니다. 인덱스가 close 된 중에는 색인이나 검색이 불가능 하게 되니 주의해야 합니다.</p><p>또한 애널라이저의 사전만 갱신되는 것이기 때문에 이미 색인된 도큐먼트들의 역 색인 내용은 변경되지 않습니다. 인덱스 새로 고침 이후에 색인되는 데이터들과 match 쿼리의 검색 등에만 적용이 됩니다. 기존 도큐먼트의 역 색인을 변경하려면 데이터를 모두 다시 재색인을 해야 합니다.</p></div></div></div>
<h2 id="663-synonym" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#663-synonym" rel="noreferrer" aria-label="6.6.3 Synonym permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>6.6.3 Synonym</h2>
<p>검색 서비스에 따라서 <strong>동의어</strong> 검색을 제공해야 하는 경우가 있습니다. 예를 들면 클라우드 서비스 관련 정보를 검색하는 시스템에서 &quot;AWS&quot; 라는 단어를 검색했을 때 &quot;Amazon&quot; 또는 한글 &quot;아마존&quot; 도 같이 검색을 하도록 하면 관련된 정보를 더 많이 찾을 수 있을 것입니다. 이 때 <strong>Synonym</strong> 토큰 필터를 사용하면 텀의 동의어 저장이 가능합니다. </p>
<p>동의어를 설정하는 옵션은 <code class="euiCode" data-code-language="text">synonyms</code> 항목에서 직접 동의어 목록을 입력하는 방법과 동의어 사전 파일을 만들어 <code class="euiCode" data-code-language="text">synonyms_path</code> 로 지정하는 방법이 있습니다. 동의어 사전 명시 규칙에는 다음의 것들이 있습니다.</p>
<ul>
<li><code class="euiCode" data-code-language="text">&quot;A, B =&gt; C&quot;</code> : 왼쪽의 A, B 대신 오른쪽의 C 텀을 저장합니다. A, B 로는 C 의 검색이 가능하지만 C 로는 A, B 가 검색되지 않습니다.</li>
<li><code class="euiCode" data-code-language="text">&quot;A, B&quot;</code> : A, B 각 텀이 A 와 B 두개의 텀을 모두 저장합니다. A 와 B 모두 서로의 검색어로 검색이 됩니다.</li>
</ul>
<p>다음은 <strong>my_synonym</strong> 인덱스에 <code class="euiCode" data-code-language="text">&quot;amazon =&gt; aws&quot;</code> 으로 동의어를 지정하는 예제입니다.</p>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># <span class="token string">&quot;amazon =&gt; aws&quot;</span> 동의어를 지정하는 my_synonym 인덱스 생성
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_syn&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;syn_aws&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;syn_aws&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;synonym&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;synonyms&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;amazon =&gt; aws&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_syn&quot;</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>이제 여기에 <strong>&quot;Amazon Web Service&quot;</strong>, <strong>&quot;AWS&quot;</strong> 값을 가진 도큐먼트 두 개를 저장하고 각 도큐먼트의 <code class="euiCode" data-code-language="text">_termvectors</code> 를 확인 해 보겠습니다.</p>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># <span class="token constant">AWS</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Amazon</span> <span class="token maybe-class-name">Web</span> <span class="token maybe-class-name">Service</span> 도큐먼트 저장
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">1</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span> <span class="token string">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Amazon Web Service&quot;</span> <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">2</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span> <span class="token string">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;AWS&quot;</span> <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># <span class="token number">1</span> 도큐먼트 message 필드의 termvectors 확인
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_synonym<span class="token operator">/</span>_termvectors<span class="token operator">/</span><span class="token number">1</span><span class="token operator">?</span>fields<span class="token operator">=</span>message
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># <span class="token number">2</span> 도큐먼트 message 필드의 termvectors 확인
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_synonym<span class="token operator">/</span>_termvectors<span class="token operator">/</span><span class="token number">2</span><span class="token operator">?</span>fields<span class="token operator">=</span>message
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>1 도큐먼트의 **&quot;Amazon Web Service&quot;**가 <strong>amazon</strong> 대신 <strong>&quot;aws&quot;</strong>, <strong>&quot;web&quot;</strong>, <strong>&quot;service&quot;</strong> 로 저장된 것을 확인할 수 있습니다. 다음은 각각 <strong>term</strong> 쿼리로 <strong>aws</strong>, <strong>amazon</strong> 을 검색한 결과와 <strong>match</strong> 쿼리로 <strong>amazon</strong> 을 검색한 결과입니다.</p>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># term 쿼리로 aws 검색
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_synonym<span class="token operator">/</span>_search
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;aws&quot;</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># term 쿼리로 amazon 검색
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_synonym<span class="token operator">/</span>_search
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amazon&quot;</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># match 쿼리로 amazon 검색
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_synonym<span class="token operator">/</span>_search
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;match&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;amazon&quot;</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>첫 번째 쿼리와 마지막 세 번째 쿼리의 결과가 동일합니다.</p>
<p><strong>term</strong> 쿼리는 검색어에 애널라이저를 적용하지 않고 그대로 검색하기 때문에 <strong>term</strong> 쿼리로 <strong>aws</strong> 를 검색하면 두개의 도큐먼트가 모두 검색되고 <strong>amazon</strong>을 검색 하면 검색이 되지 않습니다. <strong>match</strong> 쿼리는 검색어 <strong>amazon</strong>도 <strong>my_syn</strong> 애널라이저가 적용이 되어 <strong>aws</strong> 로 변환하여 검색을 하기 때문에 <strong>aws</strong>로 검색을 한 것과 같은 결과가 나타납니다.</p>
<p>이번에는 <strong>my_synonym</strong> 인덱스에 <code class="euiCode" data-code-language="text">&quot;amazon, aws&quot;</code>  로 동의어를 지정하는 예제입니다. 기존의 <strong>my_synonym</strong> 인덱스를 먼저 삭제하고 입력합니다.</p>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># <span class="token string">&quot;amazon, aws&quot;</span> 동의어를 지정하는 my_synonym 인덱스 생성
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_syn&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;syn_aws&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;syn_aws&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;synonym&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;synonyms&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;amazon, aws&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_syn&quot;</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>앞의 예제와 동일하게 <strong>&quot;Amazon Web Service&quot;</strong>, <strong>&quot;AWS&quot;</strong> 값을 가진 도큐먼트 두 개를 저장하고 각 도큐먼트의 <code class="euiCode" data-code-language="text">_termvectors</code> 를 확인 해 보겠습니다.</p>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># <span class="token constant">AWS</span><span class="token punctuation">,</span> <span class="token maybe-class-name">Amazon</span> <span class="token maybe-class-name">Web</span> <span class="token maybe-class-name">Service</span> 도큐먼트 저장
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">1</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span> <span class="token string">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;Amazon Web Service&quot;</span> <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">2</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span> <span class="token string">&quot;message&quot;</span> <span class="token operator">:</span> <span class="token string">&quot;AWS&quot;</span> <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># <span class="token number">1</span> 도큐먼트 message 필드의 termvectors 확인
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_synonym<span class="token operator">/</span>_termvectors<span class="token operator">/</span><span class="token number">1</span><span class="token operator">?</span>fields<span class="token operator">=</span>message
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># <span class="token number">2</span> 도큐먼트 message 필드의 termvectors 확인
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_synonym<span class="token operator">/</span>_termvectors<span class="token operator">/</span><span class="token number">2</span><span class="token operator">?</span>fields<span class="token operator">=</span>message
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>두 도큐먼트 모두 <code class="euiCode" data-code-language="text">&quot;position&quot; : 0</code> 위치에 <strong>&quot;aws&quot;</strong>, <strong>&quot;amazon&quot;</strong> 두개의 텀들이 모두 저장된 것을 확인할 수 있습니다. 이제 <strong>term</strong> 쿼리로 <strong>amazon</strong> 을 검색해도 두개 도큐먼트가 모두 검색이 됩니다. 이것은 한번 직접 실행 해 보시기 바랍니다.</p>
<p>동의어 여러 개를 입력 할 때는 <code class="euiCode" data-code-language="text">&quot;synonyms&quot;: [ ... ]</code> 항목 안에 배열로 넣어도 되지만, 그 보다는 파일을 따로 만들어 관리하는 것이 편합니다. <strong>stop</strong> 토큰 필터와 마찬가지로 <strong>synonyms_path</strong> 항목에 <strong>config</strong> 디렉토리 기준의 상대 경로에 파일을 저장하고 경로명을 입력하면 됩니다. 동의어는 하나의 규칙당 <strong>한 줄씩</strong> 입력해야 하며 파일은 <strong>UTF-8</strong>로 인코딩 되어야 합니다.</p>
<p>다음은 <strong>&quot;hop, jump&quot;</strong>, <strong>&quot;quick, fast&quot;</strong> 를 <strong>user_dic/my_syn_dic.txt</strong> 에 저장해서 동의어 사전으로 사용하는 예제입니다.</p>
<div><div class="language-bash euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="bash"><span class="euiCodeBlock__line"><span class="token comment"># config/user_dic 디렉토리 아래에 my_syn_dic.txt 파일 생성</span>
</span><span class="euiCodeBlock__line">$ <span class="token builtin class-name">echo</span> <!-- -->&#x27;quick, fast
</span><span class="euiCodeBlock__line">hop, jump&#x27;<!-- --> <span class="token operator">&gt;</span> config/user_dic/my_syn_dic.txt
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># synonyms_path 설정을 가진 my_synonym 인덱스 생성
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_syn&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;syn_aws&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;syn_aws&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;synonym&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;synonyms_path&quot;</span><span class="token operator">:</span> <span class="token string">&quot;user_dic/my_syn_dic.txt&quot;</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;mappings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;properties&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;text&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;analyzer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;my_syn&quot;</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>이제 <strong>term</strong> 쿼리로 <strong>quick</strong> 과 <strong>jump</strong>를 검색하면 <strong>hop</strong>, <strong>fast</strong> 도 검색이 됩니다.</p>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># quick<span class="token punctuation">,</span> jump<span class="token punctuation">,</span> hop<span class="token punctuation">,</span> fast 를 포함하는 도큐먼트 저장
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">1</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span> <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;Quick brown fox jump&quot;</span> <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_synonym<span class="token operator">/</span>_doc<span class="token operator">/</span><span class="token number">2</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span> <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;hop rabbit is fast&quot;</span> <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># term 쿼리로 quick<span class="token punctuation">,</span> jump 검색
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_synonym<span class="token operator">/</span>_search
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;query&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;bool&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;must&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;quick&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;term&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;message&quot;</span><span class="token operator">:</span> <span class="token string">&quot;jump&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>마지막으로 <strong>synonym</strong> 토큰 필터에는 추가적으로 다음과 같은 옵션들이 있습니다.</p>
<ul>
<li><strong>expand</strong> (true / false. 디폴트는 <strong>true</strong>)
<code class="euiCode" data-code-language="text">&quot;expand&quot;: false</code> 로 설정하게 되면 <code class="euiCode" data-code-language="text">&quot;synonyms&quot;: &quot;aws, amazon&quot;</code> 같은 설정에 토큰들을 모두 저장하지 않고 맨 처음에 명시된 토큰 하나만 저장합니다. 앞의 설정은 <code class="euiCode" data-code-language="text">&quot;synonyms&quot;: &quot;aws, amazon =&gt; aws&quot;</code> 로 설정한 것과 동일하게 동작합니다.</li>
<li><strong>lenient</strong> (true / false. 디폴트는 <strong>false</strong>)
<code class="euiCode" data-code-language="text">&quot;lenient&quot;: true</code> 로 설정하면 synonym 설정에 오류가 있는 경우 오류가 있는 부분을 무시하고 실행합니다.</li>
</ul>
<h2 id="664-ngram-edge-ngram-shingle" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#664-ngram-edge-ngram-shingle" rel="noreferrer" aria-label="6.6.4 NGram, Edge NGram, Shingle permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>6.6.4 NGram, Edge NGram, Shingle</h2>
<h3 id="ngram" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#ngram" rel="noreferrer" aria-label="NGram permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>NGram</h3>
<p>Elasticsearch는 빠른 검색을 위해 검색에 사용될 텀 들을 미리 분리해서 역 인덱스에 저장합니다. 하지만 과학 용어집 검색 같은 특정한 사용 사례에 따라 텀이 아닌 단어의 일부만 가지고도 검색해야 하는 기능이 필요한 경우도 있습니다. RDBMS의 LIKE 검색 처럼 사용하는 <strong>wildcard</strong> 쿼리나 <strong>regexp (정규식)</strong> 쿼리도 지원을 하지만, 이런 쿼리들은 메모리 소모가 많고 느리기 때문에 Elasticsearch의 장점을 활용하지 못합니다. 이런 사용을 위해 검색 텀의 일부만 미리 분리해서 저장을 할 수 있는데 이렇게 단어의 일부를 나눈 부위를 <strong>NGram</strong> 이라고 합니다. 보통은 <strong>unigram</strong>(유니그램 – 1글자), <strong>bigram</strong>(바이그램 - 2자) 등으로 부릅니다.</p>
<p>Elasticsearch는 <strong>NGram</strong>을 처리하는 토큰 필터를 제공하며 설정은 <code class="euiCode" data-code-language="text">&quot;type&quot;: &quot;nGram&quot;</code> 으로 합니다. <strong>&quot;house&quot;</strong> 라는 단어를 2 글자의 NGram (bigram) 으로 처리하면 다음과 같이 &quot;<strong>ho&quot;</strong>, <strong>&quot;ou&quot;</strong>, <strong>&quot;us&quot;</strong>, <strong>&quot;se&quot;</strong> 총 4개의 토큰들이 추출됩니다. ngram 토큰필터를 사용하면 이렇게 2글자씩 추출된 텀들이 모두 검색 토큰으로 저장됩니다. 이제 이 인덱스의 경우에는 검색어를 <strong>&quot;ho&quot;</strong> 라고만 검색을 해도 <strong>ho</strong>use 가 포함된 도큐먼트들이 검색이 됩니다.</p>
<p><figure class="euiImage euiImage--hasShadow euiImage--allowFullScreen euiImage--original"><button type="button" aria-label="Open fullscreen 단어 house를 ngram(2) 으로 분리 image" class="euiImage__button" data-test-subj="activateFullScreenButton"><img src="/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/06-06_ngram_house.png" alt="단어 house를 ngram(2) 으로 분리" class="euiImage__img" title="단어 house를 ngram(2) 으로 분리"/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon--ghost euiImage__icon" focusable="false" role="img" aria-hidden="true"><path d="M13 3v4h-1V4H9V3h4zM3 3h4v1H4v3H3V3zm10 10H9v-1h3V9h1v4zM3 13V9h1v3h3v1H3zM0 1.994C0 .893.895 0 1.994 0h12.012C15.107 0 16 .895 16 1.994v12.012A1.995 1.995 0 0114.006 16H1.994A1.995 1.995 0 010 14.006V1.994zm1 0v12.012c0 .548.446.994.994.994h12.012a.995.995 0 00.994-.994V1.994A.995.995 0 0014.006 1H1.994A.995.995 0 001 1.994z" fill-rule="evenodd"></path></svg></button></figure></p>
<div class="euiCallOut euiCallOut--danger docCallOut"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--default"><p><strong>ngram</strong> 토큰필터를 사용하면 저장되는 텀의 갯수도 기하급수적으로 늘어나고 검색어를 <strong>&quot;ho&quot;<strong>로 검색 했을 때 <strong>ho</strong>use, s</strong>ho</strong>es 처럼 검색 결과를 예상하기 어렵기 때문에 일반적인 텍스트 검색에는 사용하지 않는 것이 좋습니다. ngram을 사용하기 적합한 사례는 카테고리 목록이나 태그 목록과 같이 전체 개수가 많지 않은 데이터 집단에 <strong>자동완성</strong> 같은 기능을 구현하는 데에 적합합니다.</p></div></div></div>
<p>ngram 토큰 필터에는 <code class="euiCode" data-code-language="text">min_gram</code> (디폴트 1), <code class="euiCode" data-code-language="text">max_gram</code> (디폴트 2) 옵션이 있습니다. 짐작할 수 있듯이 최소, 최대 문자수의 토큰을 구분하는 단위입니다. <strong>house</strong>를 <code class="euiCode" data-code-language="text">&quot;min_gram&quot;: 2</code>, <code class="euiCode" data-code-language="text">&quot;max_gram&quot;: 3</code> 으로 설정하면 다음과 같이 분석되어 총 7개의 토큰을 저장합니다.</p>
<p><figure class="euiImage euiImage--hasShadow euiImage--allowFullScreen euiImage--original"><button type="button" aria-label="Open fullscreen 단어 house를 ngram(2-3) 으로 분리 image" class="euiImage__button" data-test-subj="activateFullScreenButton"><img src="/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/06-06_ngram_house_2.png" alt="단어 house를 ngram(2-3) 으로 분리" class="euiImage__img" title="단어 house를 ngram(2-3) 으로 분리"/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon--ghost euiImage__icon" focusable="false" role="img" aria-hidden="true"><path d="M13 3v4h-1V4H9V3h4zM3 3h4v1H4v3H3V3zm10 10H9v-1h3V9h1v4zM3 13V9h1v3h3v1H3zM0 1.994C0 .893.895 0 1.994 0h12.012C15.107 0 16 .895 16 1.994v12.012A1.995 1.995 0 0114.006 16H1.994A1.995 1.995 0 010 14.006V1.994zm1 0v12.012c0 .548.446.994.994.994h12.012a.995.995 0 00.994-.994V1.994A.995.995 0 0014.006 1H1.994A.995.995 0 001 1.994z" fill-rule="evenodd"></path></svg></button></figure></p>
<p>다음은 <strong>my_ngram</strong> 인덱스에 <code class="euiCode" data-code-language="text">&quot;min_gram&quot;: 2</code>, <code class="euiCode" data-code-language="text">&quot;max_gram&quot;: 3</code> 인 <strong>my_ngram_f</strong> 토큰필터를 만들고 house 를 분석하는 예제입니다.</p>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_ngram
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_ngram_f&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;nGram&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;min_gram&quot;</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;max_gram&quot;</span><span class="token operator">:</span> <span class="token number">3</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># my_ngram_f 토큰필터로 <span class="token string">&quot;house&quot;</span> 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_ngram<span class="token operator">/</span>_analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;keyword&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;my_ngram_f&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;house&quot;</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<h3 id="edge-ngram" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#edge-ngram" rel="noreferrer" aria-label="Edge NGram permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>Edge NGram</h3>
<p>검색을 위해 NGram을 저장하더라도 보통은 단어의 맨 앞에서부터 검색하는 경우가 많습니다. 텀 앞쪽의 ngram 만 저장하기 위해서는 <strong>Edge NGram</strong> 토큰필터를 이용합니다. 설정 방법은 <code class="euiCode" data-code-language="text">&quot;type&quot;: &quot;edgeNGram&quot;</code> 입니다. edgeNGram의 옵션을 <code class="euiCode" data-code-language="text">&quot;min_gram&quot;: 1</code>, <code class="euiCode" data-code-language="text">&quot;max_gram&quot;: 4</code> 으로 설정하고 &quot;<strong>house&quot;</strong> 를 분석하면 다음과 같이 <strong>&quot;h&quot;, &quot;ho&quot;, &quot;hou&quot;, &quot;hous&quot;</strong> 4개의 토큰이 생성됩니다.</p>
<p><figure class="euiImage euiImage--hasShadow euiImage--allowFullScreen euiImage--original"><button type="button" aria-label="Open fullscreen 단어 house를 edgeNgram 으로 분리 image" class="euiImage__button" data-test-subj="activateFullScreenButton"><img src="/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/06-06_edngram.png" alt="단어 house를 edgeNgram 으로 분리" class="euiImage__img" title="단어 house를 edgeNgram 으로 분리"/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon--ghost euiImage__icon" focusable="false" role="img" aria-hidden="true"><path d="M13 3v4h-1V4H9V3h4zM3 3h4v1H4v3H3V3zm10 10H9v-1h3V9h1v4zM3 13V9h1v3h3v1H3zM0 1.994C0 .893.895 0 1.994 0h12.012C15.107 0 16 .895 16 1.994v12.012A1.995 1.995 0 0114.006 16H1.994A1.995 1.995 0 010 14.006V1.994zm1 0v12.012c0 .548.446.994.994.994h12.012a.995.995 0 00.994-.994V1.994A.995.995 0 0014.006 1H1.994A.995.995 0 001 1.994z" fill-rule="evenodd"></path></svg></button></figure></p>
<p>인덱스 설정과 쿼리를 이용한 애널라이저 분석은 위의 NGram 예제를 참고해서 직접 만들어 보시기 바랍니다.</p>
<h3 id="shingle" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#shingle" rel="noreferrer" aria-label="Shingle permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>Shingle</h3>
<p><strong>NGram</strong>과 <strong>Edge NGram</strong>은 모두 하나의 단어로부터 토큰을 확장하는 토큰 필터입니다. 문자가 아니라 단어 단위로 구성된 묶음을 <strong>Shingle</strong> 이라고 하며 <code class="euiCode" data-code-language="text">&quot;type&quot;: &quot;shingle&quot;</code> 토큰 필터의 이용이 가능합니다. <strong>&quot;this is my sweet home&quot;</strong> 라는 문장을 분리해서 <strong>2 단어씩 Shingle</strong> 토큰 필터를 적용하면 다음과 같은 4개의 <strong>shingle</strong> 들이 생성됩니다.</p>
<p><figure class="euiImage euiImage--hasShadow euiImage--allowFullScreen euiImage--original"><button type="button" aria-label="Open fullscreen this is my sweet home 문장을 shingle 로 분리 image" class="euiImage__button" data-test-subj="activateFullScreenButton"><img src="/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/06-06_shingle.png" alt="this is my sweet home 문장을 shingle 로 분리" class="euiImage__img" title="this is my sweet home 문장을 shingle 로 분리"/><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium euiIcon--ghost euiImage__icon" focusable="false" role="img" aria-hidden="true"><path d="M13 3v4h-1V4H9V3h4zM3 3h4v1H4v3H3V3zm10 10H9v-1h3V9h1v4zM3 13V9h1v3h3v1H3zM0 1.994C0 .893.895 0 1.994 0h12.012C15.107 0 16 .895 16 1.994v12.012A1.995 1.995 0 0114.006 16H1.994A1.995 1.995 0 010 14.006V1.994zm1 0v12.012c0 .548.446.994.994.994h12.012a.995.995 0 00.994-.994V1.994A.995.995 0 0014.006 1H1.994A.995.995 0 001 1.994z" fill-rule="evenodd"></path></svg></button></figure></p>
<p><strong>Shingle</strong> 토큰 필터에서 사용 가능한 옵션은 다음과 같습니다.</p>
<ul>
<li><strong>min_shingle_size</strong> / <strong>max_shingle_size</strong> : shingle의 최소 / 최대 단어 개수를 지정합니다. 디폴트는 모두 2 입니다.</li>
<li><strong>output_unigrams</strong> : Shingle 외에도 각각의 개별 토큰(unigram)도 저장 하는지의 여부를 설정합니다. 디폴트는 true 입니다.</li>
<li><strong>output_unigrams_if_no_shingles</strong> : shingle 을 만들 수 없는 경우에만 개별 토큰을 저장하는지의 여부를 설정합니다. 디폴트는 false 입니다.</li>
<li><strong>token_separator</strong> : 토큰 구분자를 지정합니다. 디폴트는 <code class="euiCode" data-code-language="text">&quot; &quot;</code> (스페이스) 입니다.</li>
<li><strong>filler_token</strong> : shing을 만들 텀이 없는 경우 (보통은 stop 토큰 필터와 함께 사용되어 offset 위치만 있고 텀이 없는 경우입니다) 대체할 텍스트를 지정합니다. 디폴트는 <code class="euiCode" data-code-language="text">_</code> 입니다.</li>
</ul>
<p>다음은 <strong>my_shingle</strong> 인덱스에서 <code class="euiCode" data-code-language="text">&quot;min_shingle_size&quot;: 3</code>, <code class="euiCode" data-code-language="text">&quot;max_shingle_size&quot;: 4</code> 로 설정해서 <strong>&quot;this is my sweet home&quot;</strong> 문장을 분석하는 예제입니다.</p>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_shingle
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_shingle_f&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shingle&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;min_shingle_size&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;max_shingle_size&quot;</span><span class="token operator">:</span> <span class="token number">4</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># my_shingle_f 토큰필터로 <span class="token string">&quot;this is my sweet home&quot;</span> 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_shingle<span class="token operator">/</span>_analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;my_shingle_f&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;this is my sweet home&quot;</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p><code class="euiCode" data-code-language="text">&quot;token&quot; : &quot;this is my&quot;</code>, <code class="euiCode" data-code-language="text">&quot;token&quot; : &quot;this is my sweet&quot;</code> 와 같은 토큰들이 저장된 것을 확인할 수 있습니다. 이번에는 <code class="euiCode" data-code-language="text">&quot;output_unigrams&quot;: false</code> 와 <code class="euiCode" data-code-language="text">&quot;filler_token&quot;: &quot;-&quot;</code> 설정을 추가하고 stop 토큰필터로 <code class="euiCode" data-code-language="text">&quot;is&quot;</code> 를 불용어 처리한 뒤 실행 해 보겠습니다.</p>
<div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"><span class="token constant">PUT</span> my_shingle
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;settings&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;analysis&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">      <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_shingle_f&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;shingle&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;min_shingle_size&quot;</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;max_shingle_size&quot;</span><span class="token operator">:</span> <span class="token number">4</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;output_unigrams&quot;</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;filler_token&quot;</span><span class="token operator">:</span> <span class="token string">&quot;-&quot;</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">        <span class="token string">&quot;my_stop_f&quot;</span><span class="token operator">:</span> <span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;type&quot;</span><span class="token operator">:</span> <span class="token string">&quot;stop&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">          <span class="token string">&quot;stopwords&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">            <span class="token string">&quot;is&quot;</span>
</span><span class="euiCodeBlock__line">          <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line">        <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">      <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">    <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># my_shingle 에서 <span class="token string">&quot;this is my sweet home&quot;</span> 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> my_shingle<span class="token operator">/</span>_analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;whitespace&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;my_stop_f&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;my_shingle_f&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token string">&quot;this is my sweet home&quot;</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p>단일 토큰들은 모두 삭제되었고 <code class="euiCode" data-code-language="text">&quot;is&quot;</code> 는 <code class="euiCode" data-code-language="text">&quot;-&quot;</code> 로 대치된 3, 4개 단어로 이루어진 shingle 들이 생성된 것을 확인할 수 있습니다.</p>
<div class="euiCallOut euiCallOut--warning docCallOut"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--default"><p><strong>NGram</strong>, <strong>Edged NGram</strong> 그리고 <strong>Shingle</strong> 토큰 필터는 보통 일반적인 텍스트 분석에 사용하기는 적합하지 않습니다. 하지만 자동 완성 기능을 구현하거나 프로그램 코드 안에서 문법이나 기능명을 검색하는 것과 같이 특수한 요구사항을 충족해야 하는 경우 유용하게 사용될 수 있습니다.</p></div></div></div>
<h2 id="665-unique" style="position:relative"><a class="euiLink euiLink--primary docArticle__headerLink" href="#665-unique" rel="noreferrer" aria-label="6.6.5 Unique permalink"><svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" class="euiIcon euiIcon--medium" focusable="false" role="img" aria-hidden="true"><path d="M7.66 3.803a.5.5 0 11-.706-.707L9.268.78c1.187-1.187 3.242-1 4.596.354s1.54 3.409.354 4.596l-3.536 3.536c-1.187 1.187-3.242 1-4.596-.354a.5.5 0 11.707-.707c.99.99 2.417 1.119 3.182.354l3.536-3.536c.765-.765.635-2.193-.354-3.182-.99-.99-2.417-1.119-3.182-.354L7.661 3.803zm-.32 7.392a.5.5 0 11.707.707l-2.315 2.314c-1.187 1.188-3.242 1-4.596-.353-1.354-1.354-1.54-3.41-.353-4.596L4.318 5.73c1.187-1.187 3.242-1 4.596.354a.5.5 0 01-.707.707c-.989-.99-2.416-1.12-3.182-.354L1.49 9.974c-.766.765-.636 2.193.353 3.182.99.989 2.417 1.119 3.182.353l2.315-2.314z"></path></svg></a>6.6.5 Unique</h2>
<p><strong>&quot;white fox, white rabbit, white bear&quot;</strong> 같은 문장을 분석하면 <strong>&quot;white&quot;</strong> 텀은 총 3번 저장이 됩니다. 역 색인에는 텀이 1개만 있어도 텀을 포함하는 도큐먼트를 가져올 수 있기 때문에 중복되는 텀 들은 삭제 해 주어도 검색에는 보통 무방합니다. 이 경우 <strong>unique</strong> 토큰 필터를 사용해서 중복되는 텀 들은 하나만 저장하도록 할 수 있습니다.</p>
<p>다음은 <strong>&quot;white fox, white rabbit, white bear&quot;</strong> 문장을 <strong>unique</strong> 토큰 필터를 적용하지 않은 경우와 적용한 경우를 비교 한 예제입니다.</p>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># 일반적인 <span class="token string">&quot;white fox, white rabbit, white bear&quot;</span> 문장 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> _analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;lowercase&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;white fox, white rabbit, white bear&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<div class="euiTabs euiTabs--small euiTabs--bottomBorder" role="tablist"><button role="tab" aria-selected="true" type="button" class="euiTab euiTab-isSelected" name="request"><span class="euiTab__content">request</span></button><button role="tab" aria-selected="false" type="button" class="euiTab" name="response"><span class="euiTab__content">response</span></button></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div><div class="language-javascript euiCodeBlock euiCodeBlock--fontSmall euiCodeBlock--paddingSmall"><pre class="euiCodeBlock__pre euiCodeBlock__pre--whiteSpacePre" tabindex="-1"><code class="euiCodeBlock__code" data-code-language="javascript"><span class="euiCodeBlock__line"># unique 토크나이저로 <span class="token string">&quot;white fox, white rabbit, white bear&quot;</span> 문장 분석
</span><span class="euiCodeBlock__line"><span class="token constant">GET</span> _analyze
</span><span class="euiCodeBlock__line"><span class="token punctuation">{</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;tokenizer&quot;</span><span class="token operator">:</span> <span class="token string">&quot;standard&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;filter&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;lowercase&quot;</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;unique&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span><span class="token punctuation">,</span>
</span><span class="euiCodeBlock__line">  <span class="token string">&quot;text&quot;</span><span class="token operator">:</span> <span class="token punctuation">[</span>
</span><span class="euiCodeBlock__line">    <span class="token string">&quot;white fox, white rabbit, white bear&quot;</span>
</span><span class="euiCodeBlock__line">  <span class="token punctuation">]</span>
</span><span class="euiCodeBlock__line"><span class="token punctuation">}</span>
</span><span class="euiCodeBlock__line"></span></code></pre></div></div>
<p><code class="euiCode" data-code-language="text">&quot;unique&quot;</code> 토큰 필터를 적용하면 <strong>&quot;white&quot;</strong> 텀이 하나만 저장된 것을 확인할 수 있습니다.</p>
<div class="euiCallOut euiCallOut--danger docCallOut"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--default"><p>match 쿼리를 사용해서 검색하는 경우 unique 토큰 필터를 적용한 필드는 텀의 개수가 1개로 되기 때문에 <strong>TF(Term Frequency)</strong> 값이 줄어들어 스코어 점수가 달라질 수 있습니다. match 쿼리를 이용해 <strong>정확도(relevancy)</strong> 를 따져야 하는 검색의 경우에는 unique 토큰 필터는 사용하지 않는 것이 바람직합니다.</p></div></div></div></div><div class="euiSpacer euiSpacer--l css-jz428s-euiSpacer-l"></div><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--subdued">Last updated: Jan 25th, 2022</div></div></div></div></div></div></div></div><footer class="docChromeFooter" data-elastic-exclude="true"><div class="euiFlexGroup euiFlexGroup--justifyContentSpaceAround euiFlexGroup--directionRow euiFlexGroup--responsive"><div class="euiFlexItem euiFlexItem--flexGrowZero docChromeFooter__container"><div class="euiFlexGroup euiFlexGroup--gutterExtraLarge euiFlexGroup--justifyContentSpaceBetween euiFlexGroup--directionRow euiFlexGroup--responsive"><div class="euiFlexItem"><div class="euiText euiText--small"><div class="euiTextColor euiTextColor--ghost"><p>Elasticsearch is a trademark of Elasticsearch B.V., registered in the U.S. and in other countries.</p><p>Apache, Apache Lucene, Apache Hadoop, Hadoop, HDFS and the yellow elephant logo are trademarks of the Apache Software Foundation in the United States and/or other countries.</p><p> <a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/trademarks" rel="">Trademarks</a><span class="docChromeFooter__divide">|</span><a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/terms-of-use" rel="">Terms of Use</a><span class="docChromeFooter__divide">|</span><a class="euiLink euiLink--ghost" href="https://www.elastic.co/legal/privacy-statement" rel="">Privacy</a><span class="docChromeFooter__divide">|</span>© <!-- -->2022<!-- --> Elasticsearch B.V. All Rights Reserved</p></div></div></div><div class="euiFlexItem euiFlexItem--flexGrowZero"></div><div class="euiFlexItem euiFlexItem--flexGrowZero"><figure class="euiImage docChromeFooter__logo"><img style="max-width:xs;max-height:xs;width:auto" src="/docs-kr/assets/images/logo-elastic-vertical-reverse.svg" class="euiImage__img" alt="Elastic logo"/></figure></div></div></div></div></footer></div></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"bundle":"!function(e,n){\"object\"==typeof exports\u0026\u0026\"object\"==typeof module?module.exports=n(require(\"mdxJsReact\"),require(\"React\")):\"function\"==typeof define\u0026\u0026define.amd?define([\"mdxJsReact\",\"React\"],n):\"object\"==typeof exports?exports.MDXContent=n(require(\"mdxJsReact\"),require(\"React\")):e.MDXContent=n(e.mdxJsReact,e.React)}(this,((e,n)=\u003e(()=\u003e{\"use strict\";var t={24:e=\u003e{e.exports=n},825:n=\u003e{n.exports=e}},l={};function a(e){var n=l[e];if(void 0!==n)return n.exports;var s=l[e]={exports:{}};return t[e](s,s.exports,a),s.exports}a.n=e=\u003e{var n=e\u0026\u0026e.__esModule?()=\u003ee.default:()=\u003ee;return a.d(n,{a:n}),n},a.d=(e,n)=\u003e{for(var t in n)a.o(n,t)\u0026\u0026!a.o(e,t)\u0026\u0026Object.defineProperty(e,t,{enumerable:!0,get:n[t]})},a.o=(e,n)=\u003eObject.prototype.hasOwnProperty.call(e,n),a.r=e=\u003e{\"undefined\"!=typeof Symbol\u0026\u0026Symbol.toStringTag\u0026\u0026Object.defineProperty(e,Symbol.toStringTag,{value:\"Module\"}),Object.defineProperty(e,\"__esModule\",{value:!0})};var s={};return(()=\u003e{a.r(s),a.d(s,{default:()=\u003el});var e=a(825),n=a(24),t=a.n(n);const l=function(){var n=arguments.length\u003e0\u0026\u0026void 0!==arguments[0]?arguments[0]:{},l=Object.assign({},(0,e.useMDXComponents)(),n.components),a=l.wrapper;return a?t().createElement(a,n,t().createElement(s)):s();function s(){var l=Object.assign({p:\"p\",strong:\"strong\",code:\"code\",em:\"em\",a:\"a\",h2:\"h2\",pre:\"pre\",ul:\"ul\",li:\"li\",h3:\"h3\",img:\"img\"},(0,e.useMDXComponents)(),n.components),a=l.DocTabs,s=l.DocTab,o=l.DocCallOut;return o||r(\"DocCallOut\",!0),s||r(\"DocTab\",!0),a||r(\"DocTabs\",!0),t().createElement(t().Fragment,null,t().createElement(l.p,null,\"토크나이저를 이용한 텀 분리 과정 이후에는 분리된 각각의 텀 들을 지정한 규칙에 따라 처리를 해 주는데 이 과정을 담당하는 것이 \",t().createElement(l.strong,null,\"토큰 필터\"),\"입니다. 토큰 필터는 \",t().createElement(l.code,{display:\"inline\"},\"filter\"),\" \",t().createElement(l.em,null,t().createElement(l.strong,null,\"(token_filter가 아닙니다!)\")),\" 항목에 배열 값으로 나열해서 지정합니다. 하나만 사용하더라도 배열 값으로 입력해야 하며 나열된 순서대로 처리되기 때문에 순서를 잘 고려해서 입력해야 합니다.\"),\"\\n\",t().createElement(l.p,null,\"토큰 필터 역시 종류가 상당히 많고 계속 업데이트 되기 때문에 이 책에서는 자주 사용되는 토큰 필터 위주로 살펴보겠습니다. \",t().createElement(l.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-tokenfilters.html\"},\"공식 도큐먼트\"),\"에서 내가 필요로 하는 토큰 필터가 있는지 종종 들러서 살펴보시기 바랍니다.\"),\"\\n\",t().createElement(l.h2,{id:\"661-lowercase-uppercase\"},\"6.6.1 Lowercase, Uppercase\"),\"\\n\",t().createElement(l.p,null,\"영어나 유럽어 기반의 텍스트는 대소문자가 있어 검색할 때는 대소문자에 상관 없이검색이 가능하도록 처리 해 주어야 합니다. 보통은 텀 들을 모두 소문자로 변경하여 저장하는데 이 역할을 하는 것이 \",t().createElement(l.strong,null,\"Lowercase\"),\" 토큰 필터입니다. \",t().createElement(l.strong,null,\"Lowercase\"),\" 토큰 필터는 거의 모든 텍스트 검색 사례에서 사용되는 토큰 필터입니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.strong,null,\"Uppercase\"),\" 토큰 필터는 모든 텀을 대문자로 변경하는 것 이며 Lowercase 와 동일하게 설정합니다. 다음은 \",t().createElement(l.strong,null,'\"Harry Potter and the Philosopher\\'s Stone\"'),\" 문장을 lowercase와 uppercase 로 분석한 예제입니다.\"),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# lowercase 토큰 필터로 문장 분석\\nGET _analyze\\n{\\n  \"filter\": [ \"lowercase\" ],\\n  \"text\": [ \"Harry Potter and the Philosopher\\'s Stone\" ]\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# lowercase 토큰 필터로 문장 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"harry potter and the philosopher\\'s stone\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 40,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# uppercase 토큰 필터로 문장 분석\\nGET _analyze\\n{\\n  \"filter\": [ \"uppercase\" ],\\n  \"text\": [ \"Harry Potter and the Philosopher\\'s Stone\" ]\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# uppercase 토큰 필터로 문장 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"HARRY POTTER AND THE PHILOSOPHER\\'S STONE\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 40,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(l.h2,{id:\"662-stop\"},\"6.6.2 Stop\"),\"\\n\",t().createElement(l.p,null,\"블로그 포스트나 뉴스 기사 같은 글에는 검색에서는 큰 의미가 없는 조사나 전치사 등이 많습니다. 영문에서도 \",t().createElement(l.strong,null,\"the\"),\", \",t().createElement(l.strong,null,\"is\"),\", \",t().createElement(l.strong,null,\"a\"),\" 같은 단어들은 대부분 검색어로 쓰이지 않는데 이런 단어를 한국어로는 \",t().createElement(l.strong,null,\"불용어\"),\", 영어로는 \",t().createElement(l.strong,null,\"stopword\"),\"라고 합니다. \",t().createElement(l.strong,null,\"Stop\"),\" 토큰 필터를 적용하면 불용어에 해당되는 텀 들을 제거합니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.code,{display:\"inline\"},\"stopwords\"),\" 항목에 불용어로 지정할 단어들을 배열 형태로 나열하거나 \",t().createElement(l.code,{display:\"inline\"},'\"_english_\"'),\", \",t().createElement(l.code,{display:\"inline\"},'\"_german_\"'),\" 같이 언어를 지정해서 해당 언어팩에 있는 불용어를 지정할 수도 있습니다. 지원되는 언어팩은 \",t().createElement(l.a,{href:\"https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-stop-tokenfilter.html\"},\"공식 도큐먼트\"),\"에서 확인할 수 있으며 한, 중, 일어 등은 별도의 형태소 분석기를 사용해야 합니다. 불용어 목록을 별도의 텍스트 파일로 저장하고 저장된 파일 경로를 \",t().createElement(l.code,{display:\"inline\"},\"stopwords_path\"),\" 항목의 값으로 지정하여 사용하는 것도 가능합니다.\"),\"\\n\",t().createElement(l.p,null,\"다음은 \",t().createElement(l.strong,null,\"my_stop\"),\" 인덱스에 \",t().createElement(l.strong,null,'\"in\"'),\", \",t().createElement(l.strong,null,'\"the\"'),\", \",t().createElement(l.strong,null,'\"days\"'),\" 를 불용어로 처리하는 \",t().createElement(l.strong,null,\"my_stop_filter\"),\" 라는 이름의 \",t().createElement(l.code,{display:\"inline\"},\"stop\"),\" 토큰필터를 정의하고 \",t().createElement(l.code,{display:\"inline\"},\"lowercase\"),\" 필터와 함께 \",t().createElement(l.strong,null,'\"Around the World in Eighty Days\"'),\" 문장을 분석 하는 예제입니다.\"),\"\\n\",t().createElement(o,{color:\"warning\"},t().createElement(l.p,null,\"불용어로 처리할 단어들이 소문자이기 때문에 분석할 때는 반드시 lowercase 토큰필터를 먼저 적용해야 합니다.\")),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_stop 인덱스에 my_stop_filter 토큰필터 생성\\nPUT my_stop\\n{\\n  \"settings\": {\\n    \"analysis\": {\\n      \"filter\": {\\n        \"my_stop_filter\": {\\n          \"type\": \"stop\",\\n          \"stopwords\": [\\n            \"in\",\\n            \"the\",\\n            \"days\"\\n          ]\\n        }\\n      }\\n    }\\n  }\\n}\\n')),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_stop_filter 토큰 필터로 문장 분석\\nGET my_stop/_analyze\\n{\\n  \"tokenizer\": \"whitespace\",\\n  \"filter\": [\\n    \"lowercase\",\\n    \"my_stop_filter\"\\n  ],\\n  \"text\": [ \"Around the World in Eighty Days\" ]\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_stop_filter 토큰 필터로 문장 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"around\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 6,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"world\",\\n      \"start_offset\" : 11,\\n      \"end_offset\" : 16,\\n      \"type\" : \"word\",\\n      \"position\" : 2\\n    },\\n    {\\n      \"token\" : \"eighty\",\\n      \"start_offset\" : 20,\\n      \"end_offset\" : 26,\\n      \"type\" : \"word\",\\n      \"position\" : 4\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(l.p,null,\"이번에는 불용어 \",t().createElement(l.strong,null,'\"in\"'),\", \",t().createElement(l.strong,null,'\"the\"'),', **\"eighty\"**를 ',t().createElement(l.strong,null,\"my_stop_dic.txt\"),\" 파일 안에 저장하고 이 파일을 읽어들여 동일한 문장을 분석 해 보는 예제입니다. 불용어는 모두 줄바꿈으로 입력해야 하며 사전 파일 경로는 \",t().createElement(l.strong,null,\"elasticsearch\"),\" 의 \",t().createElement(l.strong,null,\"config\"),\" 디렉토리를 기준으로 상대 경로를 지정해야 하며 텍스트 인코딩은 반드시 \",t().createElement(l.strong,null,\"UTF-8\"),\" 로 되어 있어야 합니다. \",t().createElement(l.strong,null,\"my_stop_dic.txt\"),\" 파일은 \",t().createElement(l.strong,null,\"elasticsearch\"),\" 홈 아래의 \",t().createElement(l.strong,null,\"config/user_dic\"),\" 디렉토리에 저장되었다고 가정하겠습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"# config/user_dic 디렉토리 생성 후 my_stop_dic.txt 파일 생성\\n\\n$ mkdir config/user_dic\\n$ echo 'in\\nthe\\neighty' \u003e config/user_dic/my_stop_dic.txt\\n\")),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# stopwords_path 설정을 가진 my_stop_filter 토큰필터 생성\\nPUT my_stop\\n{\\n  \"settings\": {\\n    \"analysis\": {\\n      \"filter\": {\\n        \"my_stop_filter\": {\\n          \"type\": \"stop\",\\n          \"stopwords_path\": \"user_dic/my_stop_dic.txt\"\\n        }\\n      }\\n    }\\n  }\\n}\\n')),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_stop_filter 토큰 필터로 문장 분석\\nGET my_stop/_analyze\\n{\\n  \"tokenizer\": \"whitespace\",\\n  \"filter\": [\\n    \"lowercase\",\\n    \"my_stop_filter\"\\n  ],\\n  \"text\": [ \"Around the World in Eighty Days\" ]\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_stop_filter 토큰 필터로 문장 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"around\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 6,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"world\",\\n      \"start_offset\" : 11,\\n      \"end_offset\" : 16,\\n      \"type\" : \"word\",\\n      \"position\" : 2\\n    },\\n    {\\n      \"token\" : \"days\",\\n      \"start_offset\" : 27,\\n      \"end_offset\" : 31,\\n      \"type\" : \"word\",\\n      \"position\" : 5\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(l.p,null,t().createElement(l.strong,null,\"my_stop_dic.txt\"),\" 파일 내용인 \",t().createElement(l.strong,null,\"in\"),\", \",t().createElement(l.strong,null,\"the\"),\", \",t().createElement(l.strong,null,\"eight\"),\" 가 제거된 나머지 텀 들만 결과로 나타난 것을 확인할 수 있습니다.\"),\"\\n\",t().createElement(o,{color:\"danger\"},t().createElement(l.p,null,\"기존의 사전 파일의 내용이 변경 된 경우 인덱스를 새로 고침을 해 주어야 토큰 필터가 새로 적용됩니다. 이것은 \",t().createElement(l.strong,null,\"stop\"),\" 외에도 뒤에 설명할 \",t().createElement(l.strong,null,\"synonym\"),\" 이나 \",t().createElement(l.strong,null,\"nori 한글 형태소 분석기\"),\" 사전에도 동일하게 적용됩니다. 새로 고침을 하는 방법은\"),t().createElement(l.p,null,t().createElement(l.strong,null,\"POST \u003c인덱스명\u003e/_close\"),\"\\n\",t().createElement(l.strong,null,\"POST \u003c인덱스명\u003e/_open\")),t().createElement(l.p,null,\"을 차례대로 실행 해 주면 됩니다. 인덱스가 close 된 중에는 색인이나 검색이 불가능 하게 되니 주의해야 합니다.\"),t().createElement(l.p,null,\"또한 애널라이저의 사전만 갱신되는 것이기 때문에 이미 색인된 도큐먼트들의 역 색인 내용은 변경되지 않습니다. 인덱스 새로 고침 이후에 색인되는 데이터들과 match 쿼리의 검색 등에만 적용이 됩니다. 기존 도큐먼트의 역 색인을 변경하려면 데이터를 모두 다시 재색인을 해야 합니다.\")),\"\\n\",t().createElement(l.h2,{id:\"663-synonym\"},\"6.6.3 Synonym\"),\"\\n\",t().createElement(l.p,null,\"검색 서비스에 따라서 \",t().createElement(l.strong,null,\"동의어\"),' 검색을 제공해야 하는 경우가 있습니다. 예를 들면 클라우드 서비스 관련 정보를 검색하는 시스템에서 \"AWS\" 라는 단어를 검색했을 때 \"Amazon\" 또는 한글 \"아마존\" 도 같이 검색을 하도록 하면 관련된 정보를 더 많이 찾을 수 있을 것입니다. 이 때 ',t().createElement(l.strong,null,\"Synonym\"),\" 토큰 필터를 사용하면 텀의 동의어 저장이 가능합니다. \"),\"\\n\",t().createElement(l.p,null,\"동의어를 설정하는 옵션은 \",t().createElement(l.code,{display:\"inline\"},\"synonyms\"),\" 항목에서 직접 동의어 목록을 입력하는 방법과 동의어 사전 파일을 만들어 \",t().createElement(l.code,{display:\"inline\"},\"synonyms_path\"),\" 로 지정하는 방법이 있습니다. 동의어 사전 명시 규칙에는 다음의 것들이 있습니다.\"),\"\\n\",t().createElement(l.ul,null,\"\\n\",t().createElement(l.li,null,t().createElement(l.code,{display:\"inline\"},'\"A, B =\u003e C\"'),\" : 왼쪽의 A, B 대신 오른쪽의 C 텀을 저장합니다. A, B 로는 C 의 검색이 가능하지만 C 로는 A, B 가 검색되지 않습니다.\"),\"\\n\",t().createElement(l.li,null,t().createElement(l.code,{display:\"inline\"},'\"A, B\"'),\" : A, B 각 텀이 A 와 B 두개의 텀을 모두 저장합니다. A 와 B 모두 서로의 검색어로 검색이 됩니다.\"),\"\\n\"),\"\\n\",t().createElement(l.p,null,\"다음은 \",t().createElement(l.strong,null,\"my_synonym\"),\" 인덱스에 \",t().createElement(l.code,{display:\"inline\"},'\"amazon =\u003e aws\"'),\" 으로 동의어를 지정하는 예제입니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# \"amazon =\u003e aws\" 동의어를 지정하는 my_synonym 인덱스 생성\\nPUT my_synonym\\n{\\n  \"settings\": {\\n    \"analysis\": {\\n      \"analyzer\": {\\n        \"my_syn\": {\\n          \"tokenizer\": \"whitespace\",\\n          \"filter\": [\\n            \"lowercase\",\\n            \"syn_aws\"\\n          ]\\n        }\\n      },\\n      \"filter\": {\\n        \"syn_aws\": {\\n          \"type\": \"synonym\",\\n          \"synonyms\": [\\n            \"amazon =\u003e aws\"\\n          ]\\n        }\\n      }\\n    }\\n  },\\n  \"mappings\": {\\n    \"properties\": {\\n      \"message\": {\\n        \"type\": \"text\",\\n        \"analyzer\": \"my_syn\"\\n      }\\n    }\\n  }\\n}\\n')),\"\\n\",t().createElement(l.p,null,\"이제 여기에 \",t().createElement(l.strong,null,'\"Amazon Web Service\"'),\", \",t().createElement(l.strong,null,'\"AWS\"'),\" 값을 가진 도큐먼트 두 개를 저장하고 각 도큐먼트의 \",t().createElement(l.code,{display:\"inline\"},\"_termvectors\"),\" 를 확인 해 보겠습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# AWS, Amazon Web Service 도큐먼트 저장\\nPUT my_synonym/_doc/1\\n{ \"message\" : \"Amazon Web Service\" }\\nPUT my_synonym/_doc/2\\n{ \"message\" : \"AWS\" }\\n')),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},\"# 1 도큐먼트 message 필드의 termvectors 확인\\nGET my_synonym/_termvectors/1?fields=message\\n\"))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# 1 도큐먼트 message 필드의 termvectors 확인 결과\\n{\\n  \"_index\" : \"my_synonym\",\\n  \"_type\" : \"_doc\",\\n  \"_id\" : \"1\",\\n  \"_version\" : 1,\\n  \"found\" : true,\\n  \"took\" : 9,\\n  \"term_vectors\" : {\\n    \"message\" : {\\n      \"field_statistics\" : {\\n        \"sum_doc_freq\" : 4,\\n        \"doc_count\" : 2,\\n        \"sum_ttf\" : 4\\n      },\\n      \"terms\" : {\\n        \"aws\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 0,\\n              \"start_offset\" : 0,\\n              \"end_offset\" : 6\\n            }\\n          ]\\n        },\\n        \"service\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 2,\\n              \"start_offset\" : 11,\\n              \"end_offset\" : 18\\n            }\\n          ]\\n        },\\n        \"web\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 1,\\n              \"start_offset\" : 7,\\n              \"end_offset\" : 10\\n            }\\n          ]\\n        }\\n      }\\n    }\\n  }\\n}\\n')))),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},\"# 2 도큐먼트 message 필드의 termvectors 확인\\nGET my_synonym/_termvectors/2?fields=message\\n\"))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# 2 도큐먼트 message 필드의 termvectors 확인 결과\\n{\\n  \"_index\" : \"my_synonym\",\\n  \"_type\" : \"_doc\",\\n  \"_id\" : \"2\",\\n  \"_version\" : 1,\\n  \"found\" : true,\\n  \"took\" : 0,\\n  \"term_vectors\" : {\\n    \"message\" : {\\n      \"field_statistics\" : {\\n        \"sum_doc_freq\" : 4,\\n        \"doc_count\" : 2,\\n        \"sum_ttf\" : 4\\n      },\\n      \"terms\" : {\\n        \"aws\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 0,\\n              \"start_offset\" : 0,\\n              \"end_offset\" : 3\\n            }\\n          ]\\n        }\\n      }\\n    }\\n  }\\n}\\n')))),\"\\n\",t().createElement(l.p,null,'1 도큐먼트의 **\"Amazon Web Service\"**가 ',t().createElement(l.strong,null,\"amazon\"),\" 대신 \",t().createElement(l.strong,null,'\"aws\"'),\", \",t().createElement(l.strong,null,'\"web\"'),\", \",t().createElement(l.strong,null,'\"service\"'),\" 로 저장된 것을 확인할 수 있습니다. 다음은 각각 \",t().createElement(l.strong,null,\"term\"),\" 쿼리로 \",t().createElement(l.strong,null,\"aws\"),\", \",t().createElement(l.strong,null,\"amazon\"),\" 을 검색한 결과와 \",t().createElement(l.strong,null,\"match\"),\" 쿼리로 \",t().createElement(l.strong,null,\"amazon\"),\" 을 검색한 결과입니다.\"),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# term 쿼리로 aws 검색\\nGET my_synonym/_search\\n{\\n  \"query\": {\\n    \"term\": {\\n      \"message\": \"aws\"\\n    }\\n  }\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# term 쿼리로 aws 검색 결과\\n{\\n  \"took\" : 2,\\n  \"timed_out\" : false,\\n  \"_shards\" : {\\n    \"total\" : 1,\\n    \"successful\" : 1,\\n    \"skipped\" : 0,\\n    \"failed\" : 0\\n  },\\n  \"hits\" : {\\n    \"total\" : {\\n      \"value\" : 2,\\n      \"relation\" : \"eq\"\\n    },\\n    \"max_score\" : 0.22920427,\\n    \"hits\" : [\\n      {\\n        \"_index\" : \"my_synonym\",\\n        \"_type\" : \"_doc\",\\n        \"_id\" : \"2\",\\n        \"_score\" : 0.22920427,\\n        \"_source\" : {\\n          \"message\" : \"AWS\"\\n        }\\n      },\\n      {\\n        \"_index\" : \"my_synonym\",\\n        \"_type\" : \"_doc\",\\n        \"_id\" : \"1\",\\n        \"_score\" : 0.1513613,\\n        \"_source\" : {\\n          \"message\" : \"Amazon Web Service\"\\n        }\\n      }\\n    ]\\n  }\\n}\\n')))),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# term 쿼리로 amazon 검색\\nGET my_synonym/_search\\n{\\n  \"query\": {\\n    \"term\": {\\n      \"message\": \"amazon\"\\n    }\\n  }\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# term 쿼리로 amazon 검색 결과\\n{\\n  \"took\" : 1,\\n  \"timed_out\" : false,\\n  \"_shards\" : {\\n    \"total\" : 1,\\n    \"successful\" : 1,\\n    \"skipped\" : 0,\\n    \"failed\" : 0\\n  },\\n  \"hits\" : {\\n    \"total\" : {\\n      \"value\" : 0,\\n      \"relation\" : \"eq\"\\n    },\\n    \"max_score\" : null,\\n    \"hits\" : [ ]\\n  }\\n}\\n')))),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# match 쿼리로 amazon 검색\\nGET my_synonym/_search\\n{\\n  \"query\": {\\n    \"match\": {\\n      \"message\": \"amazon\"\\n    }\\n  }\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# match 쿼리로 amazon 검색 결과\\n{\\n  \"took\" : 1,\\n  \"timed_out\" : false,\\n  \"_shards\" : {\\n    \"total\" : 1,\\n    \"successful\" : 1,\\n    \"skipped\" : 0,\\n    \"failed\" : 0\\n  },\\n  \"hits\" : {\\n    \"total\" : {\\n      \"value\" : 2,\\n      \"relation\" : \"eq\"\\n    },\\n    \"max_score\" : 0.22920427,\\n    \"hits\" : [\\n      {\\n        \"_index\" : \"my_synonym\",\\n        \"_type\" : \"_doc\",\\n        \"_id\" : \"2\",\\n        \"_score\" : 0.22920427,\\n        \"_source\" : {\\n          \"message\" : \"AWS\"\\n        }\\n      },\\n      {\\n        \"_index\" : \"my_synonym\",\\n        \"_type\" : \"_doc\",\\n        \"_id\" : \"1\",\\n        \"_score\" : 0.1513613,\\n        \"_source\" : {\\n          \"message\" : \"Amazon Web Service\"\\n        }\\n      }\\n    ]\\n  }\\n}\\n')))),\"\\n\",t().createElement(l.p,null,\"첫 번째 쿼리와 마지막 세 번째 쿼리의 결과가 동일합니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.strong,null,\"term\"),\" 쿼리는 검색어에 애널라이저를 적용하지 않고 그대로 검색하기 때문에 \",t().createElement(l.strong,null,\"term\"),\" 쿼리로 \",t().createElement(l.strong,null,\"aws\"),\" 를 검색하면 두개의 도큐먼트가 모두 검색되고 \",t().createElement(l.strong,null,\"amazon\"),\"을 검색 하면 검색이 되지 않습니다. \",t().createElement(l.strong,null,\"match\"),\" 쿼리는 검색어 \",t().createElement(l.strong,null,\"amazon\"),\"도 \",t().createElement(l.strong,null,\"my_syn\"),\" 애널라이저가 적용이 되어 \",t().createElement(l.strong,null,\"aws\"),\" 로 변환하여 검색을 하기 때문에 \",t().createElement(l.strong,null,\"aws\"),\"로 검색을 한 것과 같은 결과가 나타납니다.\"),\"\\n\",t().createElement(l.p,null,\"이번에는 \",t().createElement(l.strong,null,\"my_synonym\"),\" 인덱스에 \",t().createElement(l.code,{display:\"inline\"},'\"amazon, aws\"'),\"  로 동의어를 지정하는 예제입니다. 기존의 \",t().createElement(l.strong,null,\"my_synonym\"),\" 인덱스를 먼저 삭제하고 입력합니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# \"amazon, aws\" 동의어를 지정하는 my_synonym 인덱스 생성\\nPUT my_synonym\\n{\\n  \"settings\": {\\n    \"analysis\": {\\n      \"analyzer\": {\\n        \"my_syn\": {\\n          \"tokenizer\": \"whitespace\",\\n          \"filter\": [\\n            \"lowercase\",\\n            \"syn_aws\"\\n          ]\\n        }\\n      },\\n      \"filter\": {\\n        \"syn_aws\": {\\n          \"type\": \"synonym\",\\n          \"synonyms\": [\\n            \"amazon, aws\"\\n          ]\\n        }\\n      }\\n    }\\n  },\\n  \"mappings\": {\\n    \"properties\": {\\n      \"message\": {\\n        \"type\": \"text\",\\n        \"analyzer\": \"my_syn\"\\n      }\\n    }\\n  }\\n}\\n')),\"\\n\",t().createElement(l.p,null,\"앞의 예제와 동일하게 \",t().createElement(l.strong,null,'\"Amazon Web Service\"'),\", \",t().createElement(l.strong,null,'\"AWS\"'),\" 값을 가진 도큐먼트 두 개를 저장하고 각 도큐먼트의 \",t().createElement(l.code,{display:\"inline\"},\"_termvectors\"),\" 를 확인 해 보겠습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# AWS, Amazon Web Service 도큐먼트 저장\\nPUT my_synonym/_doc/1\\n{ \"message\" : \"Amazon Web Service\" }\\nPUT my_synonym/_doc/2\\n{ \"message\" : \"AWS\" }\\n')),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},\"# 1 도큐먼트 message 필드의 termvectors 확인\\nGET my_synonym/_termvectors/1?fields=message\\n\"))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# 1 도큐먼트 message 필드의 termvectors 확인 결과\\n{\\n  \"_index\" : \"my_synonym\",\\n  \"_type\" : \"_doc\",\\n  \"_id\" : \"1\",\\n  \"_version\" : 1,\\n  \"found\" : true,\\n  \"took\" : 0,\\n  \"term_vectors\" : {\\n    \"message\" : {\\n      \"field_statistics\" : {\\n        \"sum_doc_freq\" : 6,\\n        \"doc_count\" : 2,\\n        \"sum_ttf\" : 6\\n      },\\n      \"terms\" : {\\n        \"amazon\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 0,\\n              \"start_offset\" : 0,\\n              \"end_offset\" : 6\\n            }\\n          ]\\n        },\\n        \"aws\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 0,\\n              \"start_offset\" : 0,\\n              \"end_offset\" : 6\\n            }\\n          ]\\n        },\\n        \"service\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 2,\\n              \"start_offset\" : 11,\\n              \"end_offset\" : 18\\n            }\\n          ]\\n        },\\n        \"web\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 1,\\n              \"start_offset\" : 7,\\n              \"end_offset\" : 10\\n            }\\n          ]\\n        }\\n      }\\n    }\\n  }\\n}\\n')))),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},\"# 2 도큐먼트 message 필드의 termvectors 확인\\nGET my_synonym/_termvectors/2?fields=message\\n\"))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# 2 도큐먼트 message 필드의 termvectors 확인 결과\\n{\\n  \"_index\" : \"my_synonym\",\\n  \"_type\" : \"_doc\",\\n  \"_id\" : \"2\",\\n  \"_version\" : 1,\\n  \"found\" : true,\\n  \"took\" : 0,\\n  \"term_vectors\" : {\\n    \"message\" : {\\n      \"field_statistics\" : {\\n        \"sum_doc_freq\" : 6,\\n        \"doc_count\" : 2,\\n        \"sum_ttf\" : 6\\n      },\\n      \"terms\" : {\\n        \"amazon\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 0,\\n              \"start_offset\" : 0,\\n              \"end_offset\" : 3\\n            }\\n          ]\\n        },\\n        \"aws\" : {\\n          \"term_freq\" : 1,\\n          \"tokens\" : [\\n            {\\n              \"position\" : 0,\\n              \"start_offset\" : 0,\\n              \"end_offset\" : 3\\n            }\\n          ]\\n        }\\n      }\\n    }\\n  }\\n}\\n')))),\"\\n\",t().createElement(l.p,null,\"두 도큐먼트 모두 \",t().createElement(l.code,{display:\"inline\"},'\"position\" : 0'),\" 위치에 \",t().createElement(l.strong,null,'\"aws\"'),\", \",t().createElement(l.strong,null,'\"amazon\"'),\" 두개의 텀들이 모두 저장된 것을 확인할 수 있습니다. 이제 \",t().createElement(l.strong,null,\"term\"),\" 쿼리로 \",t().createElement(l.strong,null,\"amazon\"),\" 을 검색해도 두개 도큐먼트가 모두 검색이 됩니다. 이것은 한번 직접 실행 해 보시기 바랍니다.\"),\"\\n\",t().createElement(l.p,null,\"동의어 여러 개를 입력 할 때는 \",t().createElement(l.code,{display:\"inline\"},'\"synonyms\": [ ... ]'),\" 항목 안에 배열로 넣어도 되지만, 그 보다는 파일을 따로 만들어 관리하는 것이 편합니다. \",t().createElement(l.strong,null,\"stop\"),\" 토큰 필터와 마찬가지로 \",t().createElement(l.strong,null,\"synonyms_path\"),\" 항목에 \",t().createElement(l.strong,null,\"config\"),\" 디렉토리 기준의 상대 경로에 파일을 저장하고 경로명을 입력하면 됩니다. 동의어는 하나의 규칙당 \",t().createElement(l.strong,null,\"한 줄씩\"),\" 입력해야 하며 파일은 \",t().createElement(l.strong,null,\"UTF-8\"),\"로 인코딩 되어야 합니다.\"),\"\\n\",t().createElement(l.p,null,\"다음은 \",t().createElement(l.strong,null,'\"hop, jump\"'),\", \",t().createElement(l.strong,null,'\"quick, fast\"'),\" 를 \",t().createElement(l.strong,null,\"user_dic/my_syn_dic.txt\"),\" 에 저장해서 동의어 사전으로 사용하는 예제입니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-bash\",display:\"block\"},\"# config/user_dic 디렉토리 아래에 my_syn_dic.txt 파일 생성\\n$ echo 'quick, fast\\nhop, jump' \u003e config/user_dic/my_syn_dic.txt\\n\")),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# synonyms_path 설정을 가진 my_synonym 인덱스 생성\\nPUT my_synonym\\n{\\n  \"settings\": {\\n    \"analysis\": {\\n      \"analyzer\": {\\n        \"my_syn\": {\\n          \"tokenizer\": \"whitespace\",\\n          \"filter\": [\\n            \"lowercase\",\\n            \"syn_aws\"\\n          ]\\n        }\\n      },\\n      \"filter\": {\\n        \"syn_aws\": {\\n          \"type\": \"synonym\",\\n          \"synonyms_path\": \"user_dic/my_syn_dic.txt\"\\n        }\\n      }\\n    }\\n  },\\n  \"mappings\": {\\n    \"properties\": {\\n      \"message\": {\\n        \"type\": \"text\",\\n        \"analyzer\": \"my_syn\"\\n      }\\n    }\\n  }\\n}\\n')),\"\\n\",t().createElement(l.p,null,\"이제 \",t().createElement(l.strong,null,\"term\"),\" 쿼리로 \",t().createElement(l.strong,null,\"quick\"),\" 과 \",t().createElement(l.strong,null,\"jump\"),\"를 검색하면 \",t().createElement(l.strong,null,\"hop\"),\", \",t().createElement(l.strong,null,\"fast\"),\" 도 검색이 됩니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# quick, jump, hop, fast 를 포함하는 도큐먼트 저장\\nPUT my_synonym/_doc/1\\n{ \"message\": \"Quick brown fox jump\" }\\nPUT my_synonym/_doc/2\\n{ \"message\": \"hop rabbit is fast\" }\\n')),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# term 쿼리로 quick, jump 검색\\nGET my_synonym/_search\\n{\\n  \"query\": {\\n    \"bool\": {\\n      \"must\": [\\n        {\\n          \"term\": {\\n            \"message\": \"quick\"\\n          }\\n        },\\n        {\\n          \"term\": {\\n            \"message\": \"jump\"\\n          }\\n        }\\n      ]\\n    }\\n  }\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# term 쿼리로 quick, jump 검색 결과\\n{\\n  \"took\" : 370,\\n  \"timed_out\" : false,\\n  \"_shards\" : {\\n    \"total\" : 1,\\n    \"successful\" : 1,\\n    \"skipped\" : 0,\\n    \"failed\" : 0\\n  },\\n  \"hits\" : {\\n    \"total\" : {\\n      \"value\" : 2,\\n      \"relation\" : \"eq\"\\n    },\\n    \"max_score\" : 0.42221838,\\n    \"hits\" : [\\n      {\\n        \"_index\" : \"my_synonym\",\\n        \"_type\" : \"_doc\",\\n        \"_id\" : \"1\",\\n        \"_score\" : 0.42221838,\\n        \"_source\" : {\\n          \"message\" : \"Quick brown fox jump\"\\n        }\\n      },\\n      {\\n        \"_index\" : \"my_synonym\",\\n        \"_type\" : \"_doc\",\\n        \"_id\" : \"2\",\\n        \"_score\" : 0.42221838,\\n        \"_source\" : {\\n          \"message\" : \"hop rabbit is fast\"\\n        }\\n      }\\n    ]\\n  }\\n}\\n')))),\"\\n\",t().createElement(l.p,null,\"마지막으로 \",t().createElement(l.strong,null,\"synonym\"),\" 토큰 필터에는 추가적으로 다음과 같은 옵션들이 있습니다.\"),\"\\n\",t().createElement(l.ul,null,\"\\n\",t().createElement(l.li,null,t().createElement(l.strong,null,\"expand\"),\" (true / false. 디폴트는 \",t().createElement(l.strong,null,\"true\"),\")\\n\",t().createElement(l.code,{display:\"inline\"},'\"expand\": false'),\" 로 설정하게 되면 \",t().createElement(l.code,{display:\"inline\"},'\"synonyms\": \"aws, amazon\"'),\" 같은 설정에 토큰들을 모두 저장하지 않고 맨 처음에 명시된 토큰 하나만 저장합니다. 앞의 설정은 \",t().createElement(l.code,{display:\"inline\"},'\"synonyms\": \"aws, amazon =\u003e aws\"'),\" 로 설정한 것과 동일하게 동작합니다.\"),\"\\n\",t().createElement(l.li,null,t().createElement(l.strong,null,\"lenient\"),\" (true / false. 디폴트는 \",t().createElement(l.strong,null,\"false\"),\")\\n\",t().createElement(l.code,{display:\"inline\"},'\"lenient\": true'),\" 로 설정하면 synonym 설정에 오류가 있는 경우 오류가 있는 부분을 무시하고 실행합니다.\"),\"\\n\"),\"\\n\",t().createElement(l.h2,{id:\"664-ngram-edge-ngram-shingle\"},\"6.6.4 NGram, Edge NGram, Shingle\"),\"\\n\",t().createElement(l.h3,{id:\"ngram\"},\"NGram\"),\"\\n\",t().createElement(l.p,null,\"Elasticsearch는 빠른 검색을 위해 검색에 사용될 텀 들을 미리 분리해서 역 인덱스에 저장합니다. 하지만 과학 용어집 검색 같은 특정한 사용 사례에 따라 텀이 아닌 단어의 일부만 가지고도 검색해야 하는 기능이 필요한 경우도 있습니다. RDBMS의 LIKE 검색 처럼 사용하는 \",t().createElement(l.strong,null,\"wildcard\"),\" 쿼리나 \",t().createElement(l.strong,null,\"regexp (정규식)\"),\" 쿼리도 지원을 하지만, 이런 쿼리들은 메모리 소모가 많고 느리기 때문에 Elasticsearch의 장점을 활용하지 못합니다. 이런 사용을 위해 검색 텀의 일부만 미리 분리해서 저장을 할 수 있는데 이렇게 단어의 일부를 나눈 부위를 \",t().createElement(l.strong,null,\"NGram\"),\" 이라고 합니다. 보통은 \",t().createElement(l.strong,null,\"unigram\"),\"(유니그램 – 1글자), \",t().createElement(l.strong,null,\"bigram\"),\"(바이그램 - 2자) 등으로 부릅니다.\"),\"\\n\",t().createElement(l.p,null,\"Elasticsearch는 \",t().createElement(l.strong,null,\"NGram\"),\"을 처리하는 토큰 필터를 제공하며 설정은 \",t().createElement(l.code,{display:\"inline\"},'\"type\": \"nGram\"'),\" 으로 합니다. \",t().createElement(l.strong,null,'\"house\"'),' 라는 단어를 2 글자의 NGram (bigram) 으로 처리하면 다음과 같이 \"',t().createElement(l.strong,null,'ho\"'),\", \",t().createElement(l.strong,null,'\"ou\"'),\", \",t().createElement(l.strong,null,'\"us\"'),\", \",t().createElement(l.strong,null,'\"se\"'),\" 총 4개의 토큰들이 추출됩니다. ngram 토큰필터를 사용하면 이렇게 2글자씩 추출된 텀들이 모두 검색 토큰으로 저장됩니다. 이제 이 인덱스의 경우에는 검색어를 \",t().createElement(l.strong,null,'\"ho\"'),\" 라고만 검색을 해도 \",t().createElement(l.strong,null,\"ho\"),\"use 가 포함된 도큐먼트들이 검색이 됩니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.img,{src:\"/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/06-06_ngram_house.png\",alt:\"단어 house를 ngram(2) 으로 분리\"})),\"\\n\",t().createElement(o,{color:\"danger\"},t().createElement(l.p,null,t().createElement(l.strong,null,\"ngram\"),\" 토큰필터를 사용하면 저장되는 텀의 갯수도 기하급수적으로 늘어나고 검색어를 \",t().createElement(l.strong,null,'\"ho\"',t().createElement(l.strong,null,\"로 검색 했을 때 \",t().createElement(l.strong,null,\"ho\"),\"use, s\"),\"ho\"),\"es 처럼 검색 결과를 예상하기 어렵기 때문에 일반적인 텍스트 검색에는 사용하지 않는 것이 좋습니다. ngram을 사용하기 적합한 사례는 카테고리 목록이나 태그 목록과 같이 전체 개수가 많지 않은 데이터 집단에 \",t().createElement(l.strong,null,\"자동완성\"),\" 같은 기능을 구현하는 데에 적합합니다.\")),\"\\n\",t().createElement(l.p,null,\"ngram 토큰 필터에는 \",t().createElement(l.code,{display:\"inline\"},\"min_gram\"),\" (디폴트 1), \",t().createElement(l.code,{display:\"inline\"},\"max_gram\"),\" (디폴트 2) 옵션이 있습니다. 짐작할 수 있듯이 최소, 최대 문자수의 토큰을 구분하는 단위입니다. \",t().createElement(l.strong,null,\"house\"),\"를 \",t().createElement(l.code,{display:\"inline\"},'\"min_gram\": 2'),\", \",t().createElement(l.code,{display:\"inline\"},'\"max_gram\": 3'),\" 으로 설정하면 다음과 같이 분석되어 총 7개의 토큰을 저장합니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.img,{src:\"/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/06-06_ngram_house_2.png\",alt:\"단어 house를 ngram(2-3) 으로 분리\"})),\"\\n\",t().createElement(l.p,null,\"다음은 \",t().createElement(l.strong,null,\"my_ngram\"),\" 인덱스에 \",t().createElement(l.code,{display:\"inline\"},'\"min_gram\": 2'),\", \",t().createElement(l.code,{display:\"inline\"},'\"max_gram\": 3'),\" 인 \",t().createElement(l.strong,null,\"my_ngram_f\"),\" 토큰필터를 만들고 house 를 분석하는 예제입니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'PUT my_ngram\\n{\\n  \"settings\": {\\n    \"analysis\": {\\n      \"filter\": {\\n        \"my_ngram_f\": {\\n          \"type\": \"nGram\",\\n          \"min_gram\": 2,\\n          \"max_gram\": 3\\n        }\\n      }\\n    }\\n  }\\n}\\n')),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_ngram_f 토큰필터로 \"house\" 분석\\nGET my_ngram/_analyze\\n{\\n  \"tokenizer\": \"keyword\",\\n  \"filter\": [\\n    \"my_ngram_f\"\\n  ],\\n  \"text\": \"house\"\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_ngram_f 토큰필터로 \"house\" 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"ho\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"hou\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"ou\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"ous\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"us\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"use\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"se\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(l.h3,{id:\"edge-ngram\"},\"Edge NGram\"),\"\\n\",t().createElement(l.p,null,\"검색을 위해 NGram을 저장하더라도 보통은 단어의 맨 앞에서부터 검색하는 경우가 많습니다. 텀 앞쪽의 ngram 만 저장하기 위해서는 \",t().createElement(l.strong,null,\"Edge NGram\"),\" 토큰필터를 이용합니다. 설정 방법은 \",t().createElement(l.code,{display:\"inline\"},'\"type\": \"edgeNGram\"'),\" 입니다. edgeNGram의 옵션을 \",t().createElement(l.code,{display:\"inline\"},'\"min_gram\": 1'),\", \",t().createElement(l.code,{display:\"inline\"},'\"max_gram\": 4'),' 으로 설정하고 \"',t().createElement(l.strong,null,'house\"'),\" 를 분석하면 다음과 같이 \",t().createElement(l.strong,null,'\"h\", \"ho\", \"hou\", \"hous\"'),\" 4개의 토큰이 생성됩니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.img,{src:\"/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/06-06_edngram.png\",alt:\"단어 house를 edgeNgram 으로 분리\"})),\"\\n\",t().createElement(l.p,null,\"인덱스 설정과 쿼리를 이용한 애널라이저 분석은 위의 NGram 예제를 참고해서 직접 만들어 보시기 바랍니다.\"),\"\\n\",t().createElement(l.h3,{id:\"shingle\"},\"Shingle\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.strong,null,\"NGram\"),\"과 \",t().createElement(l.strong,null,\"Edge NGram\"),\"은 모두 하나의 단어로부터 토큰을 확장하는 토큰 필터입니다. 문자가 아니라 단어 단위로 구성된 묶음을 \",t().createElement(l.strong,null,\"Shingle\"),\" 이라고 하며 \",t().createElement(l.code,{display:\"inline\"},'\"type\": \"shingle\"'),\" 토큰 필터의 이용이 가능합니다. \",t().createElement(l.strong,null,'\"this is my sweet home\"'),\" 라는 문장을 분리해서 \",t().createElement(l.strong,null,\"2 단어씩 Shingle\"),\" 토큰 필터를 적용하면 다음과 같은 4개의 \",t().createElement(l.strong,null,\"shingle\"),\" 들이 생성됩니다.\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.img,{src:\"/L1VzZXJzL2tpbWptaW4vZ2l0L2RvY3Mta3IvZXNndWlkZTc/assets/06-06_shingle.png\",alt:\"this is my sweet home 문장을 shingle 로 분리\"})),\"\\n\",t().createElement(l.p,null,t().createElement(l.strong,null,\"Shingle\"),\" 토큰 필터에서 사용 가능한 옵션은 다음과 같습니다.\"),\"\\n\",t().createElement(l.ul,null,\"\\n\",t().createElement(l.li,null,t().createElement(l.strong,null,\"min_shingle_size\"),\" / \",t().createElement(l.strong,null,\"max_shingle_size\"),\" : shingle의 최소 / 최대 단어 개수를 지정합니다. 디폴트는 모두 2 입니다.\"),\"\\n\",t().createElement(l.li,null,t().createElement(l.strong,null,\"output_unigrams\"),\" : Shingle 외에도 각각의 개별 토큰(unigram)도 저장 하는지의 여부를 설정합니다. 디폴트는 true 입니다.\"),\"\\n\",t().createElement(l.li,null,t().createElement(l.strong,null,\"output_unigrams_if_no_shingles\"),\" : shingle 을 만들 수 없는 경우에만 개별 토큰을 저장하는지의 여부를 설정합니다. 디폴트는 false 입니다.\"),\"\\n\",t().createElement(l.li,null,t().createElement(l.strong,null,\"token_separator\"),\" : 토큰 구분자를 지정합니다. 디폴트는 \",t().createElement(l.code,{display:\"inline\"},'\" \"'),\" (스페이스) 입니다.\"),\"\\n\",t().createElement(l.li,null,t().createElement(l.strong,null,\"filler_token\"),\" : shing을 만들 텀이 없는 경우 (보통은 stop 토큰 필터와 함께 사용되어 offset 위치만 있고 텀이 없는 경우입니다) 대체할 텍스트를 지정합니다. 디폴트는 \",t().createElement(l.code,{display:\"inline\"},\"_\"),\" 입니다.\"),\"\\n\"),\"\\n\",t().createElement(l.p,null,\"다음은 \",t().createElement(l.strong,null,\"my_shingle\"),\" 인덱스에서 \",t().createElement(l.code,{display:\"inline\"},'\"min_shingle_size\": 3'),\", \",t().createElement(l.code,{display:\"inline\"},'\"max_shingle_size\": 4'),\" 로 설정해서 \",t().createElement(l.strong,null,'\"this is my sweet home\"'),\" 문장을 분석하는 예제입니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'PUT my_shingle\\n{\\n  \"settings\": {\\n    \"analysis\": {\\n      \"filter\": {\\n        \"my_shingle_f\": {\\n          \"type\": \"shingle\",\\n          \"min_shingle_size\": 3,\\n          \"max_shingle_size\": 4\\n        }\\n      }\\n    }\\n  }\\n}\\n')),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_shingle_f 토큰필터로 \"this is my sweet home\" 분석\\nGET my_shingle/_analyze\\n{\\n  \"tokenizer\": \"whitespace\",\\n  \"filter\": [\\n    \"my_shingle_f\"\\n  ],\\n  \"text\": \"this is my sweet home\"\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_shingle_f 토큰필터로 \"this is my sweet home\" 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"this\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 4,\\n      \"type\" : \"word\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"this is my\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 10,\\n      \"type\" : \"shingle\",\\n      \"position\" : 0,\\n      \"positionLength\" : 3\\n    },\\n    {\\n      \"token\" : \"this is my sweet\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 16,\\n      \"type\" : \"shingle\",\\n      \"position\" : 0,\\n      \"positionLength\" : 4\\n    },\\n    {\\n      \"token\" : \"is\",\\n      \"start_offset\" : 5,\\n      \"end_offset\" : 7,\\n      \"type\" : \"word\",\\n      \"position\" : 1\\n    },\\n    {\\n      \"token\" : \"is my sweet\",\\n      \"start_offset\" : 5,\\n      \"end_offset\" : 16,\\n      \"type\" : \"shingle\",\\n      \"position\" : 1,\\n      \"positionLength\" : 3\\n    },\\n    {\\n      \"token\" : \"is my sweet home\",\\n      \"start_offset\" : 5,\\n      \"end_offset\" : 21,\\n      \"type\" : \"shingle\",\\n      \"position\" : 1,\\n      \"positionLength\" : 4\\n    },\\n    {\\n      \"token\" : \"my\",\\n      \"start_offset\" : 8,\\n      \"end_offset\" : 10,\\n      \"type\" : \"word\",\\n      \"position\" : 2\\n    },\\n    {\\n      \"token\" : \"my sweet home\",\\n      \"start_offset\" : 8,\\n      \"end_offset\" : 21,\\n      \"type\" : \"shingle\",\\n      \"position\" : 2,\\n      \"positionLength\" : 3\\n    },\\n    {\\n      \"token\" : \"sweet\",\\n      \"start_offset\" : 11,\\n      \"end_offset\" : 16,\\n      \"type\" : \"word\",\\n      \"position\" : 3\\n    },\\n    {\\n      \"token\" : \"home\",\\n      \"start_offset\" : 17,\\n      \"end_offset\" : 21,\\n      \"type\" : \"word\",\\n      \"position\" : 4\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(l.p,null,t().createElement(l.code,{display:\"inline\"},'\"token\" : \"this is my\"'),\", \",t().createElement(l.code,{display:\"inline\"},'\"token\" : \"this is my sweet\"'),\" 와 같은 토큰들이 저장된 것을 확인할 수 있습니다. 이번에는 \",t().createElement(l.code,{display:\"inline\"},'\"output_unigrams\": false'),\" 와 \",t().createElement(l.code,{display:\"inline\"},'\"filler_token\": \"-\"'),\" 설정을 추가하고 stop 토큰필터로 \",t().createElement(l.code,{display:\"inline\"},'\"is\"'),\" 를 불용어 처리한 뒤 실행 해 보겠습니다.\"),\"\\n\",t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'PUT my_shingle\\n{\\n  \"settings\": {\\n    \"analysis\": {\\n      \"filter\": {\\n        \"my_shingle_f\": {\\n          \"type\": \"shingle\",\\n          \"min_shingle_size\": 3,\\n          \"max_shingle_size\": 4,\\n          \"output_unigrams\": false,\\n          \"filler_token\": \"-\"\\n        },\\n        \"my_stop_f\": {\\n          \"type\": \"stop\",\\n          \"stopwords\": [\\n            \"is\"\\n          ]\\n        }\\n      }\\n    }\\n  }\\n}\\n')),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_shingle 에서 \"this is my sweet home\" 분석\\nGET my_shingle/_analyze\\n{\\n  \"tokenizer\": \"whitespace\",\\n  \"filter\": [\\n    \"my_stop_f\",\\n    \"my_shingle_f\"\\n  ],\\n  \"text\": \"this is my sweet home\"\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# my_shingle 에서 \"this is my sweet home\" 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"this - my\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 10,\\n      \"type\" : \"shingle\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"this - my sweet\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 16,\\n      \"type\" : \"shingle\",\\n      \"position\" : 0,\\n      \"positionLength\" : 2\\n    },\\n    {\\n      \"token\" : \"- my sweet\",\\n      \"start_offset\" : 8,\\n      \"end_offset\" : 16,\\n      \"type\" : \"shingle\",\\n      \"position\" : 1\\n    },\\n    {\\n      \"token\" : \"- my sweet home\",\\n      \"start_offset\" : 8,\\n      \"end_offset\" : 21,\\n      \"type\" : \"shingle\",\\n      \"position\" : 1,\\n      \"positionLength\" : 2\\n    },\\n    {\\n      \"token\" : \"my sweet home\",\\n      \"start_offset\" : 8,\\n      \"end_offset\" : 21,\\n      \"type\" : \"shingle\",\\n      \"position\" : 2\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(l.p,null,\"단일 토큰들은 모두 삭제되었고 \",t().createElement(l.code,{display:\"inline\"},'\"is\"'),\" 는 \",t().createElement(l.code,{display:\"inline\"},'\"-\"'),\" 로 대치된 3, 4개 단어로 이루어진 shingle 들이 생성된 것을 확인할 수 있습니다.\"),\"\\n\",t().createElement(o,{color:\"warning\"},t().createElement(l.p,null,t().createElement(l.strong,null,\"NGram\"),\", \",t().createElement(l.strong,null,\"Edged NGram\"),\" 그리고 \",t().createElement(l.strong,null,\"Shingle\"),\" 토큰 필터는 보통 일반적인 텍스트 분석에 사용하기는 적합하지 않습니다. 하지만 자동 완성 기능을 구현하거나 프로그램 코드 안에서 문법이나 기능명을 검색하는 것과 같이 특수한 요구사항을 충족해야 하는 경우 유용하게 사용될 수 있습니다.\")),\"\\n\",t().createElement(l.h2,{id:\"665-unique\"},\"6.6.5 Unique\"),\"\\n\",t().createElement(l.p,null,t().createElement(l.strong,null,'\"white fox, white rabbit, white bear\"'),\" 같은 문장을 분석하면 \",t().createElement(l.strong,null,'\"white\"'),\" 텀은 총 3번 저장이 됩니다. 역 색인에는 텀이 1개만 있어도 텀을 포함하는 도큐먼트를 가져올 수 있기 때문에 중복되는 텀 들은 삭제 해 주어도 검색에는 보통 무방합니다. 이 경우 \",t().createElement(l.strong,null,\"unique\"),\" 토큰 필터를 사용해서 중복되는 텀 들은 하나만 저장하도록 할 수 있습니다.\"),\"\\n\",t().createElement(l.p,null,\"다음은 \",t().createElement(l.strong,null,'\"white fox, white rabbit, white bear\"'),\" 문장을 \",t().createElement(l.strong,null,\"unique\"),\" 토큰 필터를 적용하지 않은 경우와 적용한 경우를 비교 한 예제입니다.\"),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# 일반적인 \"white fox, white rabbit, white bear\" 문장 분석\\nGET _analyze\\n{\\n  \"tokenizer\": \"standard\",\\n  \"filter\": [\\n    \"lowercase\"\\n  ],\\n  \"text\": [\\n    \"white fox, white rabbit, white bear\"\\n  ]\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# 일반적인 \"white fox, white rabbit, white bear\" 문장 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"white\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"fox\",\\n      \"start_offset\" : 6,\\n      \"end_offset\" : 9,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 1\\n    },\\n    {\\n      \"token\" : \"white\",\\n      \"start_offset\" : 11,\\n      \"end_offset\" : 16,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 2\\n    },\\n    {\\n      \"token\" : \"rabbit\",\\n      \"start_offset\" : 17,\\n      \"end_offset\" : 23,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 3\\n    },\\n    {\\n      \"token\" : \"white\",\\n      \"start_offset\" : 25,\\n      \"end_offset\" : 30,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 4\\n    },\\n    {\\n      \"token\" : \"bear\",\\n      \"start_offset\" : 31,\\n      \"end_offset\" : 35,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 5\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(a,null,t().createElement(s,{name:\"request\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# unique 토크나이저로 \"white fox, white rabbit, white bear\" 문장 분석\\nGET _analyze\\n{\\n  \"tokenizer\": \"standard\",\\n  \"filter\": [\\n    \"lowercase\",\\n    \"unique\"\\n  ],\\n  \"text\": [\\n    \"white fox, white rabbit, white bear\"\\n  ]\\n}\\n'))),t().createElement(s,{name:\"response\"},t().createElement(l.pre,null,t().createElement(l.code,{className:\"language-javascript\",display:\"block\"},'# unique 토크나이저로 \"white fox, white rabbit, white bear\" 문장 분석 결과\\n{\\n  \"tokens\" : [\\n    {\\n      \"token\" : \"white\",\\n      \"start_offset\" : 0,\\n      \"end_offset\" : 5,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 0\\n    },\\n    {\\n      \"token\" : \"fox\",\\n      \"start_offset\" : 6,\\n      \"end_offset\" : 9,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 1\\n    },\\n    {\\n      \"token\" : \"rabbit\",\\n      \"start_offset\" : 17,\\n      \"end_offset\" : 23,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 2\\n    },\\n    {\\n      \"token\" : \"bear\",\\n      \"start_offset\" : 31,\\n      \"end_offset\" : 35,\\n      \"type\" : \"\u003cALPHANUM\u003e\",\\n      \"position\" : 3\\n    }\\n  ]\\n}\\n')))),\"\\n\",t().createElement(l.p,null,t().createElement(l.code,{display:\"inline\"},'\"unique\"'),\" 토큰 필터를 적용하면 \",t().createElement(l.strong,null,'\"white\"'),\" 텀이 하나만 저장된 것을 확인할 수 있습니다.\"),\"\\n\",t().createElement(o,{color:\"danger\"},t().createElement(l.p,null,\"match 쿼리를 사용해서 검색하는 경우 unique 토큰 필터를 적용한 필드는 텀의 개수가 1개로 되기 때문에 \",t().createElement(l.strong,null,\"TF(Term Frequency)\"),\" 값이 줄어들어 스코어 점수가 달라질 수 있습니다. match 쿼리를 이용해 \",t().createElement(l.strong,null,\"정확도(relevancy)\"),\" 를 따져야 하는 검색의 경우에는 unique 토큰 필터는 사용하지 않는 것이 바람직합니다.\")))}};function r(e,n){throw new Error(\"Expected \"+(n?\"component\":\"object\")+\" `\"+e+\"` to be defined: you likely forgot to import, pass, or provide it.\")}})(),s})()));","frontmatter":{"id":"esG7-06-06-token-filter","slug":"/krEsguide7/esG7-06-06-token-filter","title":"6.6 토큰 필터 - Token Filter","description":"모든 문서에 대한 저작권은 Elastic 과 김종민(kimjmin@gmail.com) 에게 있으며 허가되지 않은 무단 복제나 배포 및 출판을 금지합니다. 본 문서의 내용 및 포함된 자료를 인용하고자 하는 경우 출처를 명시하고 게재된 주소를 김종민(kimjmin@gmail.com)에게 알려주시기 바랍니다.","date":"2022-01-25T00:00:00.000Z","tags":["indexing","text","analysis","token","filter"],"link":"file:///Users/kimjmin/git/docs-kr/esguide7","linkPath":"06-text-analysis/06-06-token-filter.mdx"},"missionId":"krEsguide7"},"__N_SSG":true},"page":"/[...slug]","query":{"slug":["krEsguide7","esG7-06-06-token-filter"]},"buildId":"JogDT4Rcnrb0olaKm5b4J","assetPrefix":"/docs-kr","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>